<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Blog | Haihao Sun&#39;s Homepage</title>
    <link>http://localhost:1313/post/</link>
      <atom:link href="http://localhost:1313/post/index.xml" rel="self" type="application/rss+xml" />
    <description>Blog</description>
    <generator>Hugo Blox Builder (https://hugoblox.com)</generator><language>en-us</language><lastBuildDate>Tue, 07 Dec 2027 00:00:00 +0000</lastBuildDate>
    <image>
      <url>http://localhost:1313/media/icon_hu68170e94a17a2a43d6dcb45cf0e8e589_3079_512x512_fill_lanczos_center_3.png</url>
      <title>Blog</title>
      <link>http://localhost:1313/post/</link>
    </image>
    
    <item>
      <title>ä½œå®¶å’ŒçŸ­è§†é¢‘åˆ›ä½œè€…çš„ç±»ä¼¼ä¸ä¸åŒ</title>
      <link>http://localhost:1313/post/2025-05-19-writer-and-content-creator/</link>
      <pubDate>Mon, 19 May 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-05-19-writer-and-content-creator/</guid>
      <description>&lt;p&gt;ä¹¦å’ŒçŸ­è§†é¢‘å¾ˆåƒï¼Œä»–ä»¬éƒ½å¡«è¡¥äº†äººç©ºé—²çš„æ—¶é—´ã€‚&lt;/p&gt;
&lt;p&gt;åˆ·çŸ­è§†é¢‘ä¹‹å‰æ˜¯çœ‹è§†é¢‘ï¼Œçœ‹è§†é¢‘ä¹‹å‰æ˜¯çœ‹ç”µè§†ï¼Œç”µè§†ä¹‹å‰æ˜¯å¬å¹¿æ’­ï¼Œå¹¿æ’­ä¹‹å‰æ˜¯çœ‹ä¹¦ã€‚æ€»ä½“è¶‹åŠ¿æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¿¡æ¯ä¼ æ’­è¶Šæ¥è¶Šå¤§ï¼Œä»æ–‡æœ¬ï¼Œåˆ°éŸ³é¢‘ï¼Œå†åˆ°è§†é¢‘ã€‚&lt;/li&gt;
&lt;li&gt;åˆ›ä½œçš„é—¨æ§›è¶Šæ¥è¶Šä½ï¼Œä»ä½œå®¶å‘è¡¨ä¹¦ï¼Œåˆ°æ¯ä¸ªäººåªè¦æœ‰æ‰‹æœºå’Œäº’è”ç½‘å°±èƒ½å‘è¡¨çŸ­è§†é¢‘ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ€åå¯èƒ½å°±å‘å±•åˆ° AI ç”Ÿæˆè§†é¢‘ï¼Œé—¨æ§›æ›´ä½äº†ã€‚&lt;/p&gt;
&lt;p&gt;æ¯ä¸ªäººéƒ½èƒ½åŠ¨ç¬”å†™ä¸€äº›ä¸œè¥¿ï¼Œä½†ä¸æ˜¯æ¯ä¸ªäººå†™çš„ä¸œè¥¿éƒ½èƒ½è¢«å°æˆä¹¦å‘è¡¨ã€‚æ¯ä¸ªäººéƒ½èƒ½åˆ›ä½œè§†é¢‘ï¼Œä½†ä¸æ˜¯æ¯ä¸ªäºº
åˆ›ä½œçš„è§†é¢‘éƒ½èƒ½è¢«ç®—æ³•æ¨é€åˆ°ç”¨æˆ·çš„ feed é‡Œã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹ä¸€æ­¥è§£å†³çš„é—®é¢˜å¯èƒ½ä¸æ˜¯ä»è§†é¢‘åˆ›ä½œè€…è§’åº¦æ¥è¯´ï¼Œåº”è¯¥æ˜¯ä»è§†é¢‘æ¶ˆè´¹è€…è§’åº¦æ¥è¯´ã€‚åˆ›ä½œçš„é—¨æ§›é™ä½çš„åŒæ—¶ï¼Œäººè‡ªç”±çš„æ—¶é—´ä¹Ÿéšç€ç§‘æŠ€çš„å‘å±•è€Œå˜å¤šã€‚é‚£ä¹ˆä¸‹ä¸€æ­¥æ¥è¯´å¦‚æœæ¶ˆè´¹ç«¯çš„ç”¨æˆ·èƒ½æŠ•å…¥çš„æ—¶é—´ä¹Ÿéšç€åˆ›ä½œé—¨æ§›çš„é™ä½è€Œé™ä½ï¼Œé‚£ä¹ˆæ›´å¤šäººå°±æœ‰å‘å£°çš„æƒåˆ©ï¼Œæ›´å¤šäººæœ‰æ—¶é—´å¬åˆ°å…¶ä»–äººçš„å‘å£°ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆä½œä¸ºä¸€ä¸ªè§†é¢‘å¹³å°ï¼Œå¦‚æœç”Ÿäº§åŠ›å¤§å¤§æé«˜ï¼Œäººä»¬æœ‰äº†æ›´å¤šçš„è‡ªç”±æ—¶é—´ï¼Œç»å¯¹æ˜¯ä¸€ä¸ªå¥½äº‹ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>D2L - Chapter 3.4 Linear Regression Implementation From Scratch</title>
      <link>http://localhost:1313/post/2025-04-20-chapter-3-4-linear-regression-implementation-from-scratch/</link>
      <pubDate>Sun, 20 Apr 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-04-20-chapter-3-4-linear-regression-implementation-from-scratch/</guid>
      <description>&lt;h2 id=&#34;34-linear-regression-implementation-from-scratch&#34;&gt;3.4 Linear Regression Implementation From Scratch&lt;/h2&gt;
&lt;p&gt;We are now realy to implement the entire method from scratch, including&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;model&lt;/li&gt;
&lt;li&gt;loss function&lt;/li&gt;
&lt;li&gt;a minibatch stochastic gradient descent optimizer&lt;/li&gt;
&lt;li&gt;training function that stitches all these pieces together&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;341-defining-the-model&#34;&gt;3.4.1 Defining the Model&lt;/h3&gt;
&lt;p&gt;Initialize weights and bias.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;LinearRegressionScratch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d2l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;module&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#@save&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;num_inputs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;lr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;float&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;sigma&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;float&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.01&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;setup&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;w&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;param&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;initializers&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;normal&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sigma&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                            &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;num_inputs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;param&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;initializers&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;zeros&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Define our model, relating its input and parameters to its output&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nd&#34;&gt;@d2l.add_to_class&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LinearRegressionScratch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#@save&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;forward&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;matmul&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;342-defining-the-loss-funciton&#34;&gt;3.4.2 Defining the Loss Funciton&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nd&#34;&gt;@d2l.add_to_class&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LinearRegressionScratch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#@save&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;loss&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;y_hat&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;state&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;apply_fn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;({&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;params&amp;#34;: params}, *X) # X unpacked from a tuple&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;l&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y_hat&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;reshape&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y_hat&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shape&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;**&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;343-defining-the-optimization-algorithm&#34;&gt;3.4.3 Defining the Optimization Algorithm&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;SGD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d2l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;HyperParameters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#@save&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;save_hyperparameters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;init&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;del&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;optax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;EmptyState&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;update&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;updates&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;del&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# When state.apply_gradients method is called to update flax&amp;#39;s train_state object, it internally calls&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;updates&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tree_util&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tree_map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;g&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lr&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;updates&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;updates&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__call__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;optax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;GradientTransformation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;init&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;update&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nd&#34;&gt;@d2l.add_to_class&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LinearRegressionScratch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#@save&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;configure_optimizers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;SGD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;344-training&#34;&gt;3.4.4 Training&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Initialize parameters &lt;strong&gt;(ğ‘¤, ğ‘)&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Repeat until done:
&lt;ul&gt;
&lt;li&gt;Compute gradient &lt;strong&gt;ğ &lt;/strong&gt; â† âˆ‚&lt;sub&gt;(ğ‘¤,ğ‘)&lt;/sub&gt; (1 / |ğ”…|) âˆ‘&lt;sub&gt;ğ‘–âˆˆğ”…&lt;/sub&gt; ğ‘™(ğ±&lt;sup&gt;(ğ‘–)&lt;/sup&gt;, ğ‘¦&lt;sup&gt;(ğ‘–)&lt;/sup&gt;, &lt;strong&gt;ğ‘¤&lt;/strong&gt;, &lt;strong&gt;ğ‘&lt;/strong&gt;)&lt;/li&gt;
&lt;li&gt;Update parameters (&lt;strong&gt;ğ‘¤&lt;/strong&gt;, &lt;strong&gt;ğ‘&lt;/strong&gt;) â† (&lt;strong&gt;ğ‘¤&lt;/strong&gt;, &lt;strong&gt;ğ‘&lt;/strong&gt;) âˆ’ Î· &lt;strong&gt;ğ &lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nd&#34;&gt;@d2l.add_to_class&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d2l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Trainer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#@save&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;prepare_batch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nd&#34;&gt;@d2l.add_to_class&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d2l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Trainer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#@save&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;fit_epoch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;training&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;state&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;batch_stats&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# Mutable states will be used later (e.g. for batch norm)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;train_dataloader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mutated_vars&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;grads&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;training_step&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;state&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;prepare_batch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;state&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;state&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;apply_gradients&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grads&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grads&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;c1&#34;&gt;# can be ignored for models without dropout layers&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;state&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;state&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dropout_rng&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;jax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;split&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;state&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dropout_rng&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;state&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;state&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;batch_stats&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mutated_vars&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;batch_stats&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;train_batch_idx&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;train_dataloader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;grads&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;training_step&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;state&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;prepare_batch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;state&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;state&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;apply_gradients&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grads&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grads&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;c1&#34;&gt;# Can be ignored for models without dropout layers&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;state&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;state&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dropout_rng&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;jax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;split&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;state&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dropot_rng&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;train_batch_idx&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;val_dataloader&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;training&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;  &lt;span class=&#34;kc&#34;&gt;False&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;val_dataloader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;validation_step&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;state&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;prepare_batch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;val_batch_idx&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Testing with SyntheticRegressionData classs&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;LinearRegressionScratch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lr&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.03&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d2l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SyntheticRegressionData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;3.4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;4.2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;trainer&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d2l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Trainer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;max_epochs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;trainer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;params&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;trainer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;state&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;error in estimating w: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;w&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;reshape&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shape&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;error in estimating b: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;error&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;estimating&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.07147813&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.19255161&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;error&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;estimating&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.24309802&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;345-summary&#34;&gt;3.4.5 Summary&lt;/h3&gt;
&lt;p&gt;We implemented the following:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;dataloader&lt;/li&gt;
&lt;li&gt;model&lt;/li&gt;
&lt;li&gt;loss function&lt;/li&gt;
&lt;li&gt;optimization procedure&lt;/li&gt;
&lt;/ol&gt;
</description>
    </item>
    
    <item>
      <title>D2L - Chapter 3.5 Concise Implementation of Linear Regression</title>
      <link>http://localhost:1313/post/2025-04-20-chapter-3-5-concise-implementation-of-linear-regression/</link>
      <pubDate>Sun, 20 Apr 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-04-20-chapter-3-5-concise-implementation-of-linear-regression/</guid>
      <description>&lt;h2 id=&#34;35-concise-implementation-of-linear-regression&#34;&gt;3.5 Concise Implementation of Linear Regression&lt;/h2&gt;
&lt;h3 id=&#34;351-defining-the-model&#34;&gt;3.5.1 Defining the Model&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;LinearRegression&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d2l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Module&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#@save&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;lr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;float&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;setup&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;net&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Dense&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;kernel_init&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;initializers&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;normal&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.01&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nd&#34;&gt;@d2l.add_to_class&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LinearRegression&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#@save&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;forward&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;net&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;352-defining-the-loss-function&#34;&gt;3.5.2 Defining the Loss Function&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nd&#34;&gt;@d2l.add_to_class&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LinearRegression&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#@save&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;loss&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;y_hat&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;state&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;apply_fn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;({&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;params&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;},&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;optax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l2_loss&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y_hat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;353-defining-the-optimization-algorithm&#34;&gt;3.5.3 Defining the Optimization Algorithm&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nd&#34;&gt;@d2l.add_to_class&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LinearRegression&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#@save&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;configure_optimizers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;optax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sgd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;354-training&#34;&gt;3.5.4 Training&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;model = LinearRegression(lr=0.03)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;data = d2l.SyntheticRegressionData(w=jnp.array([2, -3.4]), b=4.2)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;trainer = d2l.Trainer(max_epochs=3)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;trainer.fit(model, data)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;@d2l.add_to_class(LinearRegression)  #@save
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;def get_w_b(self, state):
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    net = state.params[&amp;#39;net&amp;#39;]
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    return net[&amp;#39;kernel&amp;#39;], net[&amp;#39;bias&amp;#39;]
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;w, b = model.get_w_b(trainer.state)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
    
    <item>
      <title>D2L - Chapter 3.6 Generalization</title>
      <link>http://localhost:1313/post/2025-04-20-chapter-3-6-generalization/</link>
      <pubDate>Sun, 20 Apr 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-04-20-chapter-3-6-generalization/</guid>
      <description>&lt;h2 id=&#34;36-generalization&#34;&gt;3.6 Generalization&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Exploring both what is known about the principles underlying generalization in various models&lt;/li&gt;
&lt;li&gt;Also heuristic techniques that have been found (empirically) to yield improved generalization on tasks of practical interest.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;361-training-error-and-generalization-error&#34;&gt;3.6.1 Training Error and Generalization Error&lt;/h3&gt;
&lt;h4 id=&#34;3611-model-complexity&#34;&gt;3.6.1.1 Model Complexity&lt;/h4&gt;
&lt;h3 id=&#34;362-underfitting-or-overfitting&#34;&gt;3.6.2 Underfitting or Overfitting&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Underfitting, both error high&lt;/li&gt;
&lt;li&gt;Overfitting, training error low, validation error high&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;3621-polynomial-curve-fitting&#34;&gt;3.6.2.1 Polynomial Curve Fitting&lt;/h4&gt;
&lt;h4 id=&#34;3622-dataset-size&#34;&gt;3.6.2.2 Dataset Size&lt;/h4&gt;
&lt;h3 id=&#34;363-model-selection&#34;&gt;3.6.3 Model Selection&lt;/h3&gt;
&lt;h4 id=&#34;3631-cross-validation&#34;&gt;3.6.3.1 Cross-validation&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;split into k&lt;/li&gt;
&lt;li&gt;train on k - 1, validate on the remaining&lt;/li&gt;
&lt;li&gt;average among all the errors&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;364-summary&#34;&gt;3.6.4 Summary&lt;/h3&gt;
</description>
    </item>
    
    <item>
      <title>D2L - Chapter 3.7 Weight Decay</title>
      <link>http://localhost:1313/post/2025-04-20-chapter-3-7-weight-decay/</link>
      <pubDate>Sun, 20 Apr 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-04-20-chapter-3-7-weight-decay/</guid>
      <description>&lt;h2 id=&#34;37-weight-decay&#34;&gt;3.7 Weight Decay&lt;/h2&gt;
&lt;h3 id=&#34;371-norms-and-weight-decay&#34;&gt;3.7.1 Norms and Weight Decay&lt;/h3&gt;
&lt;p&gt;The total loss with weight decay is:&lt;/p&gt;
$$
\mathcal{L}_{\text{total}} = \mathcal{L}_{\text{original}} + \lambda \|\mathbf{w}\|^2
$$
&lt;p&gt;Where:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;\( \mathcal{L}\_{\text{original}} \) is the original loss (e.g., cross-entropy)&lt;/li&gt;
&lt;li&gt;\( \lambda \) is the weight decay coefficient&lt;/li&gt;
&lt;li&gt;\( \|\mathbf{w}\|^2 \) is the squared L2 norm of the weights&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The weight update rule with weight decay for linear regression is:&lt;/p&gt;
$$
\mathbf{w} \leftarrow (1 - \eta \lambda)\mathbf{w} - \frac{\eta}{|\mathcal{B}|} \sum_{i \in \mathcal{B}} \mathbf{x}^{(i)} \left( \mathbf{w}^\top \mathbf{x}^{(i)} + b - y^{(i)} \right)
$$
&lt;h3 id=&#34;372-high-dimensional-linear-regression&#34;&gt;3.7.2 High-Dimensional Linear Regression&lt;/h3&gt;
&lt;h3 id=&#34;373-implementation-from-scratch&#34;&gt;3.7.3 Implementation From Scratch&lt;/h3&gt;
&lt;h4 id=&#34;3731-defining-norm-penalty&#34;&gt;3.7.3.1. Defining Norm Penalty&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;l2_penalty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;w&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;**&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;3732-defining-the-model&#34;&gt;3.7.3.2. Defining the Model&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;WeightDecayScratch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d2l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LinearRegressionScratch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;lambd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;loss&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;super&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;loss&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lambd&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;l2_penalty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;num_train&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;20&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;num_val&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;num_inputs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;200&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;batch_size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;trainer&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d2l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Trainer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;max_epochs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;train_scratch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lambd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;WeightDecayScratch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;num_inputs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;200&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lambd&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lambd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lr&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.01&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;board&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;yscale&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;log&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;trainer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;L2 norm of w:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;nb&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l2_penalty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;trainer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;state&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;3733-training-without-regularization&#34;&gt;3.7.3.3 Training without Regularization&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;train_scratch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;train_scratch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;374-concise-implementation&#34;&gt;3.7.4. Concise Implementation&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;WeightDecay&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d2l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LinearRegression&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;wd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;configure_optimizers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# Weight Decay is not available directly within optax.sgd, but&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# optax allows chaining several transformations together&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;optax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;chain&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;optax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;additive_weight_decay&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;wd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                           &lt;span class=&#34;n&#34;&gt;optax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sgd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;WeightDecay&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;wd&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lr&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.01&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;board&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;yscale&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;log&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;trainer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;L2 norm of w:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l2_penalty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get_w_b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;trainer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;375-summary&#34;&gt;3.7.5. Summary&lt;/h3&gt;
</description>
    </item>
    
    <item>
      <title>D2L - Chapter 3.1 Linear Regression</title>
      <link>http://localhost:1313/post/2025-04-19-chapter-3-1-linear-regression/</link>
      <pubDate>Sat, 19 Apr 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-04-19-chapter-3-1-linear-regression/</guid>
      <description>&lt;h2 id=&#34;31-linear-regression&#34;&gt;3.1 Linear Regression&lt;/h2&gt;
&lt;h3 id=&#34;311-basics&#34;&gt;3.1.1 Basics&lt;/h3&gt;
&lt;h4 id=&#34;3111-model&#34;&gt;3.1.1.1 Model&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;y = wx + b&lt;/li&gt;
&lt;li&gt;search for the best w and b&lt;/li&gt;
&lt;li&gt;measure of the quality of some given model (todo - 1)&lt;/li&gt;
&lt;li&gt;a procedure for updating the model to improve its quality (todo - 2)&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;3112-loss-function&#34;&gt;3.1.1.2 Loss Function&lt;/h4&gt;
$$
L(\mathbf{w}, b)
      = \frac{1}{n} \sum_{i=1}^{n} l^{(i)}(\mathbf{w}, b)
      = \frac{1}{n} \sum_{i=1}^{n} \frac{1}{2}\!\left(\mathbf{w}^\top \mathbf{x}^{(i)} + b - y^{(i)}\right)^{2}. \tag{3.1.6}
$$
&lt;h4 id=&#34;3113-analytic-solution&#34;&gt;3.1.1.3 Analytic Solution&lt;/h4&gt;
$$
\partial_{\mathbf{w}} \| \mathbf{y} - \mathbf{Xw} \|^2 = 2 \mathbf{X}^\top (\mathbf{Xw} - \mathbf{y}) = 0
\quad \text{and hence} \quad
\mathbf{X}^\top \mathbf{y} = \mathbf{X}^\top \mathbf{Xw}. \tag{3.1.8}
$$
&lt;p&gt;Solving for $\mathbf{w}$ provides us with the optimal solution for the optimization problem. Note that this solution&lt;/p&gt;
$$
\mathbf{w}^* = (\mathbf{X}^\top \mathbf{X})^{-1} \mathbf{X}^\top \mathbf{y} \tag{3.1.9}
$$
&lt;h4 id=&#34;3114-minibatch-stochastic-gradient-descent&#34;&gt;3.1.1.4 Minibatch Stochastic Gradient Descent&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;Gradient Descent&lt;/li&gt;
&lt;li&gt;Stochastic Gradient Descent (SGD)&lt;/li&gt;
&lt;li&gt;MiniBatch SGD
$$
   \mathbf{w} \leftarrow \mathbf{w} - \frac{\eta}{|\mathcal{B}|} \sum_{i \in \mathcal{B}_t} \partial_{\mathbf{w}} l^{(i)}(\mathbf{w}, b)
   = \mathbf{w} - \frac{\eta}{|\mathcal{B}|} \sum_{i \in \mathcal{B}_t} \mathbf{x}^{(i)} \left( \mathbf{w}^\top \mathbf{x}^{(i)} + b - y^{(i)} \right)
   \tag{3.1.11}
   $$&lt;/li&gt;
&lt;/ol&gt;
$$
b \leftarrow b - \frac{\eta}{|\mathcal{B}|} \sum_{i \in \mathcal{B}_t} \partial_b l^{(i)}(\mathbf{w}, b)
= b - \frac{\eta}{|\mathcal{B}|} \sum_{i \in \mathcal{B}_t} \left( \mathbf{w}^\top \mathbf{x}^{(i)} + b - y^{(i)} \right).
$$
&lt;h4 id=&#34;3115-predictions&#34;&gt;3.1.1.5 Predictions&lt;/h4&gt;
&lt;p&gt;Plug w and b to predict y&lt;/p&gt;
&lt;h3 id=&#34;312-vectorization-for-speed&#34;&gt;3.1.2 vectorization for Speed&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;jax&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;tensorflow&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ones&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ones&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# JAX arrays are immutable, meaning that once created their contents&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# cannot be changed. For updating individual elements, JAX provides&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# an indexed update syntax that returns an updated copy&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;zeros&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;at&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;.5f&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; sec&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;/*&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;22&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*/&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;.5f&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt; sec&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;/*&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.017&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*/&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;313-the-normal-distribution-and-squared-loss&#34;&gt;3.1.3 The Normal Distribution and Squared Loss&lt;/h3&gt;
&lt;h3 id=&#34;314-linear-regression-as-a-neural-network&#34;&gt;3.1.4 Linear Regression as a Neural Network&lt;/h3&gt;
&lt;h4 id=&#34;3141-biology&#34;&gt;3.1.4.1 Biology&lt;/h4&gt;
&lt;h3 id=&#34;315-summary&#34;&gt;3.1.5 Summary&lt;/h3&gt;
&lt;p&gt;introduced/reviewed linear regression, the cornerstone of deep learning.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>D2L - Chapter 3.2 Object-Oriented Design for Implementation</title>
      <link>http://localhost:1313/post/2025-04-19-chapter-3-2-ood/</link>
      <pubDate>Sat, 19 Apr 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-04-19-chapter-3-2-ood/</guid>
      <description>&lt;h2 id=&#34;32-object-oriented-design-for-implementation&#34;&gt;3.2 Object-Oriented Design for Implementation&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Module contains models, losses, and optimization methods&lt;/li&gt;
&lt;li&gt;DataModule provides data loaders for training and validation&lt;/li&gt;
&lt;li&gt;Both classes are combined using Trainer class which allows us to train models on a variety of hardware platforms.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Most code in this book adapts Module and DataModule. We will touch upon the Trainer class only when we discuss GPUs, CPUs, parallel training, and optimization algorithms.&lt;/p&gt;
&lt;h3 id=&#34;321-utilities&#34;&gt;3.2.1 Utilities&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;add_to_class&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Class&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;#@save&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;Register functions as methods in created class.&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;wrapper&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;obj&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;setattr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Class&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;obj&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;vm&#34;&gt;__name__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;obj&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;wrapper&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nd&#34;&gt;@add_to_class&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;do&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Class attribute &amp;#34;b&amp;#34; is&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;do&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Class attribute &amp;#34;b&amp;#34; is 1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;HyperParameters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;#@save&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;The base class of hyperparameters.&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;save_hyperparameters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ignore&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[]):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;raise&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;NotImplemented&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Call the fully implemented HyperParameters class saved in d2l&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;B&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d2l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;HyperParameters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;save_hyperparameters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ignore&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;c&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;self.a =&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;self.b =&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;There is no self.c =&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;hasattr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;c&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;B&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;ProgressBoard&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d2l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;HyperParameters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;#@save&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;The board that plots data points in animation.&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;xlabel&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ylabel&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;xlim&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                 &lt;span class=&#34;n&#34;&gt;ylim&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;xscale&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;linear&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;yscale&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;linear&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                 &lt;span class=&#34;n&#34;&gt;ls&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;-&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;--&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;-.&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;colors&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;C0&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;C1&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;C2&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;C3&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                 &lt;span class=&#34;n&#34;&gt;fig&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;axes&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;figsize&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;3.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;2.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;display&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;save_hyperparameters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;draw&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;label&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;every_n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;raise&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;NotImplemented&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;board&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d2l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ProgressBoard&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;x&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arange&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;board&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;draw&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;sin&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;every_n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;board&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;draw&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;cos&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;every_n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;322-models&#34;&gt;3.2.2 Models&lt;/h3&gt;
&lt;p&gt;The Module class is the base class of all models that we will implement. At the very least we need three models. The first, &lt;strong&gt;init&lt;/strong&gt; stores the learnable parameters, the &lt;strong&gt;training_step&lt;/strong&gt; method accepts a data batch to return the loss value, and finally, &lt;strong&gt;configure_optimizers&lt;/strong&gt; returns the optimization method, or a list of them, that is used to update the learnable parameters. Optionally, we can define &lt;strong&gt;validation_steps&lt;/strong&gt; to report the evaluation measures. Sometimes we put the code for computing the output into a separate of &lt;strong&gt;forward&lt;/strong&gt; method to make it more resubale.&lt;/p&gt;
&lt;p&gt;With the introduce of dataclasses in Python3.7, classes decorated with @dataclass automatically add magic methods such as &lt;strong&gt;init&lt;/strong&gt; and &lt;strong&gt;repr&lt;/strong&gt;. The member variables are defined using type annotations. All Flax modules are Python 3.7 dataclasses.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Module&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Module&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d2l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;HyperParameters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#@save&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;The base class of models&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# No need for save_hyperparam when using Python dataclass.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;plot_train_per_epoch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;default&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;init&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;plot_valid_per_epoch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;default&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;init&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# Use default_factory to make sure new plots are generated on each run.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;board&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ProgressBoard&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;default_factory&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ProgressBoard&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;init&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;loss&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y_hat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;raise&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;NotImplementedError&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# JAX &amp;amp; Flax do not have a forward-method-like syntax. Flax uses setup&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# and built-in __call__ magic methods for forward pass. Adding here&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# for consistency&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;forward&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;**&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;kwargs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;assert&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;hasattr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;net&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Neural network is defined&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;net&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;**&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;kwargs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;plot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;train&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;Plot a point in animation.&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;assert&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;hasattr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;trainer&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Trainer is not inited&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;board&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;xlabel&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;epoch&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;train&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;trainer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;train_batch_idx&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; \
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;trainer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;num_train_batches&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;trainer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;num_train_batches&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; \
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;plot_train_per_epoch&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;trainer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;epoch&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;trainer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;num_val_batches&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; \
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;plot_valid_per_epoch&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;board&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;draw&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;device_put&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d2l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cpu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                        &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;train_&amp;#39;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;train&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;val_&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                        &lt;span class=&#34;n&#34;&gt;every_n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;training_step&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;grads&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value_and_grad&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;loss&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                                 &lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;plot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;loss&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;train&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;grads&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;validation_step&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;l&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;loss&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;plot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;loss&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;train&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;apply_init&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dummy_input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;To be defined later in :numref:`sec_lazy_init`&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;raise&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;NotImplementedError&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;configure_optimizers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;raise&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;NotImplementedError&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;323-data&#34;&gt;3.2.3 Data&lt;/h3&gt;
&lt;p&gt;The Datamodule class is the base class for data. Quite frequently the &lt;strong&gt;init&lt;/strong&gt; method is used to prepare the data.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;DataModule&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d2l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;HyperParameters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;#@save&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;The base class of data.&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;root&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;../data&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;save_hyperparameters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;get_dataloader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;train&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;raise&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;NotImplementedError&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;train_dataloader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get_dataloader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;train&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;val_dataloader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get_dataloader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;train&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;324-training&#34;&gt;3.2.4 Training&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Trainer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d2l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;HyperParameters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;#@save&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;The base class for training models with data.&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;max_epochs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;num_gpus&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;gradient_clip_val&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;save_hyperparameters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;assert&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;num_gpus&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;No GPU support yet&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;prepare_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;train_dataloader&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;train_dataloader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;val_dataloader&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;val_dataloader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;num_train_batches&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;train_dataloader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;num_val_batches&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;val_dataloader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;val_dataloader&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;prepare_model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;trainer&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;board&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;xlim&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;max_epochs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;fit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;prepare_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;prepare_model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;optim&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;configure_optimizers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;root_key&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d2l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get_key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;root_key&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;params_key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dropout_key&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;split&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;root_key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;key&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;params&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;params_key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;dropout&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dropout_key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;dummy_input&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;next&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;iter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;train_dataloader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))[:&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;variables&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;apply_init&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dummy_input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;params&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;variables&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;params&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;batch_stats&amp;#39;&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;variables&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;keys&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;c1&#34;&gt;# Here batch_stats will be used later (e.g., for batch norm)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;batch_stats&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;variables&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;batch_stats&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;batch_stats&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# Flax uses optax under the hood for a single state obj TrainState.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# More will be discussed later in the dropout and batch&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# normalization section&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;TrainState&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;train_state&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;TrainState&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;batch_stats&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Any&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;dropout_rng&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PRNGKeyArray&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;state&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;TrainState&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;create&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;apply_fn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;apply&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                       &lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                       &lt;span class=&#34;n&#34;&gt;batch_stats&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;batch_stats&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                       &lt;span class=&#34;n&#34;&gt;dropout_rng&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dropout_key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                       &lt;span class=&#34;n&#34;&gt;tx&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;configure_optimizers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;epoch&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;train_batch_idx&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;val_batch_idx&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;epoch&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;max_epochs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fit_epoch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;fit_epoch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;raise&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;NotImplementedError&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;325-summary&#34;&gt;3.2.5 Summary&lt;/h3&gt;
&lt;p&gt;This object-oriented design provides moduality.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>D2L - Chapter 3.3 Synthetic Regression Data</title>
      <link>http://localhost:1313/post/2025-04-19-chapter-3-3-synthetic-regression-data/</link>
      <pubDate>Sat, 19 Apr 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-04-19-chapter-3-3-synthetic-regression-data/</guid>
      <description>&lt;h2 id=&#34;33-synthetic-regression-data&#34;&gt;3.3 Synthetic Regression Data&lt;/h2&gt;
&lt;h3 id=&#34;331-generating-the-dataset&#34;&gt;3.3.1 Generating the Dataset&lt;/h3&gt;
&lt;p&gt;generate the fake data&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;SyntheticRegressionData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d2l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;DataModule&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;#@save&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;Synthetic data for linear regression.&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;noise&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.01&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;num_train&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;num_val&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                 &lt;span class=&#34;n&#34;&gt;batch_size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;super&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;save_hyperparameters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;num_train&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;num_val&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;key&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PRNGKey&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;key1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;key2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;split&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;X&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;normal&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shape&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;noise&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;normal&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;noise&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;matmul&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;reshape&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;noise&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;332-reading-the-dataset&#34;&gt;3.3.2 Reading the Dataset&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nd&#34;&gt;@d2l.add_to_class&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SyntheticRegressionData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;get_dataloader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;train&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;train&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;indices&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;num_train&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# The examples are read in random order&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shuffle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;indices&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;indices&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;num_train&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;num_train&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;num_val&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;indices&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;batch_size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;batch_indices&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;indices&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;batch_size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;yield&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;batch_indices&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;batch_indices&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;333-concise-implementation-of-the-data-loader&#34;&gt;3.3.3 Concise Implementation of the Data Loader&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nd&#34;&gt;@d2l.add_to_class&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d2l&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;DataModule&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;#@save&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;get_tensorloader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tensors&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;train&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;indices&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;slice&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;tensors&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;tuple&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;indices&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tensors&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# Use Tensorflow Datasets &amp;amp; Dataloader. JAX or Flax do not provide&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# any dataloading functionality&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;shuffle_buffer&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tensors&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shape&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;train&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tfds&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;as_numpy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;tf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Dataset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;from_tensor_slices&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tensors&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shuffle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;buffer_size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shuffle_buffer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;batch_size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nd&#34;&gt;@d2l.add_to_class&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SyntheticRegressionData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;#@save&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;get_dataloader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;train&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;slice&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;num_train&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;train&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;slice&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;num_train&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get_tensorloader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;train&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;334-summary&#34;&gt;3.3.4 Summary&lt;/h3&gt;
</description>
    </item>
    
    <item>
      <title>D2L - Chapter 2.6 Probablity and Statistics &#43; 2.7  Documentation</title>
      <link>http://localhost:1313/post/2025-04-12-chapter-2-6&#43;7-probabilty-and-statistics&#43;documentation/</link>
      <pubDate>Sat, 12 Apr 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-04-12-chapter-2-6&#43;7-probabilty-and-statistics&#43;documentation/</guid>
      <description>&lt;h2 id=&#34;probablity-and-statistics&#34;&gt;Probablity and Statistics&lt;/h2&gt;
&lt;h3 id=&#34;covariance-matrix-diagonal--off-diagonal-entries&#34;&gt;Covariance Matrix, Diagonal &amp;amp; Off-Diagonal Entries&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Covariance Matrix&lt;/strong&gt;&lt;br&gt;
A covariance matrix \(\Sigma\) is a square matrix that shows the covariance between each pair of coordinates in a random vector. It is:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Symmetric&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Positive semidefinite&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Diagonal Entries&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Each diagonal entry \(\Sigma\_{ii}\) is the &lt;strong&gt;variance&lt;/strong&gt; of the \(i\)-th coordinate, denoted \(\mathrm{Var}(x_i)\).&lt;/li&gt;
&lt;li&gt;Variance measures how spread out the \(i\)-th coordinate is around its mean.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Off-Diagonal Entries&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Each off-diagonal entry \(\Sigma\_{ij}\) (with \(i \neq j\)) is the &lt;strong&gt;covariance&lt;/strong&gt; \(\mathrm{Cov}(x_i, x_j)\).&lt;/li&gt;
&lt;li&gt;Positive covariance means the two coordinates tend to vary in the same direction (above/below their means together), negative covariance indicates they move in opposite directions, and zero covariance indicates no linear co-movement.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Why Symmetric?&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Because \(\mathrm{Cov}(x_i, x_j) = \mathrm{Cov}(x_j, x_i)\), the matrix \(\Sigma\) must be symmetric.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;documentation&#34;&gt;Documentation&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;dir&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;jax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;help&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;jax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;numpy&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ones&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
    
    <item>
      <title>D2L - Chapter 2.4 Calculus &#43; 2.5 Automatic Differentiation</title>
      <link>http://localhost:1313/post/2025-04-09-d2l-chapter-2-4&#43;5-calculus&#43;automatic-differentiation/</link>
      <pubDate>Wed, 09 Apr 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-04-09-d2l-chapter-2-4&#43;5-calculus&#43;automatic-differentiation/</guid>
      <description>&lt;h2 id=&#34;24-calculus&#34;&gt;2.4 Calculus&lt;/h2&gt;
&lt;h3 id=&#34;241-derivatives-and-differentiation&#34;&gt;2.4.1 Derivatives and Differentiation&lt;/h3&gt;
&lt;h3 id=&#34;242-visualization-utilities&#34;&gt;2.4.2 Visualization Utilities&lt;/h3&gt;
&lt;h3 id=&#34;243-partial-derivatives-and-gradients&#34;&gt;2.4.3 Partial Derivatives and Gradients&lt;/h3&gt;
&lt;p&gt;When there is no ambiguity, âˆ‡â‚“f(&lt;strong&gt;x&lt;/strong&gt;) is typically replaced by âˆ‡f(&lt;strong&gt;x&lt;/strong&gt;). The following rules come in handy for differentiating multivariate functions:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;For all &lt;strong&gt;A&lt;/strong&gt; âˆˆ â„áµË£â¿ we have âˆ‡â‚“(&lt;strong&gt;A&lt;/strong&gt;x) = &lt;strong&gt;A&lt;/strong&gt;áµ€ and âˆ‡â‚“(&lt;strong&gt;x&lt;/strong&gt;áµ€&lt;strong&gt;A&lt;/strong&gt;) = &lt;strong&gt;A&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;For square matrices &lt;strong&gt;A&lt;/strong&gt; âˆˆ â„â¿Ë£â¿ we have that âˆ‡â‚“(&lt;strong&gt;x&lt;/strong&gt;áµ€&lt;strong&gt;A&lt;/strong&gt;x) = (&lt;strong&gt;A&lt;/strong&gt; + &lt;strong&gt;A&lt;/strong&gt;áµ€)&lt;strong&gt;x&lt;/strong&gt; and in particular&lt;br&gt;
âˆ‡â‚“â€–&lt;strong&gt;x&lt;/strong&gt;â€–Â² = âˆ‡â‚“(&lt;strong&gt;x&lt;/strong&gt;áµ€&lt;strong&gt;x&lt;/strong&gt;) = 2&lt;strong&gt;x&lt;/strong&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;244-chain-rule&#34;&gt;2.4.4 Chain Rule&lt;/h3&gt;
&lt;h3 id=&#34;245-discussion&#34;&gt;2.4.5 Discussion&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Automatic differentiation&lt;/strong&gt; allows us to compute gradients systematically using composition rules, freeing up cognitive effort for higher-level tasks.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Gradient computation&lt;/strong&gt; for vector-valued functions involves matrix multiplication, following the chain of variable dependencies.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Dependency graphs&lt;/strong&gt;:
&lt;ul&gt;
&lt;li&gt;Evaluated &lt;strong&gt;forward&lt;/strong&gt; to compute function outputs.&lt;/li&gt;
&lt;li&gt;Traversed &lt;strong&gt;backward&lt;/strong&gt; to compute gradients (backpropagation).&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Backpropagation&lt;/strong&gt; is a computational application of the chain rule, introduced formally in later chapters.&lt;/li&gt;
&lt;li&gt;In &lt;strong&gt;optimization&lt;/strong&gt;, gradients indicate how to adjust model parameters to reduce the loss.&lt;/li&gt;
&lt;li&gt;Every step of an optimization algorithm relies on computing the gradient.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;25-automatic-differentiation&#34;&gt;2.5 Automatic Differentiation&lt;/h2&gt;
&lt;h3 id=&#34;251-a-simple-function&#34;&gt;2.5.1 A simple function&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;jax&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;grad&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arange&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;4.0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;lambda&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# The `grad` transform returns a Python function that&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# computes the gradient of the original function&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;x_grad&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;grad&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;x_grad&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;252-backward-for-non-scalar-variables&#34;&gt;2.5.2 Backward for Non-Scalar Variables&lt;/h3&gt;
&lt;h3 id=&#34;253-detaching-computation&#34;&gt;2.5.3 Detaching Computation&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;move some calculations outside the recorded computational graph&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;254-gradients-and-python-control-flow&#34;&gt;2.5.4. Gradients and Python Control Flow&lt;/h3&gt;
&lt;h3 id=&#34;255-discussion&#34;&gt;2.5.5 Discussion&lt;/h3&gt;
&lt;p&gt;For now, try to remember these basics:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;(i) attach gradients to those variables with respect to which we desire derivatives;&lt;/li&gt;
&lt;li&gt;(ii) record the computation of the target value;&lt;/li&gt;
&lt;li&gt;(iii) execute the backpropagation function;&lt;/li&gt;
&lt;li&gt;(iv) access the resulting gradient.&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>D2L - Chapter 2.2 Data Preprocessing &#43; 2.3 Linear Algebra</title>
      <link>http://localhost:1313/post/2025-04-08-d2l-chapter-2-2&#43;3-data-preprocessing&#43;linear-algebra/</link>
      <pubDate>Tue, 08 Apr 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-04-08-d2l-chapter-2-2&#43;3-data-preprocessing&#43;linear-algebra/</guid>
      <description>&lt;h2 id=&#34;22-data-preprocessing&#34;&gt;2.2 Data Preprocessing&lt;/h2&gt;
&lt;h3 id=&#34;221-reading-the-dataset&#34;&gt;2.2.1 Reading the Dataset&lt;/h3&gt;
&lt;h3 id=&#34;222-data-preparation&#34;&gt;2.2.2 Data Preparation&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;inputs&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pd&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get_dummies&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inputs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dummy_na&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;inputs&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;inputs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fillna&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inputs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;223-conversion-to-the-tensor-format&#34;&gt;2.2.3 Conversion To the Tensor Format&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;jax&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;numpy&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;X&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inputs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to_numpy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dtype&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;targets&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to_numpy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dtype&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;23-linear-algebra&#34;&gt;2.3 Linear Algebra&lt;/h2&gt;
&lt;h3 id=&#34;231-scalars&#34;&gt;2.3.1 Scalars&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;x = jnp.array(3.0)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;y = jnp.array(2.0)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;232-vectors&#34;&gt;2.3.2 Vectors&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;x = jnp.arange(3)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;x
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;x[2]
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;len(x)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;x.shape
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;233-matrices&#34;&gt;2.3.3 Matrices&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arange&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;reshape&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;T&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;T&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;234-tensors&#34;&gt;2.3.4 Tensors&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arange&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;24&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;reshape&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;235-basic-properties-of-tensor-arithmetic&#34;&gt;2.3.5 Basic Properties of Tensor Arithmetic&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;element-wise addition&lt;/li&gt;
&lt;li&gt;element-wise multiplication (Hadamard Product)&lt;/li&gt;
&lt;li&gt;element * scalar&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;236-reduction&#34;&gt;2.3.6 Reduction&lt;/h3&gt;
&lt;p&gt;By default, invoking the sum function reduces a tensor along all of its axes, eventually producing a scalar. Our libraries also allow us to [specify the axes along which the tensor should be reduced.] To sum over all elements along the rows (axis 0), we specify axis=0 in sum. Since the input matrix reduces along axis 0 to generate the output vector, this axis is missing from the shape of the output.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shape&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;axis&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shape&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;C&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arange&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;24&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;reshape&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;axis&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;237-non-reduction-sum&#34;&gt;2.3.7 Non-Reduction Sum&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;print(A)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sum_A = A.sum(axis=1, keepdims=True)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sum_A, sum_A.shape
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;[[0. 1. 2.]
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; [3. 4. 5.]]
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;(Array([[ 3.],
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        [12.]], dtype=float32),
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; (2, 1))
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;A.cumsum(axis=0)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;238-dot-products&#34;&gt;2.3.8 Dot Products&lt;/h3&gt;
&lt;p&gt;weighted sum/ weighted average&amp;hellip;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ones&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dtype&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;float32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;239-matrix-vector-products&#34;&gt;2.3.9 Matrix-Vector Products&lt;/h3&gt;
&lt;h3 id=&#34;2310-matrix-matrix-products&#34;&gt;2.3.10 Matrix-Matrix Products&lt;/h3&gt;
&lt;p&gt;n&lt;em&gt;k X k&lt;/em&gt;m
-&amp;gt; n * m dot products&lt;/p&gt;
&lt;h3 id=&#34;2311-norms&#34;&gt;2.3.11 Norms&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;u = jnp.array([3.0, -4.0])
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;jnp.linalg.norm(u)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;jnp.linalg.norm(u, ord=1) # same as jnp.abs(u).sum()
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;jnp.linalg.norm(jnp.ones((4, 9)))
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;2312-discussions&#34;&gt;2.3.12 Discussions&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Scalars, vectors, matrices, and tensors are the basic mathematical objects used in linear algebra and have zero, one, two, and an arbitrary number of axes, respectively.&lt;/li&gt;
&lt;li&gt;Tensors can be sliced or reduced along specified axes via indexing, or operations such as sum and mean, respectively.&lt;/li&gt;
&lt;li&gt;Elementwise products are called Hadamard products. By contrast, dot products, matrixâ€“vector products, and matrixâ€“matrix products are not elementwise operations and in general return objects having shapes that are different from the the operands.&lt;/li&gt;
&lt;li&gt;Compared to Hadamard products, matrixâ€“matrix products take considerably longer to compute (cubic rather than quadratic time).&lt;/li&gt;
&lt;li&gt;Norms capture various notions of the magnitude of a vector (or matrix), and are commonly applied to the difference of two vectors to measure their distance apart.&lt;/li&gt;
&lt;li&gt;Common vector norms include the l1 and l2 norms, and common matrix norms include the spectral and Frobenius norms.&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>D2L - Chapter 2.1 Data Manipulation</title>
      <link>http://localhost:1313/post/2025-04-07-d2l-chapter-2-1-data-manipulation/</link>
      <pubDate>Mon, 07 Apr 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-04-07-d2l-chapter-2-1-data-manipulation/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://colab.research.google.com/github/d2l-ai/d2l-jax-colab/blob/master/chapter_preliminaries/ndarray.ipynb&#34;&gt;colab&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;211-get-started&#34;&gt;2.1.1 Get Started&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;jax&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;jax&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;numpy&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arange&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;mi&#34;&gt;9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dtype&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;int32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;12&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shape&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;X&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;reshape&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;X&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;zeros&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ones&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Any call of a random function in JAX requires a key to be&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# specified, feeding the same key to a random function will&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# always result in the same sample being generated&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;jax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;normal&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;jax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PRNGKey&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;personal-note&#34;&gt;Personal Note&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;shape -&amp;gt; (axis-0, axis-1, &amp;hellip;)&lt;/li&gt;
&lt;li&gt;reshape must be multiple&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;212-indexing-and-slicing&#34;&gt;2.1.2 Indexing and Slicing&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# JAX arrays are immutable. jax.numpy.ndarray.at index&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# update operators create a new array with the corresponding&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# modifications made&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;X_new_1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;at&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;17&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;X_new_1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;X_new_2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;X_new_1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;at&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;X_new_2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;213-operations&#34;&gt;2.1.3 Operations&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1.0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;**&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;X&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arange&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dtype&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;float32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;reshape&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Y&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([[&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;2.0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# axis sets which direction to stack, axis = 0, stacks on the row, meaning will have 6 in axis-0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;concatenate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;axis&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;concatenate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;axis&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;X&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Y&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;X&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;personal-note-1&#34;&gt;Personal Note&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;axis sets which direction to stack. For example, axis = 0, stacks on the row, meaning will have 6(3 + 3) items in axis-0.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;214-broadcasting&#34;&gt;2.1.4 Broadcasting&lt;/h3&gt;
&lt;p&gt;By now, you know how to perform elementwise binary operations on two tensors of the same shape. Under certain conditions, even when shapes differ, we can still [perform elementwise binary operations by invoking the broadcasting mechanism.] Broadcasting works according to the following two-step procedure: (i) expand one or both arrays by copying elements along axes with length 1 so that after this transformation, the two tensors have the same shape; (ii) perform an elementwise operation on the resulting arrays.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arange&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;reshape&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arange&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;reshape&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;personal-note-2&#34;&gt;Personal Note&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;broadcasting copies data to reach lcm and do computation.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;215-conversion-to-other-python-objects&#34;&gt;2.1.5 Conversion to Other Python Objects&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jnp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;3.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;ğŸ™…&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;ğŸ™…&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
    
    <item>
      <title>D2L - Introduction - 2/2</title>
      <link>http://localhost:1313/post/2025-04-07-d2l-chapter-1-2-introduction-2-complete/</link>
      <pubDate>Mon, 07 Apr 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-04-07-d2l-chapter-1-2-introduction-2-complete/</guid>
      <description>&lt;h2 id=&#34;132-unsupervised-and-self-supervised-learning&#34;&gt;1.3.2 UnSupervised and Self-Supervised Learning&lt;/h2&gt;
&lt;p&gt;The author lists the difference between traditional software engineering and machine learning. While software engineering focuses on solving problems with rule-based solutions, machine learning(deep learning) tries to solve problems that are ambiguous and the solution can evlove by itself after seeing more examples.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Clustering&lt;/li&gt;
&lt;li&gt;PCA&lt;/li&gt;
&lt;li&gt;Relationship, Rome - Italy = France - Paris&lt;/li&gt;
&lt;li&gt;causality and probabilistic graphical models&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;133-interacting-with-an-environment&#34;&gt;1.3.3 Interacting with an Environment&lt;/h3&gt;
&lt;h3 id=&#34;134-reinforcement-learning&#34;&gt;1.3.4 Reinforcement Learning&lt;/h3&gt;
&lt;h2 id=&#34;14-roots&#34;&gt;1.4 Roots&lt;/h2&gt;
&lt;h2 id=&#34;15-the-road-to-deep-learning&#34;&gt;1.5 The road to deep learning&lt;/h2&gt;
&lt;h2 id=&#34;16-success-stories&#34;&gt;1.6 Success Stories&lt;/h2&gt;
&lt;h2 id=&#34;17-the-essence-of-deep-learning&#34;&gt;1.7 The essence of deep learning&lt;/h2&gt;
&lt;p&gt;Thus, one key advantage of deep learning is that it replaces not only the shallow models at the end of traditional learning pipelines, but also the labor-intensive process of feature engineering.&lt;/p&gt;
&lt;h2 id=&#34;18-summary&#34;&gt;1.8 Summary&lt;/h2&gt;
&lt;h2 id=&#34;my-takeaway&#34;&gt;My takeaway&lt;/h2&gt;
&lt;p&gt;Chapter1. Introduction mainly discussed machine learning from data, definition, examples, history, current success, provided foundation to future studies.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>D2L - Introduction</title>
      <link>http://localhost:1313/post/2025-04-02-d2l-chapter-1-1-introduction-1/</link>
      <pubDate>Wed, 02 Apr 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-04-02-d2l-chapter-1-1-introduction-1/</guid>
      <description>&lt;h2 id=&#34;10-introduction&#34;&gt;1.0 Introduction&lt;/h2&gt;
&lt;p&gt;The author lists the difference between traditional software engineering and machine learning. While software engineering focuses on solving problems with rule-based solutions, machine learning(deep learning) tries to solve problems that are ambiguous and the solution can evlove by itself after seeing more examples.&lt;/p&gt;
&lt;h2 id=&#34;11-a-motivating-example&#34;&gt;1.1 A Motivating Example&lt;/h2&gt;
&lt;p&gt;The author lists an example of a wake word system where we feed model with data and let the model learn.&lt;/p&gt;
&lt;h2 id=&#34;12-key-components&#34;&gt;1.2 Key Components&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;The data that we can learn from.&lt;/li&gt;
&lt;li&gt;A model of how to transform the data.&lt;/li&gt;
&lt;li&gt;An objective function that quantifies how well or badly the model is doing.&lt;/li&gt;
&lt;li&gt;An algorithm to adjust the model&amp;rsquo;s parameters to optimize the objective function.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;121-data&#34;&gt;1.2.1 Data&lt;/h3&gt;
&lt;p&gt;Machine learning relies on data, which consists of examples represented numerically through features (inputs) and, in supervised learning, labels (targets). Examples include images or medical records, which can be structured as fixed-length vectorsâ€”but not all data fits this format, especially text or variable-sized inputs. Deep learning models handle such complexity more effectively than traditional methods. However, more data generally leads to better models, especially in deep learning, where large datasets are often essential. Crucially, the quality and representativeness of the data matter just as much as quantityâ€”biased or flawed data can lead to harmful and unfair outcomes, even without malicious intent.&lt;/p&gt;
&lt;h3 id=&#34;122-models&#34;&gt;1.2.2 Models&lt;/h3&gt;
&lt;p&gt;Most machine learning involves transforming input data to make predictions. A model refers to the system that performs this transformationâ€”taking data of one type and outputting another, such as predicting emotions from photos or detecting anomalies in sensor readings. While simple models can solve basic problems, more complex challenges often require more powerful tools. Deep learning stands out by using layered models that apply many transformations in sequence, hence the term deep. This approach enables tackling problems that push beyond the limits of classical methods, though traditional techniques still play a role along the way.&lt;/p&gt;
&lt;h3 id=&#34;123-objective-function&#34;&gt;1.2.3 Objective function&lt;/h3&gt;
&lt;p&gt;In machine learning, learning means improving performance at a task over time, which requires a clear way to measure improvement. These measurements are called objective functions or loss functions, which we usually define so that lower values are better. Common examples include squared error for regression and error rate for classification. Some losses are hard to optimize directly, so we often use surrogate objectives that are easier to work with.&lt;/p&gt;
&lt;p&gt;We train models by minimizing loss on a training dataset, treating the data as fixed and adjusting model parameters. However, strong performance on training data doesn&amp;rsquo;t guarantee success on new, unseen data. To evaluate generalization, we use a separate test dataset. If a model performs well on training data but poorly on test data, it&amp;rsquo;s said to be overfittingâ€”essentially memorizing rather than learning.&lt;/p&gt;
&lt;h3 id=&#34;124-optimization-algorithms&#34;&gt;1.2.4 Optimization Algorithms&lt;/h3&gt;
&lt;p&gt;ChatGPT said:
Once we have data, a model, and an objective function, the next step is to optimize the modelâ€™s parameters to minimize the loss. In deep learning, this is typically done using gradient descent. This algorithm works by computing how a small change in each parameter would affect the loss, then adjusting the parameters in the direction that reduces the loss. Repeating this process iteratively helps the model gradually improve its performance.&lt;/p&gt;
&lt;h2 id=&#34;13-kinds-of-machine-learning-problems&#34;&gt;1.3 Kinds of Machine Learning Problems&lt;/h2&gt;
&lt;h3 id=&#34;131-supervised-learning&#34;&gt;1.3.1 Supervised Learning&lt;/h3&gt;
&lt;h3 id=&#34;1311-regression&#34;&gt;1.3.1.1 Regression&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Question: How many?&lt;/li&gt;
&lt;li&gt;Loss: squared error&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;1312-classification&#34;&gt;1.3.1.2 Classification&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Question: Which one?&lt;/li&gt;
&lt;li&gt;Loss: cross-entropy&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;1313-tagging&#34;&gt;1.3.1.3 Tagging&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Question: multi-label classification&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;1314-search&#34;&gt;1.3.1.4 Search&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Question: releance scores&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;1315-recommender-system&#34;&gt;1.3.1.5 Recommender System&lt;/h3&gt;
&lt;h3 id=&#34;1316-sequence-learning&#34;&gt;1.3.1.6 Sequence Learning&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;They require a model either to ingest sequences of inputs or to emit sequences of outputs (or both).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Cases&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Tagging and Parsing: tag named entity&lt;/li&gt;
&lt;li&gt;Automatic Speech Recognition: challenge is that input is way longer than output&lt;/li&gt;
&lt;li&gt;Text to Speech: This is the inverse of asr.&lt;/li&gt;
&lt;li&gt;Machine Translation: input/output might not align in the same order.&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>An interesting Math problem</title>
      <link>http://localhost:1313/post/2025-03-26-interesting-math-problem/</link>
      <pubDate>Sat, 22 Mar 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-03-26-interesting-math-problem/</guid>
      <description>&lt;h2 id=&#34;-solve-the-equation&#34;&gt;ğŸ“˜ Solve the equation:&lt;/h2&gt;
\[
\sqrt{5 - x} = 5 - x^2
\]
&lt;hr&gt;
&lt;h3 id=&#34;-step-1-eliminate-the-square-root&#34;&gt;âœï¸ Step 1: Eliminate the square root&lt;/h3&gt;
&lt;p&gt;Square both sides:&lt;/p&gt;
\[
(\sqrt{5 - x})^2 = (5 - x^2)^2
\]
\[
5 - x = 25 + x^4 - 10x^2
\]
&lt;hr&gt;
&lt;h3 id=&#34;-step-2-rearrange-into-a-standard-polynomial-form&#34;&gt;âœï¸ Step 2: Rearrange into a standard polynomial form&lt;/h3&gt;
&lt;p&gt;Move all terms to one side:&lt;/p&gt;
\[
0 = x^4 - 5 - 10x^2 + x + 25
\]
&lt;hr&gt;
&lt;h3 id=&#34;-step-3-lets-use-the-quadratic-formula&#34;&gt;âœï¸ Step 3: Letâ€™s use the quadratic formula&lt;/h3&gt;
&lt;p&gt;We write this as a quadratic in terms of \(5\):&lt;br&gt;
Let:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;\(a = 1\)&lt;/li&gt;
&lt;li&gt;\(b = -(2x^2 + 1)\)&lt;/li&gt;
&lt;li&gt;\(c = x^4 + x\)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Use the quadratic formula:&lt;/p&gt;
\[
5 = \frac{(2x^2 + 1) \pm \sqrt{(2x^2 + 1)^2 - 4(x^4 + x)}}{2}
\]
&lt;hr&gt;
&lt;h3 id=&#34;-step-4-apply-the-quadratic-formula-and-simplify&#34;&gt;âœï¸ Step 4: Apply the Quadratic Formula and Simplify&lt;/h3&gt;
&lt;p&gt;We are solving:&lt;/p&gt;
\[
5 = \frac{2x^2 + 1 \pm \sqrt{(-2x^2 - 1)^2 - 4(x^4 + x)}}{2}
\]
&lt;p&gt;Now simplify the discriminant:&lt;/p&gt;
\[
= \frac{2x^2 + 1 \pm \sqrt{4x^2 - 4x + 1}}{2}
\]
&lt;p&gt;Factor the square root:&lt;/p&gt;
\[
= \frac{2x^2 + 1 \pm (2x - 1)}{2}
\]
&lt;p&gt;Now evaluate the two cases from here, which can be solve using standard quard formula.&lt;/p&gt;
&lt;h3 id=&#34;-step-5-solve-the-two-quadratic-equations&#34;&gt;âœï¸ Step 5: Solve the two quadratic equations&lt;/h3&gt;
&lt;p&gt;Using the quadratic formula:&lt;/p&gt;
&lt;h4 id=&#34;equation-1&#34;&gt;Equation 1:&lt;/h4&gt;
\[
x^2 + x - 5 = 0 \Rightarrow x = \frac{-1 \pm \sqrt{1^2 + 4 \cdot 5}}{2} = \frac{-1 \pm \sqrt{21}}{2}
\]
&lt;h4 id=&#34;equation-2&#34;&gt;Equation 2:&lt;/h4&gt;
\[
x^2 - x - 4 = 0 \Rightarrow x = \frac{1 \pm \sqrt{1^2 + 4 \cdot 4}}{2} = \frac{1 \pm \sqrt{17}}{2}
\]
&lt;hr&gt;
&lt;h3 id=&#34;-final-answer&#34;&gt;âœ… Final Answer:&lt;/h3&gt;
&lt;p&gt;Check all four roots against the original equation. Only two satisfy it:&lt;/p&gt;
\[
\boxed{\frac{1}{2}(1 - \sqrt{17}) \quad \text{and} \quad \frac{1}{2}(\sqrt{21} - 1)}
\]
</description>
    </item>
    
    <item>
      <title>The Psychology of Money - Distillation, Chapter 13 - 20</title>
      <link>http://localhost:1313/post/2025-03-22-the-psychology-of-money-chapter13-chapter20/</link>
      <pubDate>Sat, 22 Mar 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-03-22-the-psychology-of-money-chapter13-chapter20/</guid>
      <description>&lt;h2 id=&#34;chapter-13-room-for-error---the-most-imporant-part-of-every-plan-is-planning-on-your-plan-not-going-according-to-plan&#34;&gt;Chapter 13 Room For Error - The most imporant part of every plan is planning on your plan not going according to plan.&lt;/h2&gt;
&lt;h2 id=&#34;chapter-14-youll-change---long-term-planning-is-harder-than-it-seems-because-peoples-goals-and-desires-change-over-time&#34;&gt;Chapter 14 You&amp;rsquo;ll Change - Long-term planning is harder than it seems because people&amp;rsquo;s goals and desires change over time.&lt;/h2&gt;
&lt;p&gt;ä½œè€…è¯´ä¸€ä¸ªä»–çš„æœ‹å‹çš„æ•…äº‹æ¥å‘Šè¯‰æˆ‘ä»¬äººçš„ä»·å€¼è§‚å’Œä¸–ç•Œè§‚æ˜¯ä¼šå‘ç”Ÿæ”¹å˜çš„ï¼šä»–çš„æœ‹å‹ä»å°ç›¸å½“åŒ»ç”Ÿï¼Œä½†æ˜¯å½“ä¸ŠåŒ»ç”Ÿä»¥åä»–å‘ç°è‡ªå·±å¾ˆè®¨åŒè¿™ä¸ªèŒä¸šã€‚äººä»¬çš„è´¢åŠ¡è§„åˆ’ä¹Ÿæ˜¯è¿™æ ·ï¼Œè¦é¿å…è¿‡äºæç«¯çš„è´¢åŠ¡è§„åˆ’ï¼Œä¸€å‰‚è¯æ¥å—æˆ‘ä»¬çš„æƒ³æ³•ä¼šæ”¹å˜ã€‚&lt;/p&gt;
&lt;h2 id=&#34;chapter-15-nothings-free---everything-has-a-price-but-not-all-prices-appear-on-labels&#34;&gt;Chapter 15 Nothing&amp;rsquo;s Free - Everything has a price, but not all prices appear on labels.&lt;/h2&gt;
&lt;p&gt;å¾ˆå¤šäººæ„¿æ„ä»˜è½¦é’±ï¼Œæˆ¿å­é’±ï¼Œä½†æ˜¯ä¸æ„¿æ„ä»˜æŠ•èµ„çš„å­¦è´¹ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Œå› ä¸ºæˆ‘ä»¬æ€»è§‰å¾—æŠ•èµ„çš„å¤±è´¥æ˜¯ä¸€ç§æƒ©ç½šçš„ç½šé‡‘ï¼Œäººä¸æ„¿æ„äº¤ç½šé‡‘ï¼Œä½†æ˜¯å…¶å®æŠ•èµ„çš„å¤±è´¥åªæ˜¯ä¸€ç§æ¶ˆè´¹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;chapter-16-you--me---beware-taking-financial-cues-from-people-playing-a-different-game-than-you-are&#34;&gt;Chapter 16 You &amp;amp; Me - Beware taking financial cues from people playing a different game than you are.&lt;/h2&gt;
&lt;p&gt;æœ‰äº›äººåšé•¿çº¿ï¼Œæœ‰äº›äººåšçŸ­çº¿ï¼Œæ²¡å¿…è¦å’Œäººè¿›è¡Œæ¯”è¾ƒã€‚&lt;/p&gt;
&lt;h2 id=&#34;chapter-17-the-seduction-of-pessimism---optimism-sounds-like-a-sales-pitch-pessimism-sounds-like-someone-trying-to-help-you&#34;&gt;Chapter 17 The Seduction of Pessimism - Optimism sounds like a sales pitch. Pessimism sounds like someone trying to help you.&lt;/h2&gt;
&lt;p&gt;äººä»¬æ€»å¯¹ä¸–ç•Œè´Ÿé¢çš„è¨€è®ºæ›´åŠ æ„Ÿåˆ°æœ‰å…±é¸£ã€‚æ¯”å¦‚åœ¨å¤§å®¶éƒ½ç‹‚æ¬¢çš„æ—¶å€™å¦‚æœæœ‰ä¸€ä¸ªäººè¯´ä¸€äº›è´Ÿé¢çš„è¯ï¼Œå¤§ä¼™å„¿ä¼šè§‰å¾—è¿™æ˜¯ä¸€ä¸ªæ™ºè€…ï¼Œä½†æ˜¯å¦‚æœåœ¨å¤§å®¶éƒ½æ‚²è§‚çš„æ—¶å€™æœ‰äººè¯´ç§¯æçš„è¯åè€Œä¼šè¢«è®¤ä¸ºæ˜¯ç²¾ç¥ç—…ã€‚&lt;/p&gt;
&lt;p&gt;å¸‚åœºä¼šè°ƒèŠ‚ï¼Œä¼šæœ‰è´Ÿåé¦ˆï¼Œå’Œäººç”Ÿä¸€æ ·ï¼Œä¸ä¼šå¤ªå¥½ï¼Œä¹Ÿä¸ä¼šå¤ªå·®ã€‚
Progress happens too slowly to notice, but setbacks happen too quickly to ignore.&lt;/p&gt;
&lt;h2 id=&#34;chapter-18-when-youll-believe-anything---appleaing-fictions-and-why-stories-are-more-powerful-than-statistics&#34;&gt;Chapter 18 When You&amp;rsquo;ll believe anything - Appleaing fictions, and why stories are more powerful than statistics.&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬æœ‰çš„æ—¶å€™ä¼šä¸ºè‡ªå·±çš„æƒ³æ³•æ‰¾å€Ÿå£ï¼Œç¼–æ•…äº‹ï¼Œå¹¶ä¸”æˆ‘ä»¬æ€»è®¤ä¸ºä¸–ç•Œæ˜¯èƒ½è¢«è§£é‡Šçš„ï¼Œä½†å…¶å®ä¸æ˜¯è¿™æ ·çš„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;chapter-19-all-together-now---what-weve-learned-about-the-psychology-of-your-own-money&#34;&gt;Chapter 19 All Together Now - What we&amp;rsquo;ve learned about the psychology of your own money.&lt;/h2&gt;
&lt;p&gt;ç»™å‡ºäº†ä¸€å †å»ºè®®ï¼Œå…¶å®æˆ‘è§‰å¾—æœ‰ç‚¹ç©ºæ´+æˆåŠŸå­¦ï¼Œå°±ä¸åˆ—ä¸¾äº†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;chapter-20-confessions---the-psychology-of-my-own-money&#34;&gt;Chapter 20 Confessions - The psychology of my own money.&lt;/h2&gt;
&lt;p&gt;ä½œè€…è®²äº†ä¸€ä¸‹ä»–å’Œä»–çš„è€å©†éƒ½æ˜¯æœ‰ç›¸åŒçš„ä»·å€¼è§‚ï¼Œå¹¶ä¸”ä¸€ç›´æŠŠè‡ªå·±çš„ç‰©æ¬²è¿‡çš„ä¸é‚£ä¹ˆé«˜ã€‚å…¶å®æˆ‘ä¹Ÿå¾ˆå¸Œæœ›è‡ªå·±èƒ½é‡åˆ°ä¸€ä¸ªè¿™æ ·çš„äººã€‚&lt;/p&gt;
&lt;h2 id=&#34;postscript-a-brief-history-of-why-the-us-consumer-thinks-the-way-they-do&#34;&gt;Postscript: A brief history of why the US Consumer thinks the way they do.&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;å¤§æ¦‚å°±æ˜¯äºŒæˆ˜ç»“æŸä¹‹åå¾ˆå¤šäººå›å›½æ²¡æœ‰äº‹æƒ…åšï¼Œæ²¡æœ‰æˆ¿å­ä½ï¼Œ&lt;/li&gt;
&lt;li&gt;æ”¿åºœæŠŠåˆ©ç‡è°ƒæ•´å¾ˆä½&lt;/li&gt;
&lt;li&gt;å¤§å®¶çš„åˆ›æ–°åˆ›é€ äº†è´¢å¯Œ&lt;/li&gt;
&lt;li&gt;è´¢å¯Œè¢«ç›¸å¯¹å¹³å‡çš„åˆ†é…äº†&lt;/li&gt;
&lt;li&gt;å€ºåŠ¡ä¸Šå‡äº†ï¼Œä½†æ˜¯å·¥èµ„ä¹Ÿä¸Šå‡äº†ï¼Œæ‰€ä»¥æ•´ä½“é—®é¢˜ä¸å¤§&lt;/li&gt;
&lt;li&gt;å¤±ä¸šç‡æé«˜ï¼Œè¿›å…¥ç»æµè¡°é€€æœŸ&lt;/li&gt;
&lt;li&gt;ç»æµç»§ç»­ç¹è£äº†ï¼Œä½†æ˜¯è¿™æ¬¡æ”¶å…¥ä¸å†é‚£ä¹ˆå¹³å‡äº†&lt;/li&gt;
&lt;li&gt;äººä»¬çš„ç”Ÿæ´»æ–¹å¼ï¼Œæ¯”è¾ƒå¿ƒç†å‘ç”Ÿäº†æ”¹å˜&lt;/li&gt;
&lt;li&gt;è§„èŒƒè¢«åˆ›ç«‹äº†ä»¥åï¼Œå°±å¾ˆéš¾æ”¹å˜ï¼Œäººä»¬è¿˜æ˜¯è®¤ä¸ºåˆ†é…çš„æ˜¯å¹³å‡çš„ï¼Œæƒ³è¿½æ±‚å’Œåˆ«äººç›¸åŒçš„ç”Ÿæ´»ï¼Œä½†æ˜¯è¿™æ ·å¯¼è‡´äº†å¾ˆå¤šå€Ÿè´·ã€‚&lt;/li&gt;
&lt;li&gt;ä½œè€…æš—ç¤ºå¯èƒ½ä¼šæœ‰æˆ˜äº‰ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªå¾ªç¯ï¼Œä¸çŸ¥é“æ˜¯ä»€ä¹ˆæ„æ€äº†ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;æœ¬ä»¥ä¸ºæ˜¯ä¸€æœ¬ç†è´¢çš„ä¹¦ï¼Œæ²¡æƒ³åˆ°è¯»å®Œå‘ç°æ˜¯ä¸€æœ¬æˆåŠŸå­¦çš„ä¹¦ï¼Œæˆ–è€…æ˜¯ä¸ªäººæå‡çš„ä¹¦ã€‚ä½œè€…è®²äº† 20 ä¸ªç‚¹ï¼Œå¯èƒ½ä¼šå¯¹äººçš„ä»·å€¼è§‚å¡‘é€ æœ‰ä¸€äº›å¸®åŠ©ã€‚æˆ‘è¯»èµ·æ¥æ„Ÿè§‰ä¸å›°éš¾ï¼Œè¯´æ˜è¿™é‡Œé¢å¾ˆå¤šçš„ä»·å€¼è§‚å’Œæˆ‘çš„ä»·å€¼è§‚æ˜¯ä¸€æ ·çš„ï¼Œæœ€å–œæ¬¢çš„ chapter å¯èƒ½æ˜¯ chpater17ï¼Œè®²äº†æ‚²è§‚ä¸»ä¹‰ä¸ºä»€ä¹ˆä¼šç››è¡Œï¼Œåœ¨è¿™ä¸ªå½“ä»Šçš„ç¤¾ä¼šï¼Œè¿™ç‚¹ observation éå¸¸é‡è¦ï¼Œä¼šå¸®åŠ©ä½ å¯¹æŠ—å¾ˆå¤šè´Ÿé¢çš„è¨€è®ºè§‚ç‚¹ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>The Psychology of Money - Distillation, Chapter 1 - 2</title>
      <link>http://localhost:1313/post/2025-03-17-the-psychology-of-money-intro&#43;1&#43;2/</link>
      <pubDate>Mon, 17 Mar 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-03-17-the-psychology-of-money-intro&#43;1&#43;2/</guid>
      <description>&lt;h2 id=&#34;introduction&#34;&gt;Introduction&lt;/h2&gt;
&lt;p&gt;The author lists two examples: Ronald James, a gas station attendant, managed to save up to 8 million by retirement; Richard Fuscone, a harvard-educated Merrill Lynch executive, declared bankrupt during recession. The author ties to prove that finance is a soft science that does not require a lot of intelligence. Rather it requires behaviors.&lt;/p&gt;
&lt;h2 id=&#34;chapter-1-no-ones-crazy&#34;&gt;Chapter 1. No one&amp;rsquo;s crazy&lt;/h2&gt;
&lt;p&gt;The author claims that people with dramatically different experience will make extremely different decisions, but those decisions are all logical to their own minds. To illustrate this point, author lists how stock market price changes differently if you were born in 1950s and 1970s, how inflation rate changes differently if you were born in 1960s and 1990s.&lt;/p&gt;
&lt;p&gt;In addition, the author also points out that how we make decisions about money are relatively new to the world, so it&amp;rsquo;s totally reasonable that there are some decisions that are not the most correct.&lt;/p&gt;
&lt;h2 id=&#34;chapter-2-luckrisk&#34;&gt;Chapter 2. Luck&amp;amp;Risk&lt;/h2&gt;
&lt;p&gt;Nothing is as good or as bad as it seems. The author lists examples where luck plays in a role at Bill Gates since he was very lucky to be 1 of a million students who get access to computers in high school. On the contrary, Gates&amp;rsquo; best friend passed away accidently in a mountain climbing, which is also 1 of 1 million but in a different direction.
In investment, it&amp;rsquo;s hard to separate the luck/risk from the strategy. Therefore, focus less on individual cases but more on broad patterns.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>The Psychology of Money - Distillation, Chapter 3 - 12</title>
      <link>http://localhost:1313/post/2025-03-18-the-psychology-of-money-chapter3-chapter12/</link>
      <pubDate>Mon, 17 Mar 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-03-18-the-psychology-of-money-chapter3-chapter12/</guid>
      <description>&lt;h2 id=&#34;chapter-3-never-enough&#34;&gt;Chapter 3. Never Enough&lt;/h2&gt;
&lt;p&gt;The author listed Rajat gupta and Bernie Madoff who both had enormous amount of money ended fraud because they always wanted to make more money even they had a lot already. &lt;strong&gt;There is no reason to risk what you have and need for what you don&amp;rsquo;t have and don&amp;rsquo;t need.&lt;/strong&gt; The author also listed the following advices:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;The hardes financial skill is getting the goalpost to stop moving.&lt;/li&gt;
&lt;li&gt;Social comparison is the problem here.&lt;/li&gt;
&lt;li&gt;Enough is not too little.&lt;/li&gt;
&lt;li&gt;There are many things never worth risking no matter the potential gain.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;chapter-4-confounding-compounding&#34;&gt;Chapter 4. Confounding Compounding&lt;/h2&gt;
&lt;p&gt;The author used Milankovitch Cycles(a slightly warmer summer cannot melt ice in the winter ended up componudnig to glacier time) to prove that compounding grows faster than you think. In addition, the author also compared James Simons who had 66% return with Warren Buffet with 22% return. The reason why Buffet made more money is not because his strategy outperformed James&amp;rsquo;, but because Buffet invested longer than James did. Therefore, the author wanted to show that good investing is more about you can stick with it.&lt;/p&gt;
&lt;h2 id=&#34;chapter-5-getting-wealthy-vs-staying-wealthy&#34;&gt;Chapter 5. Getting Wealthy vs Staying Wealthy&lt;/h2&gt;
&lt;p&gt;The author showed us Jesse Livermore, who made a ton of money during recession, ended up losing all his money during his larger bets later, to prove his points that survival is extremely important in investing. The author also shoed that a barbelled ppersonality - optimistic about the future but paranoid about whwat will prevent you from getting to the future - is vital.&lt;/p&gt;
&lt;h2 id=&#34;chapter-6-tails-you-win&#34;&gt;Chapter 6. Tails, You Win&lt;/h2&gt;
&lt;p&gt;The author explained that the reason why Heinz Berggruen could possess massive collection of Picassos, Braques, Klees to the German government was because he invested in lots of other artwork, including those become masterpiece later. In addition, Disney got famous because of Snow White and Seven Dwarfs. The author wanted to prove that anything that is huge, profitable, famous, or influential is the result of tail event. Therefore, it&amp;rsquo;s okay to fail as long as you try a huge amount. Realizing the power of tail makes you feel less worried about failures because most of things will fail, but the successful things will give you big returns.&lt;/p&gt;
&lt;h2 id=&#34;chapter-7-freedom---controlling-your-time-is-the-highest-dividend-money-pays&#34;&gt;Chapter 7. Freedom - Controlling your time is the highest dividend money pays.&lt;/h2&gt;
&lt;p&gt;The author depicted freedom as you can do what you want, when you want, with who you want, for as long as you want. Money gives you the power of doing so. The author also showed that in previous generations, working requires specific tools, and it&amp;rsquo;s easy to detach your hand from work just because you get detached from the tool. Nowadays, it&amp;rsquo;s harder because you work with your brain, and it&amp;rsquo;s hard to detach from your brain. Then, it&amp;rsquo;s more cherished that money can give you some freedom.&lt;/p&gt;
&lt;h2 id=&#34;chapter-8-man-in-the-car-paradox---no-one-is-impressed-with-your-possessions-as-much-as-you-are&#34;&gt;Chapter 8. Man in the Car Paradox - No one is impressed with your possessions as much as you are.&lt;/h2&gt;
&lt;p&gt;The author used his own personal anecdote to show that people tend to want wealth to signal to others that they should be liked and admired. But in reality those other people often bypass admiring you, not because they don&amp;rsquo;t think wealth is admirable, but because they use your wealth as a benchmark for their own desire to be liked and admired. If respect and admiration are your goal, be careful how you seek it.&lt;/p&gt;
&lt;h2 id=&#34;chapter-9-wealth-is-what-you-dont-see---spending-money-to-show-people-how-much-money-you-have-is-teh-fastest-way-to-have-less-money&#34;&gt;Chapter 9. Wealth is what you don&amp;rsquo;t see - Spending money to show people how much money you have is teh fastest way to have less money.&lt;/h2&gt;
&lt;p&gt;Wealth is what you don&amp;rsquo;t see.&lt;/p&gt;
&lt;h2 id=&#34;chapter-10-save-money---the-only-factor-you-can-control-generates-one-of-the-only-things-that-matter-how-wonderful&#34;&gt;Chapter 10. Save Money - The only factor you can control generates one of the only things that matter. How wonderful.&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Saving rates is the only thing that you can control.&lt;/li&gt;
&lt;li&gt;The value of wealth is relative to what you need.&lt;/li&gt;
&lt;li&gt;Past a certain level of income, what you need is just what sits below your ego.&lt;/li&gt;
&lt;li&gt;So people&amp;rsquo;s ability to save is more in their control than they think.&lt;/li&gt;
&lt;li&gt;And you don&amp;rsquo;t need a specific reason to save.&lt;/li&gt;
&lt;li&gt;That flexibility and control over your time is an unseen return on wealth.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;chapter-11-reasonable--rational---aiming-to-be-mostly-reasonable-works-better-than-trying-to-be-codly-rational&#34;&gt;Chapter 11. Reasonable &amp;gt; Rational - Aiming to be mostly reasonable works better than trying to be codly rational.&lt;/h2&gt;
&lt;p&gt;The author used fever as an example to illustrate that even though fever is rationally good for your body, but people also take pills right away when they have fever because people feel pain. Here, reasonable is bigger than rational. Also, in investment, there are lots of strategies that are rational but not reasonable for people to implement. Rather, it&amp;rsquo;s more profitable for a person to implement reasonable strategy because in the long run, the market favors long-term strategy and you are more likely to implement a reasonable strategy.&lt;/p&gt;
&lt;h2 id=&#34;chapter-12-surprise---history-is-a-study-of-change-ironically-used-as-a-map-of-the-future&#34;&gt;Chapter 12. Surprise - History is a study of change, ironically used as a map of the future.&lt;/h2&gt;
&lt;p&gt;Things that have never happened before happen all the time. Outlier event move the needle the most. History can be a misleadding guide to the future of the economy and stock market because it doesn&amp;rsquo;t account for structural chagnes that are relevant to today&amp;rsquo;s world.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>éœ€è¦å¤šå°‘é’±æ‰èƒ½é€€ä¼‘ - ä¸­å›½</title>
      <link>http://localhost:1313/post/2025-03-16-%E5%9C%A8%E4%B8%AD%E5%9B%BD%E8%B4%A2%E5%AF%8C%E8%87%AA%E7%94%B1%E7%9A%84%E8%AE%A1%E7%AE%97/</link>
      <pubDate>Sun, 16 Mar 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-03-16-%E5%9C%A8%E4%B8%AD%E5%9B%BD%E8%B4%A2%E5%AF%8C%E8%87%AA%E7%94%B1%E7%9A%84%E8%AE%A1%E7%AE%97/</guid>
      <description>&lt;h2 id=&#34;ä¸€ä¸ªäººæ´»åˆ°è€çš„ç‰ˆæœ¬&#34;&gt;ä¸€ä¸ªäººæ´»åˆ°è€çš„ç‰ˆæœ¬&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;ç±»åˆ«&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æœˆæ”¯å‡ºï¼ˆå…ƒï¼‰&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æœˆæ”¯å‡ºï¼ˆç¾å…ƒï¼‰&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å¹´æ”¯å‡ºï¼ˆå…ƒï¼‰&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;å¹´æ”¯å‡ºï¼ˆç¾å…ƒï¼‰&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ä½æˆ¿&lt;/strong&gt;ï¼ˆä½åœ¨çˆ¶æ¯å®¶ï¼Œæ— éœ€è´¹ç”¨ï¼‰&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;é¥®é£Ÿ&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;2,700&lt;/td&gt;
&lt;td&gt;375&lt;/td&gt;
&lt;td&gt;32,400&lt;/td&gt;
&lt;td&gt;4,500&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;äº¤é€š&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- è½¦é™©&lt;/td&gt;
&lt;td&gt;250&lt;/td&gt;
&lt;td&gt;35&lt;/td&gt;
&lt;td&gt;3,000&lt;/td&gt;
&lt;td&gt;417&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- æ²¹è´¹&lt;/td&gt;
&lt;td&gt;250&lt;/td&gt;
&lt;td&gt;35&lt;/td&gt;
&lt;td&gt;3,000&lt;/td&gt;
&lt;td&gt;417&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- ä¿å…»&lt;/td&gt;
&lt;td&gt;100&lt;/td&gt;
&lt;td&gt;14&lt;/td&gt;
&lt;td&gt;1,200&lt;/td&gt;
&lt;td&gt;167&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;äº¤é€šåˆè®¡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;600&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;83&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;7,200&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;1,000&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŒ»ç–—&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- ä¿é™©&lt;/td&gt;
&lt;td&gt;1,500&lt;/td&gt;
&lt;td&gt;208&lt;/td&gt;
&lt;td&gt;18,000&lt;/td&gt;
&lt;td&gt;2,500&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åŒ»ç–—åˆè®¡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;1,500&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;208&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;18,000&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;2,500&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¨±ä¹&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;500&lt;/td&gt;
&lt;td&gt;69&lt;/td&gt;
&lt;td&gt;6,000&lt;/td&gt;
&lt;td&gt;833&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è´¦å•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- è¯è´¹&lt;/td&gt;
&lt;td&gt;50&lt;/td&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;td&gt;600&lt;/td&gt;
&lt;td&gt;83&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- ç½‘è´¹&lt;/td&gt;
&lt;td&gt;50&lt;/td&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;td&gt;600&lt;/td&gt;
&lt;td&gt;83&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- è¡£æœ&lt;/td&gt;
&lt;td&gt;300&lt;/td&gt;
&lt;td&gt;42&lt;/td&gt;
&lt;td&gt;3,600&lt;/td&gt;
&lt;td&gt;500&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;è´¦å•åˆè®¡&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;400&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;56&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;4,800&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;667&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ€»æ”¯å‡º&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;5,700&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;792&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;68,400&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;9,500&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;FIRE ç›®æ ‡ï¼ˆ4%æå–ç‡ï¼Œ25 å€å¹´æ”¯å‡ºï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;1,710,000&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;237,500&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;FIRE ç›®æ ‡ï¼ˆ3%æå–ç‡ï¼Œ33 å€å¹´æ”¯å‡ºï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;2,257,200&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;313,500&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;FIRE ç›®æ ‡ï¼ˆ2%æå–ç‡ï¼Œ50 å€å¹´æ”¯å‡ºï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;3,420,000&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;475,000&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;ä¸¤ä¸ªäººç»“å©šç‰ˆæœ¬&#34;&gt;ä¸¤ä¸ªäººç»“å©šç‰ˆæœ¬&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;Category&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Cost Estimate (RMB)&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Cost Estimate (USD)&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Marriage Costs&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;200,000&lt;/td&gt;
&lt;td&gt;27,778&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Venue &amp;amp; Catering&lt;/td&gt;
&lt;td&gt;80,000 - 120,000&lt;/td&gt;
&lt;td&gt;11,111 - 16,667&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Wedding Dress &amp;amp; Suit&lt;/td&gt;
&lt;td&gt;10,000 - 30,000&lt;/td&gt;
&lt;td&gt;1,389 - 4,167&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Photography &amp;amp; Videography&lt;/td&gt;
&lt;td&gt;5,000 - 20,000&lt;/td&gt;
&lt;td&gt;694 - 2,778&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Wedding Rings &amp;amp; Jewelry&lt;/td&gt;
&lt;td&gt;20,000 - 50,000&lt;/td&gt;
&lt;td&gt;2,778 - 6,944&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Decorations &amp;amp; Planning&lt;/td&gt;
&lt;td&gt;10,000 - 30,000&lt;/td&gt;
&lt;td&gt;1,389 - 4,167&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Honeymoon&lt;/td&gt;
&lt;td&gt;30,000 - 50,000&lt;/td&gt;
&lt;td&gt;4,167 - 6,944&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Raising a Child (0-22 years)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;1,700,000&lt;/td&gt;
&lt;td&gt;236,111&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Birth &amp;amp; Medical Costs (with insurance)&lt;/td&gt;
&lt;td&gt;10,000 - 30,000&lt;/td&gt;
&lt;td&gt;1,389 - 4,167&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Infant &amp;amp; Toddler (0-3 years)&lt;/td&gt;
&lt;td&gt;90,000&lt;/td&gt;
&lt;td&gt;12,500&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Preschool (3-6 years)&lt;/td&gt;
&lt;td&gt;108,000&lt;/td&gt;
&lt;td&gt;15,000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- School Age (6-12 years)&lt;/td&gt;
&lt;td&gt;172,800&lt;/td&gt;
&lt;td&gt;24,000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Teenage Years (12-18 years)&lt;/td&gt;
&lt;td&gt;226,800&lt;/td&gt;
&lt;td&gt;31,500&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- University (18-22 years)&lt;/td&gt;
&lt;td&gt;105,600&lt;/td&gt;
&lt;td&gt;14,667&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Annual Additional Cost for Child&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;77,273&lt;/td&gt;
&lt;td&gt;10,729&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Extra FIRE Funds for Raising a Child (50x Annual Cost)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;3,864,000&lt;/td&gt;
&lt;td&gt;536,667&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Base FIRE Target (2% Rule - 50x Annual Expenses)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;3,420,000&lt;/td&gt;
&lt;td&gt;475,000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Marriage + Raising a Child Total Cost&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;4,064,000&lt;/td&gt;
&lt;td&gt;564,444&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Final FIRE Target (Including Marriage &amp;amp; Child, 2% Rule)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;7,484,000&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;1,039,444&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;Category&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Cost Estimate (RMB)&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Cost Estimate (USD)&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Marriage Costs&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;200,000&lt;/td&gt;
&lt;td&gt;27,778&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Raising a Child (0-22 years)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;1,700,000&lt;/td&gt;
&lt;td&gt;236,111&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Extra FIRE Funds for Raising a Child (50x Annual Cost)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;3,420,000&lt;/td&gt;
&lt;td&gt;475,000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Base FIRE Target (2% Rule - 50x Annual Expenses, Doubled for Two People)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;6,840,000&lt;/td&gt;
&lt;td&gt;950,000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Marriage + Raising a Child Total Cost&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;1,900,000&lt;/td&gt;
&lt;td&gt;263,889&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Final FIRE Target (Including Marriage &amp;amp; Child, 2% Rule, Doubled Base)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;8,740,000&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;1,213,889&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
</description>
    </item>
    
    <item>
      <title>éœ€è¦å¤šå°‘é’±æ‰èƒ½é€€ä¼‘ - ç¾å›½</title>
      <link>http://localhost:1313/post/2025-03-16-%E5%9C%A8%E7%BE%8E%E5%9B%BD%E8%B4%A2%E5%AF%8C%E8%87%AA%E7%94%B1%E7%9A%84%E8%AE%A1%E7%AE%97/</link>
      <pubDate>Sun, 16 Mar 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-03-16-%E5%9C%A8%E7%BE%8E%E5%9B%BD%E8%B4%A2%E5%AF%8C%E8%87%AA%E7%94%B1%E7%9A%84%E8%AE%A1%E7%AE%97/</guid>
      <description>&lt;p&gt;ä¹¦æ¥å‰æ–‡ï¼Œä¸Šæ¬¡è°ˆåˆ°è¦è®¡ç®—å¤šå°‘é’±èƒ½é€€ä¼‘ï¼Œç°åœ¨é€šè¿‡å’Œ chatgpt ä»¥åŠç½‘ç»œæœç´¢çš„æ±‡æ€»ä»¥åï¼Œæˆ‘å¾—åˆ°ä»¥ä¸‹ä¸€äº›æ€è€ƒã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸€ä¸ªäººæ´»åˆ°è€çš„ç‰ˆæœ¬-æ¯å¹´è¦èŠ±å¤šå°‘é’±çš„è®¡ç®—æŒ‰ç¾é‡‘è®¡ç®—&#34;&gt;ä¸€ä¸ªäººæ´»åˆ°è€çš„ç‰ˆæœ¬: æ¯å¹´è¦èŠ±å¤šå°‘é’±çš„è®¡ç®—ï¼ŒæŒ‰ç¾é‡‘è®¡ç®—&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Category&lt;/th&gt;
&lt;th&gt;Monthly Cost ($)&lt;/th&gt;
&lt;th&gt;Annual Cost ($)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Housing&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;2,000&lt;/td&gt;
&lt;td&gt;24,000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Food&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;2,000&lt;/td&gt;
&lt;td&gt;24,000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Transportation&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Car Insurance&lt;/td&gt;
&lt;td&gt;150&lt;/td&gt;
&lt;td&gt;1,800&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Gas&lt;/td&gt;
&lt;td&gt;150&lt;/td&gt;
&lt;td&gt;1,800&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Maintenance&lt;/td&gt;
&lt;td&gt;30&lt;/td&gt;
&lt;td&gt;360&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Total Transport&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;330&lt;/td&gt;
&lt;td&gt;3,960&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Healthcare&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Insurance&lt;/td&gt;
&lt;td&gt;468&lt;/td&gt;
&lt;td&gt;5,616&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Out-of-Pocket&lt;/td&gt;
&lt;td&gt;250&lt;/td&gt;
&lt;td&gt;3,000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Total Healthcare&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;718&lt;/td&gt;
&lt;td&gt;8,616&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Entertainment &amp;amp; Leisure&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;150&lt;/td&gt;
&lt;td&gt;1,800&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Other Bills&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Phone&lt;/td&gt;
&lt;td&gt;25&lt;/td&gt;
&lt;td&gt;300&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Internet&lt;/td&gt;
&lt;td&gt;100&lt;/td&gt;
&lt;td&gt;1,200&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Clothing&lt;/td&gt;
&lt;td&gt;100&lt;/td&gt;
&lt;td&gt;1,200&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Total Other Bills&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;225&lt;/td&gt;
&lt;td&gt;2,700&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;TOTAL EXPENSES&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;5,423&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;65,076&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;FIRE Number (3% Rule - 33.3x Annual Expenses)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;$2,167,030&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;ä¸¤ä¸ªäººç»“å©šç”Ÿå­©å­çš„ç‰ˆæœ¬&#34;&gt;ä¸¤ä¸ªäººç»“å©šç”Ÿå­©å­çš„ç‰ˆæœ¬&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;Category&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Cost Estimate (USD)&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Marriage&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;$25,000 - $100,000+&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Venue &amp;amp; Catering&lt;/td&gt;
&lt;td&gt;$10,000 - $30,000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Wedding Dress &amp;amp; Suit&lt;/td&gt;
&lt;td&gt;$1,500 - $5,000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Photography &amp;amp; Videography&lt;/td&gt;
&lt;td&gt;$2,000 - $7,000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Wedding Rings &amp;amp; Jewelry&lt;/td&gt;
&lt;td&gt;$5,000 - $20,000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Decorations &amp;amp; Planning&lt;/td&gt;
&lt;td&gt;$3,000 - $10,000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Honeymoon&lt;/td&gt;
&lt;td&gt;$5,000 - $15,000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Buying a House&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;$200,000 - $1,200,000+&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Down Payment (20%)&lt;/td&gt;
&lt;td&gt;$60,000 - $200,000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Mortgage (30-year)&lt;/td&gt;
&lt;td&gt;Interest Rate: 6%-8%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Property Tax &amp;amp; Insurance&lt;/td&gt;
&lt;td&gt;$3,000 - $10,000/year&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Maintenance &amp;amp; Renovation&lt;/td&gt;
&lt;td&gt;$10,000 - $50,000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Raising a Child&lt;/strong&gt; (0-18 years)&lt;/td&gt;
&lt;td&gt;$250,000 - $400,000+&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Birth &amp;amp; Hospital Costs (with insurance)&lt;/td&gt;
&lt;td&gt;$2,000 - $5,000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Birth &amp;amp; Hospital Costs (without insurance)&lt;/td&gt;
&lt;td&gt;$10,000 - $30,000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Infant &amp;amp; Toddler (0-3 years)&lt;/td&gt;
&lt;td&gt;$12,000 - $20,000/year&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- School Age (4-12 years)&lt;/td&gt;
&lt;td&gt;$10,000 - $15,000/year&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Teenager (13-18 years)&lt;/td&gt;
&lt;td&gt;$12,000 - $20,000/year&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- College (Public)&lt;/td&gt;
&lt;td&gt;$25,000 - $40,000/year&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- College (Private)&lt;/td&gt;
&lt;td&gt;$50,000 - $80,000/year&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;FIRE Retirement&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;$1,200,000 - $3,000,000+&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Monthly Living Costs&lt;/td&gt;
&lt;td&gt;$3,000 - $6,000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Healthcare &amp;amp; Insurance&lt;/td&gt;
&lt;td&gt;$500 - $2,000/month&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;- Travel &amp;amp; Leisure&lt;/td&gt;
&lt;td&gt;$500 - $3,000/month&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;FIRE Target (4% Rule)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;$1.2M - $3M+&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;FIRE Target (3% Rule - More Conservative)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;$2.2M - $3.5M+&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ç»“å©šç‰ˆæœ¬éœ€è¦å¤šèŠ±çš„é’±ï¼šç»“å©šå¤§æ¦‚èŠ± 10 ä¸‡ç¾é‡‘ï¼Œä¹°æˆ¿å­å°±ç®— 100 ä¸‡ç¾é‡‘ï¼Œå…»å­©å­éœ€è¦ 40 ä¸‡ç¾é‡‘ï¼Œä¸€å…±éœ€è¦ 150 ä¸‡ç¾é‡‘ã€‚&lt;/li&gt;
&lt;li&gt;ä¸€ä¸ªäººå•èº«ç§Ÿæˆ¿ç‰ˆæœ¬ï¼Œå¤§æ¦‚éœ€è¦ 200 ä¸‡ç¾é‡‘å·¦å³èƒ½åœ¨ç¾å›½ fireã€‚&lt;/li&gt;
&lt;li&gt;ç®—å®Œæ„Ÿè§‰è¿˜æ˜¯æ…Œã€‚&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>éœ€è¦å¤šå°‘é’±æ‰èƒ½é€€ä¼‘ - ç¾å›½/ä¸­å›½ï¼Œæ€»ç»“</title>
      <link>http://localhost:1313/post/2025-03-16-%E8%B4%A2%E5%AF%8C%E8%87%AA%E7%94%B1%E6%80%BB%E7%BB%93/</link>
      <pubDate>Sun, 16 Mar 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-03-16-%E8%B4%A2%E5%AF%8C%E8%87%AA%E7%94%B1%E6%80%BB%E7%BB%93/</guid>
      <description>&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;åœ°åŒº&lt;/th&gt;
&lt;th&gt;ä¸ç”Ÿå­©å­ï¼ˆé åˆ©æ¯ç”Ÿæ´»ï¼‰&lt;/th&gt;
&lt;th&gt;ç»“å©šç”Ÿå­©å­ï¼ˆé åˆ©æ¯ç”Ÿæ´»ï¼‰&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;ç¾å›½&lt;/td&gt;
&lt;td&gt;200 ä¸‡ç¾é‡‘&lt;/td&gt;
&lt;td&gt;400 ä¸‡ç¾é‡‘&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ä¸­å›½&lt;/td&gt;
&lt;td&gt;50 ä¸‡ç¾é‡‘&lt;/td&gt;
&lt;td&gt;120 ä¸‡ç¾é‡‘&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
</description>
    </item>
    
    <item>
      <title>ä»·å€¼è§‚</title>
      <link>http://localhost:1313/post/2025-03-15-%E4%BB%B7%E5%80%BC%E8%A7%82/</link>
      <pubDate>Sat, 15 Mar 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-03-15-%E4%BB%B7%E5%80%BC%E8%A7%82/</guid>
      <description>&lt;p&gt;è™½ç„¶æˆ‘å®¶åº­éå¸¸å¥½ï¼Œéå¸¸å¥½å®¶åº­ï¼Œä½†æˆ‘æ˜¯è¢«â€œç©·â€å¤§çš„ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘å› ä¸ºçœé’±åƒè¿‡å¾ˆå¤šè‹¦ï¼Œæœ‰ä¸€ä¸ªéå¸¸å¤§çš„è‹¦ï¼Œæˆ‘ç°åœ¨è¿˜åœ¨åƒï¼Œè€Œä¸”ä¸çŸ¥é“è¿™ä¸ªè‹¦ä»€ä¹ˆæ—¶å€™èƒ½åƒå®Œã€‚ä¸æƒ³è°ˆå¤ªå¤šè¿™ä¸ªï¼Œä»¥åæœ‰æœºä¼šè°ˆï¼Œè¿™ç¯‡å°±æƒ³è°ˆè°ˆæˆ‘æ€ä¹ˆæ ·æ‰èƒ½æœ‰ä¸€ä¸ªæ›´å¹³è¡¡çš„ä»·å€¼è§‚ï¼Œå¦‚ä½•æ›´å¥½çš„ç®¡ç†å¥½è‡ªå·±é’±ï¼Œè®©è‡ªå·±è¿‡ä¸Šèˆ’é€‚çš„æ—¥å­çš„åŒæ—¶å®Œæˆè‡ªå·±è´¢åŠ¡ä¸Šçš„ç›®æ ‡ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘è®¤ä¸ºæ”¹å˜ç°æœ‰ä¹ æƒ¯çš„å¼€å§‹ä¸€æ­¥æ˜¯å…ˆç†è§£ç°æœ‰çš„ä¹ æƒ¯å½¢æˆçš„åŸå› ï¼Œè°ˆåˆ°æˆ‘èŠ‚çœä»·å€¼è§‚çš„åŸå› ï¼Œæˆ‘æƒ³å¤§æ¦‚æœ‰è‡ªå·±è¢«ä¼ ç»Ÿè§‚å¿µå½±å“ï¼Œè‡ªå·±é¢å¯¹ç°ä»£å®£ä¼ ååº”çŸ«æ‰è¿‡æ­£ï¼Œä»¥åŠè‡ªå·±å¯¹é‡‘èä½“ç³»çš„ä¸ç†è§£ã€‚&lt;/p&gt;
&lt;p&gt;ä¼ ç»Ÿè§‚å¿µæ·±å…¥äººå¿ƒï¼šåˆä¸­å°±å­¦ã€Šç”Ÿäºå¿§æ‚£ æ­»äºå®‰ä¹ã€‹ï¼Œå¤§æ¦‚å°±å‘Šè¯‰å°å­©å­è¯´äººä¸èƒ½è¿‡çš„å¤ªå®‰ä¹ï¼Œè¦æ‡‚å¾—åƒè‹¦ï¼Œæ‡‚å¾—ç»™è‡ªå·±åˆ¶é€ ä¸€äº›ç—›è‹¦ï¼Œåƒçš„åƒé‡Œè‹¦ï¼Œäº«å¾—ä¸‡é‡Œç¦ã€‚è¿™äº›åœ¨ç°ä»£çš„ç¤¾ä¼šè§‚å¿µä¸­éšç€ç»æµçš„å‘å±•ï¼Œæˆ‘åªèƒ½è¯´å¯¹è¿™ç§æƒ³æ³•è¦å–å…¶ç²¾åï¼Œå»å…¶ç³Ÿç²•ï¼Œæ›´è¿›ä¸€æ­¥ï¼šè¿™å¥è¯æ˜¯è½¦è½±è¾˜è¯ï¼Œè¯´æ˜ç™½ç‚¹å°±æ˜¯è¿™å°±æ˜¯ç³Ÿç²•ã€‚&lt;/p&gt;
&lt;p&gt;ç°ä»£å®£ä¼ çš„çŸ«æ‰è¿‡æ­£ï¼šè¯¾æœ¬åªå­¦äº†é™·å…¥æ¶ˆè´¹ä¸»ä¹‰çš„äººç»“å±€éƒ½å¾ˆæƒ¨ï¼Œæ¯”å¦‚è´·æ¬¾ä¹°åŒ…çš„å°è‰åœ¨æ¯•ä¸šä»¥åæ¬ ä¸‹å·¨é¢è´·æ¬¾ï¼Œè´·æ¬¾ä¹°è½¦çš„å°ç‹å·¥ä½œåå¹´æ²¡å­˜ä¸‹é’±ã€‚ä½†æ˜¯æ²¡äººæ•™ä¸€ç›´çœé’±çš„äººç»“å±€ä¹Ÿä¸ä¼šå¥½å•Šï¼åªä¼šèŠ‚çœçš„äººè‡ªå·±æ´»çš„ä¸èˆ’æœï¼Œé”™å¤±äº†ç¤¾äº¤æœºä¼šï¼Œä¹Ÿæ— æ³•æ„Ÿåˆ°ç”Ÿæ´»çš„å¿«ä¹ï¼Œç”šè‡³ä¼šäº§ç”Ÿå¥åº·é—®é¢˜ã€‚ä½†ç°ä»£æ•™è‚²åªè°ˆäº†ä¸€æ–¹é¢ï¼Œè¿˜æŠŠèŠ±é’±æ¶ˆè´¹å’Œå¸æ¯’è¿åœ¨ä¸€ç« èŠ‚ï¼Œä»¤äººéš¾å…çŸ«æ‰è¿‡æ­£ã€‚è¿™é‡Œå…¶å®æˆ‘å¾ˆå¯¹ä¸èµ·æˆ‘ä¹‹å‰çš„å‰å¥³å‹ï¼Œè‡ªå·±å¤ªæŠ äº†ï¼Œæ²¡åœ¨å¥¹èº«ä¸ŠèŠ±å¤Ÿé’±ï¼Œæˆ‘æ„Ÿåˆ°å¥¹å¯¹æˆ‘å¾ˆå¥½ï¼Œä½†æˆ‘å¯¹å¥¹çš„æ–¹å¼å´å¾ˆæœ‰å¾…æé«˜ï¼Œä¹Ÿä¸çŸ¥é“åé¢è¿˜æœ‰æ²¡æœ‰æœºä¼šäº†ã€‚&lt;/p&gt;
&lt;p&gt;è‡ªå·±å¯¹é‡‘èä½“ç³»çš„ä¸ç†è§£ï¼šä¸ºä»€ä¹ˆä¸æ•¢èŠ±é’±ï¼Œå› ä¸ºå¾ˆå¤šäººçŸ¥é“å°†æ¥ä¹°æˆ¿ç»“å©šå¾—èŠ±é’±ï¼Œå­å¥³è¦èŠ±å¾ˆå¤šé’±ï¼Œå…»è€å¾—éœ€è¦é’±ï¼ŒåŒ»ä¿éœ€è¦é’±ã€‚äººä»¬å¯¹äºèŠ±é’±çš„åœ°æ–¹éå¸¸æ¸…æ¥šï¼Œä½†æ˜¯å¯¹èµšé’±çš„åœ°æ–¹ä¸æ¸…æ¥šï¼é‡‘èä½“ç³»ä¸æ˜æœ—ï¼ŒæŠ•èµ„æ¸ é“æœ‰é™ï¼Œè¿™å°±å¯¼è‡´ä¸çŸ¥é“é’±ä»å“ªé‡Œæ¥ï¼Œä½†æ˜¯å´æ˜ç™½é’±è¦å»å“ªé‡Œï¼Œè¿™ç§æ„Ÿè§‰è‚¯å®šéš¾å—ï¼Œå°±å¥½åƒä½ çŸ¥é“è¿™ä¸ªæ°´æ± åœ¨æœªæ¥çš„æŸä¸€å¤©è¦è¢«æŠ½å¾ˆå¤šæ°´ï¼Œå¦‚æœæŠ½æ°´æŠ½ç©ºäº†è¿˜è¦ï¼Œå°±å¾—æŠ½ä½ çš„è¡€ï¼Œä½†ä½ ä¸çŸ¥é“å“ªé‡Œèƒ½ææ¥æ°´ï¼Œæ‰€ä»¥æ¯å½“æœ‰ä¸€æ»´æ°´ä½ éƒ½æƒ³å­˜ä¸‹æ¥ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸‰ç‚¹å¤§æ¦‚æ˜¯æˆ‘ä¸ºä»€ä¹ˆæœ‰è¿™æ ·ä»·å€¼è§‚çš„åŸå› ï¼Œç°åœ¨è°ˆè°ˆå…·ä½“å¯¹ç­–ï¼Œå¦‚ä½•è®©è‡ªå·±åŸ¹å…»æˆ–è€…æœç€ä¸€ä¸ªå¹³è¡¡çš„ä»·å€¼è§‚æ–¹é¢è¿›æ­¥ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€äºŒç‚¹å¾ˆéš¾æ”¹å˜äº†ï¼Œè§‚å¿µå·²ç»æ·±å…¥äººå¿ƒäº†ï¼Œèƒ½åšçš„åº”è¯¥å°±æ˜¯å­¦ä¹ æ›´å…ˆè¿›çš„æ€ç»´æ¨¡å¼ï¼Œæé«˜è®¤çŸ¥å±‚çº§ï¼Œå°½é‡å¤šèŠ±ç‚¹é’±ï¼Œæ…¢æ…¢å­¦ç€æ¶ˆè´¹ä¹Ÿæ˜¯ä¸€ç§åŸ¹å…»èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸‰ç‚¹æˆ‘æƒ³ç€é‡è°ˆè°ˆï¼šç ”ç©¶é—®é¢˜è¦å…·ä½“ï¼Œä¸€å…·ä½“å°±æ·±åˆ»ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“ä½“ç°åœ¨è¦å¯¹ä»ŠåèŠ±çš„é’±ï¼Œå’Œä»Šåèµšçš„é’±éƒ½è¦æœ‰ä¸ªå¤§æ¦‚çš„ä¼°ç®—ã€‚æ¯”å¦‚ä¹°æˆ¿å…·ä½“è¦å¤šå°‘é’±ï¼Œç»“å©šå…·ä½“è¦å¤šå°‘é’±ï¼Œå…»è€å…·ä½“å¤šå°‘é’±ï¼Œæœ‰äº†è¿™äº›å…·ä½“çš„è®¡ç®—é‚£ä¹ˆåšå†³ç­–å°±æœ‰ç›®æ ‡æœ‰å‚è€ƒã€‚ï¼›å¦ä¸€ä¸ªå…·ä½“å°±æ˜¯ä½“ç°åœ¨è¦è®¤çœŸå­¦ä¹ ç†è´¢çš„å·¥å…·ï¼Œäº†è§£é‡‘èä½“ç³»ï¼Œæœ‰äº†äº†è§£æ‰èƒ½æœ‰ä¿¡å¿ƒï¼Œåšä¸€ä¸ªæœ‰å‡†å¤‡çš„æ¶ˆè´¹è€…ï¼ŒçŸ¥é“é’±ä¼šå»å“ªé‡Œè¿˜ä¸å¤Ÿï¼Œè¦çŸ¥é“å¤šå°‘é’±ä¼šå»å“ªé‡Œï¼Œå¤šå°‘é’±ä»€ä¹ˆæ—¶å€™ä¼šå»å“ªé‡Œã€‚è¿˜è¦çŸ¥é“é’±ä¼šä»å“ªé‡Œæ¥ï¼Œå¤šå°‘é’±ä¼šä»å“ªé‡Œæ¥ï¼Œå¤šå°‘é’±ä¼šä»å“ªé‡Œä»€ä¹ˆæ—¶å€™æ¥ã€‚å½“ç„¶è¿™äº›éƒ½æ˜¯ä¼°ç®—ï¼Œä¹Ÿæ²¡å¿…è¦å’Œè½¨é“ä¸€æ ·ä¸‡æ— ä¸€å¤±ï¼Œä½†æ˜¯è‡³å°‘åšäº†è®¡ç®—ä»¥åæœ‰ä¸ªå¤§æ¦‚çš„æ¦‚å¿µã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¦ç”¨è‡ªç„¶è¯­è¨€å»æ¨¡ç³Šè‡ªå·±ï¼Œè¦ç”¨æ•°å­—ï¼Œç”¨é€»è¾‘åˆ†ææ¶ˆé™¤è‡ªå·±è„‘æµ·é‡Œçš„æ¨¡ç³Šï¼Œæœ€åæ‰èƒ½è¾¾åˆ°èŠ±é’±èµšé’±éƒ½æ˜¯çŸ¥å·±çŸ¥å½¼ï¼Œç™¾æˆ˜ä¸æ®†ã€‚è¯´åˆ°åšåˆ°ï¼Œæ‰§è¡ŒåŠ›ï¼Œå‘¨æœ«å°±ç®—ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>æŠ¥ç¨-W2</title>
      <link>http://localhost:1313/post/2025-03-14-%E6%8A%A5%E7%A8%8E-w2/</link>
      <pubDate>Fri, 14 Mar 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-03-14-%E6%8A%A5%E7%A8%8E-w2/</guid>
      <description>&lt;h2 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h2&gt;
&lt;p&gt;ä»Šå¤©æ˜¯ PI èŠ‚æ—¥ï¼Œæ¯æ¬¡ PI èŠ‚éƒ½æ˜¯ 3 æœˆ 14 å·ï¼Œä¹Ÿæ˜¯å¦‚ç«å¦‚è¼çš„æŠ¥ç¨å­£èŠ‚ã€‚ä»Šå¹´è¿™æ˜¯æˆ‘å·¥ä½œç¬¬ä¸‰å¹´ï¼Œç¾å›½æŠ¥ç¨ä¹Ÿæœ‰å‡ æ¬¡äº†ï¼Œä½†æˆ‘éå¸¸è®¨åŒæŠ¥ç¨ï¼Œå¡«è¡¨æ ¼ã€‚è®¨åŒçš„åŸå› æœ‰ä¸¤ç‚¹ï¼Œä¸€ä¸ªæ˜¯å¡«è¡¨æ ¼çš„è¿‡ç¨‹éå¸¸ç¹çï¼Œå¦ä¸€ä¸ªæ˜¯å¡«è¡¨æ ¼ç»“æœçš„æ­£ç¡®å¯¹äºä¸€ä¸ªå®Œç¾ä¸»ä¹‰è€…æ¥è¯´ä¼šä»¤äººååˆ†ä»¤äººç„¦è™‘ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆè¯´è¯´è¿™ä¸ªå¡«è¡¨æ ¼çš„è¿‡ç¨‹ï¼šæ¯æ¬¡å¡«è¡¨æ ¼éƒ½æ˜¯ä¿¡æ¯æ£€ç´¢çš„è¿‡ç¨‹ï¼Œé¦–å…ˆè¦ç†è§£é—®é¢˜é—®çš„æ˜¯ä»€ä¹ˆï¼Œç„¶ååœ¨è„‘å­é‡Œæ€è€ƒé—®é¢˜çš„ç­”æ¡ˆæ˜¯ä»€ä¹ˆï¼Œå¾ˆå¤šæ—¶å€™ç›¸åŒçš„ä¿¡æ¯å¹¶ä¸ä¼šæœ‰æ”¹å˜ï¼Œä½†æ˜¯åå¤åœ¨ä¸åŒçš„åœ°æ–¹å¡«å†™ï¼Œå®åœ¨æ˜¯æµªè´¹æ—¶é—´ï¼&lt;/p&gt;
&lt;p&gt;å†è¯´è¯´å¯¹å¡«è¡¨æ ¼çš„ç»“æœçš„ç„¦è™‘ï¼šé‡è¦çš„è¡¨æ ¼å¡«å®Œäº†ä»¥åè¿˜è¦æ£€æŸ¥ï¼Œå°¤å…¶æ˜¯å¯¹æˆ‘è¿™æ ·ç•¥å¾®å¸¦æœ‰å®Œç¾ä¸»ä¹‰å€¾å‘çš„äººæ¥è¯´å¡«è¡¨æ ¼ä¸èƒ½å‡ºåŠç‚¹å·®é”™ï¼Œå¦‚æœæœ‰ç‚¹å¯¹ä¸ä¸Šå°±æƒ³ç ”ç©¶æ˜ç™½æ˜¯ä¸ºä»€ä¹ˆåŸå› ï¼Œä¸€ç ”ç©¶å°±è¿›å…¥äº†å…”å­æ´ï¼Œç ”ç©¶å‡ºæ¥è¿˜å¥½ï¼Œç ”ç©¶ä¸æ˜ç™½åˆ™éå’Œè‡ªå·±è¾ƒåŠ²ï¼Œéå¾—ç ”ç©¶æ˜ç™½æ‰ç®—å®Œï¼Œæœ‰æ—¶å€™ä¼šæ‰“æ‰°ä¸€æ™šä¸Šçš„è®¡åˆ’å’Œå¿ƒæƒ…ã€‚&lt;/p&gt;
&lt;p&gt;çœŸå¸Œæœ›ä»¥åå¤§è„‘ä»‹å…¥èŠ¯ç‰‡çš„è¯ç›´æ¥é€šè¿‡ protocol è¿›è¡Œäº¤æµï¼Œä¸éœ€è¦è¿›è¡Œæ— æ„ä¹‰çš„é‡å¤ä¿¡æ¯æ£€ç´¢ï¼Œä¹Ÿä¸ç”¨ç„¦è™‘ç»“æœçš„å·®é”™ã€‚&lt;/p&gt;
&lt;p&gt;ä»”ç»†åˆ†æä¸ºä»€ä¹ˆæˆ‘ä¼šåæ„Ÿç”šè‡³æ‹–å»¶æŠ¥ç¨ï¼Œæœ‰ä¸€ä¸ªåŸå› å°±åœ¨äºè‡ªå·±å…¶å®å¯¹æŠ¥ç¨è¡¨æ ¼çš„ç†è§£ä¸è¶³ï¼Œå¦‚æœä¸€ä¸ªé—®é¢˜æ˜¯ä½ æ˜¯æ˜ç™½æ¸…æ™°é€»è¾‘çš„ï¼Œé‚£ä¹ˆé‡åˆ°è¿™æ ·çš„é—®é¢˜è‡ªç„¶å¤§è„‘å°±è§‰å¾—å¾ˆèˆ’é€‚ã€‚ä½†å¦‚æœä¸€ä¸ªé—®é¢˜ä½ ä¸æ˜ç™½é€»è¾‘ï¼Œæä¸æ¸…é‡Œé¢çš„æ¦‚å¿µï¼Œé‚£æ¯æ¬¡é‡åˆ°è¿™æ ·çš„é—®é¢˜å°±ä¸æƒ³ä½œç­”ï¼Œå°±æ‹–å»¶ã€‚&lt;/p&gt;
&lt;p&gt;æ¯•ç«Ÿè¿™ä¹Ÿä¸æ˜¯æ•…æ„è®©ä½ å¡«é”™çš„è¡¨æ ¼ï¼Œè®¾è®¡åº”è¯¥æ˜¯ç¬¦åˆç›´è§‚é€»è¾‘çš„ã€‚ä½†ä¸€æ–¹é¢æ˜¯è¿™æ ·æ€è€ƒï¼Œå¦ä¸€æ–¹é¢ä¹Ÿæ‰¿è®¤è¿™ä¸ªè¡¨æ ¼çš„å¤æ‚æ€§ï¼Œæˆ‘çŒœæµ‹è¿™ä¸ªè¡¨æ ¼å°±åƒä¸€ä¸ªä»£ç åº“ï¼Œåˆšå¼€å§‹é€»è¾‘æ¸…æ™°ç®€å•ï¼Œä½†æ˜¯éšç€æ—¶é—´çš„å˜åŒ–ï¼Œæ¯ä¸€å±Šæ€»ç»Ÿï¼Œæ¯ä¸€ä¸ªæ³•å®˜éƒ½æœ‰è‡ªå·±çš„æƒ³æ³•ï¼Œé¢å¸ƒä¸åŒçš„æ³•æ¡ˆï¼Œé€‚åº”å½“æ—¶çš„ç¤¾ä¼šçŠ¶å†µã€‚éšç€è¿™äº›è¿­ä»£ï¼Œè¿™ç§è¡¨æ ¼å¿…ç„¶å°±æœ‰äº†æ›´å¤æ‚çš„å½¢å¼ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªæ¯”è¾ƒå¥½çš„ growth mindset å°±æ˜¯ä¸ä¼šå°±å­¦ï¼Œå­¦ä¸æ‡‚ç»§ç»­æ€è€ƒï¼Œæ€»ç›¸ä¿¡è‡ªå·±èƒ½å­¦æ‡‚ã€‚æ‰€ä»¥ä»Šå¤©æƒ³å†™ä¸€ä¸‹ w2 è¡¨æ ¼ä¸åŒæ ¼å­é‡Œå…·ä½“ä»£è¡¨ä»€ä¹ˆå†…å®¹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;w2&#34;&gt;W2&lt;/h2&gt;
&lt;h3 id=&#34;å¤§è‡´&#34;&gt;å¤§è‡´&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;w2 è¡¨æ ¼æ€»ç»“äº†å¹´åº¦çš„æ”¶å…¥å’Œé¢„ç¼´ï¼ŒFICAï¼ŒåŒ»ä¿ï¼Œé€€ä¼‘ï¼ŒHSAã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;æ¯ä¸ªæ ¼å­&#34;&gt;æ¯ä¸ªæ ¼å­&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;a. social security number
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;b. employer id
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;c. employ name, address, zip code
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;d. control number (your id in company)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;e. employee&amp;#39;s name, address
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;f. employee&amp;#39;s zip code.
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;1. wages,tips, other comp, è”é‚¦æ‰€å¾—ç¨çš„ç¨åŸº ï¼ˆæ‰£é™¤ 401k ä»¥åï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;2. federal income tax witheldï¼Œè”é‚¦ç¨é¢„ç¼´
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;3. social security taxï¼Œç¤¾ä¿ç¨åŸº ï¼ˆcap 168600 - 2024ï¼‰ï¼Œè¶…è¿‡çš„éƒ¨åˆ†ä¸ç”¨äº¤ social security tax
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;4. social security tax withheld ç¤¾ä¿ç¨æ”¶çš„é¢„ç¼´ï¼Œç¨æ”¶æ˜¯ 6.2%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;5. medicare wages/tips åŒ»ä¿ç¨åŸºï¼Œæ²¡æœ‰ capï¼Œå« 401k
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;6. medicare tax withheld åŒ»ä¿ç¨æ”¶çš„é¢„ç¼´ï¼Œ1.45%ï¼Œè¶…è¿‡ 20 ä¸‡+0.9%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;7. social security tips å°è´¹æ”¶å…¥
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;8. allocated tips å°è´¹æ”¶å…¥
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;9. blank
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;10. Dependent Care Benefits
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;11. Nonqualified Plans ç»™ executiveï¼Œé«˜ç®¡
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;12. 401kï¼ŒHSA contributionï¼Œetc
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;13.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;14. state disability insurance
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;15. state å·
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;16. state wages å·¥èµ„ï¼Œå’Œ box 1 ä¸ä¸€æ ·ï¼Œå› ä¸º HSA åœ¨ state level æ”¶ç¨ï¼Œä½†æ˜¯åœ¨ federal level ä¸æ”¶ç¨
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;17. state income tax å·ç¨æ”¶
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;./w2-example.png&#34; alt=&#34;w2-example&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;reference&#34;&gt;reference&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=_FTOcAjmFVs&amp;amp;ab_channel=%E8%B7%9F%E6%88%91%E4%B8%80%E8%B5%B7%E6%9D%A5%E8%B0%88%E9%92%B1&#34;&gt;https://www.youtube.com/watch?v=_FTOcAjmFVs&amp;amp;ab_channel=%E8%B7%9F%E6%88%91%E4%B8%80%E8%B5%B7%E6%9D%A5%E8%B0%88%E9%92%B1&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
    </item>
    
    <item>
      <title>æŠ•èµ„å·¥å…·-Bond</title>
      <link>http://localhost:1313/post/2025-03-13-bond-%E5%9B%BD%E5%80%BA/</link>
      <pubDate>Thu, 13 Mar 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-03-13-bond-%E5%9B%BD%E5%80%BA/</guid>
      <description>&lt;h2 id=&#34;treasury-åˆ†ç±»&#34;&gt;Treasury åˆ†ç±»&lt;/h2&gt;
&lt;h3 id=&#34;t-bill-treasury-bill&#34;&gt;T-Bill, Treasury Bill&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;çŸ­æœŸï¼š4 weekï¼Œ8 weekï¼Œ12 weekï¼Œ etcã€‚&lt;/li&gt;
&lt;li&gt;æ²¡æœ‰ couponï¼ˆç¥¨é¢åˆ©æ¯ï¼‰ï¼Œåªæœ‰æŠ˜ä»·å‘è¡Œï¼ŒæŠ˜ä»·ç‡ï¼Œæœ¬è´¨æ˜¯ interest è€Œä¸æ˜¯ capital gainã€‚&lt;/li&gt;
&lt;li&gt;åˆ©æ¯æ˜¯ recurring gainï¼Œç¨ç‡ä½ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;t-note-treasury-note&#34;&gt;T-Note, Treasury Note&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;ä¸­æœŸï¼š2-10 å¹´ã€‚&lt;/li&gt;
&lt;li&gt;å¼€å§‹æœ‰ç¥¨é¢åˆ©æ¯ï¼Œ6 ä¸ªæœˆä»˜ä¸€æ¬¡ã€‚&lt;/li&gt;
&lt;li&gt;æœ‰äºŒçº§å¸‚åœºï¼ŒæµåŠ¨æ€§å¥½ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€çº§å¸‚åœºï¼šprimary market, èèµ„çš„å…¬å¸ç›´æ¥å–ç»™ä½ ï¼Œä»·æ ¼äº‹å…ˆé€šè¿‡æŠ•è¡Œï¼ˆinvestment bankingï¼‰å®šå¥½ï¼ŒIPOã€‚Bond ç­‰äºæ˜¯æ”¿åºœå®šä»·ã€‚&lt;/li&gt;
&lt;li&gt;äºŒçº§å¸‚åœºï¼šsecondary marketï¼ŒæŠ•èµ„äººä¸æŠ•èµ„äººä¹‹é—´äº’ç›¸çš„ä¹°å–ï¼Œä»·æ ¼é€šè¿‡äº’ç›¸ä¹°å–çš„å¸‚åœºå†³å®šã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;t-bond-treasury-bond&#34;&gt;T-Bond, Treasury Bond&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;é•¿æœŸï¼š10-30 å¹´æœŸã€‚&lt;/li&gt;
&lt;li&gt;6 ä¸ªæœˆä»˜ä¸€æ¬¡åˆ©æ¯ã€‚&lt;/li&gt;
&lt;li&gt;èŠ±ä¸€å®šä»·æ ¼è´­ä¹° face value çš„ Bondï¼Œä¼šæœ‰åˆ©æ¯ï¼Œåˆ°æœŸä»¥åä½ ä¼šæ‹¿åˆ° face value çš„é’±&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æ”¶ç›Šç‡æ›²çº¿å€’æŒ‚ï¼šå˜æˆé’Ÿå½¢ï¼Œé•¿æœŸåè€Œä½ã€‚ï¼ˆyield å«åšå®é™…æ”¶ç›Šç‡ï¼‰å¯èƒ½ä¼šå‡ºç°ç»æµå±æœºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;tips-treasury-inflation-protected-securities&#34;&gt;TIPS, Treasury Inflation Protected Securities&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;é•¿æœŸï¼š5 å¹´ï¼Œ10 å¹´ï¼Œ30 å¹´ã€‚&lt;/li&gt;
&lt;li&gt;6 ä¸ªæœˆä»˜ä¸€æ¬¡ï¼Œæœ¬é‡‘ä¼šéšç€é€šè´§è†¨èƒ€ç‡è°ƒæ•´ã€‚é€šè´§è†¨èƒ€æ—¶å€™æ‹¿çš„å¤šï¼Œç›¸åé€šè´§ç´§ç¼©æ‹¿çš„å°‘ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;frn-floating-rate-note&#34;&gt;FRN, Floating Rate Note&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;ä¸­æœŸï¼š2 å¹´æœŸã€‚&lt;/li&gt;
&lt;li&gt;6 ä¸ªæœˆä»˜ä¸€æ¬¡ï¼Œåˆ©ç‡æ ¹æ® 13 å‘¨ T-Bills åˆ©ç‡ä¸Šä¸‹æµ®åŠ¨ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;å¸¸è¯†&#34;&gt;å¸¸è¯†&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;å›½å€ºå… state taxï¼Œlocal taxï¼Œä½†æ˜¯ federal tax æ˜¯ä¸èƒ½å…é™¤çš„ã€‚&lt;/li&gt;
&lt;li&gt;bank/broker è´­ä¹°å’Œ treasury direct è´­ä¹°çš„åŒºåˆ«ï¼šbank/broker å¯ä»¥ç”¨ non-competitive billing å’Œ competitive billing è´­ä¹°ã€‚éç«äº‰æ€§ç«ä»·è‚¯å®šå¯ä»¥ä¹°åˆ°ï¼Œä½†æ˜¯ä¹°ä¹‹å‰ä¸èƒ½å‡†ç¡®çŸ¥é“ä»¥ä»€ä¹ˆä»·æ ¼ä¹°ï¼Œç«äº‰æ€§ç«ä»·è§„å®šæˆ‘ä»¥ä»€ä¹ˆä»·æ ¼è´­ä¹°ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;reference&#34;&gt;reference:&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=kj87yxWJ9qQ&amp;amp;ab_channel=%E8%B7%9F%E6%88%91%E4%B8%80%E8%B5%B7%E6%9D%A5%E8%B0%88%E9%92%B1&#34;&gt;https://www.youtube.com/watch?v=kj87yxWJ9qQ&amp;amp;ab_channel=%E8%B7%9F%E6%88%91%E4%B8%80%E8%B5%B7%E6%9D%A5%E8%B0%88%E9%92%B1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=HdcL9J1cp8w&amp;amp;ab_channel=%E8%B7%9F%E6%88%91%E4%B8%80%E8%B5%B7%E6%9D%A5%E8%B0%88%E9%92%B1&#34;&gt;https://www.youtube.com/watch?v=HdcL9J1cp8w&amp;amp;ab_channel=%E8%B7%9F%E6%88%91%E4%B8%80%E8%B5%B7%E6%9D%A5%E8%B0%88%E9%92%B1&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;qa&#34;&gt;Q&amp;amp;A&lt;/h2&gt;
&lt;h3 id=&#34;what-are-series-ee-and-series-i-savings-bond&#34;&gt;What are Series EE and Series I savings bond?&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Savings Bond å°±æ˜¯ä¸€ä¸ªä»é£é™©å’Œæ”¶ç›Šç‡å’Œå®šæœŸå­˜æ¬¾éå¸¸åƒçš„ä¸€ä¸ªäº§å“ï¼Œå®šæœŸå­˜æ¬¾ CD åœ¨ç¾å›½æ˜¯å•†ä¸šé“¶è¡Œå‘è¡Œçš„ï¼ŒSavings Bond æ˜¯ç¾å›½æ”¿åºœå‘è¡Œçš„ã€‚&lt;/li&gt;
&lt;li&gt;Savings Bond åˆ† Series EE å’Œ Series Iã€‚
&lt;ul&gt;
&lt;li&gt;Series EE æ˜¯æŠ˜ä»·å‘è¡Œï¼Œç”šè‡³æ˜¯åŠä»·ï¼Œ20 å¹´å°±èƒ½èµå›ï¼Œ1 å¹´å†…èµå›å°±ä¸§å¤±æ‰€æœ‰é’±ï¼Œ5 å¹´å†…ä¸§å¤±æœ€åä¸‰ä¸ªæœˆåˆ©æ¯ï¼ˆearly withdraw penaltyï¼‰ï¼Œæ²¡æœ‰äºŒçº§å¸‚åœºï¼Œæ‰€ä»¥æ›´åƒ Saving è€Œä¸æ˜¯å‚¨è“„ã€‚é¦–å…ˆåˆ©ç‡å¾ˆä½ï¼Œå…¶æ¬¡å³ä½¿ç¿»å€ä¹Ÿæœ‰é€šè´§è†¨èƒ€çš„å› ç´ ï¼Œ(1.03)^20 = 1.8, (1.04)^20 = 2.1&lt;/li&gt;
&lt;li&gt;Series I æœ€å¤§ä¸åŒåœ¨äºå®ƒå¹¶ä¸æ˜¯æŠ˜ä»·å‘è¡Œï¼Œé¢å€¼å‘è¡Œï¼Œèµ‹äºˆåˆ©æ¯ï¼Œåˆ©ç‡æ˜¯ CPI correlated çš„ã€‚Series I æœ‰ floorï¼Œä¸‹é™ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Series H Bondï¼Œè¿™ç§åœ¨ 04 å¹´ä»¥åä¸å‘è¡Œäº†ã€‚&lt;/li&gt;
&lt;li&gt;tax
&lt;ul&gt;
&lt;li&gt;åªæ˜¯ federal taxï¼Œno local/state taxã€‚&lt;/li&gt;
&lt;li&gt;ç‹¬ç‰¹ä¹‹å¤„åœ¨äºä½ å¯ä»¥é€‰æ‹©æ¯å¹´æ‹¿åˆ©æ¯äº¤ç¨ï¼Œä¹Ÿå¯ä»¥å‰ 20 å¹´ä¸æ‹¿åˆ©æ¯ï¼Œæœ€å 20 å¹´äº¤ä¸€ç¬”ç¨ï¼Œé€‰äº†ä¹‹åä¸èƒ½å˜äº†ï¼Œå¦‚æœä¸æ­¢ä¸€åª savings bondï¼Œæ¯ä¸ª bond é€‰æ‹©å¾—ç›¸åŒã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœä½ ç”¨äº educationï¼Œå¯ä»¥ç”¨æ¥å­¦è´¹ï¼Œqualified intuition expenseï¼Œä¹¦æœ¬ä½å®¿è¿˜æ˜¯ä¸èƒ½å…ç¨ï¼Œç»“å©šä»¥åå¾—è”åˆ file taxã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;c-of-i-zero-interest-certificate-of-indebedness&#34;&gt;C of I, Zero Interest Certificate of Indebedness&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Zero Interest ä¸ç­‰äº 0 coupon(æ²¡æœ‰ç¥¨é¢åˆ©æ¯çš„å€ºåˆ¸)ï¼ŒæŠ˜ä»·å‘è¡Œä¼šæœ‰åˆ©æ¯åœ¨é‡Œé¢&lt;/li&gt;
&lt;li&gt;å°±æ˜¯æ²¡æœ‰åˆ©æ¯çš„ç†è´¢äº§å“ï¼Ÿä¸ºä»€ä¹ˆä¸å­˜åœ¨é“¶è¡Œæ‹¿ interest æˆ–è€…ä¹° bondï¼Ÿ&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;stripsseparate-trading-of-registered-interest-and-principal-of-securities&#34;&gt;Stripsï¼ŒSeparate Trading of Registered Interest and Principal of Securities&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;æŠŠä¸€ä¸ª T-Noteï¼ŒT-Bond ç»™æ‹†æˆæœ¬é‡‘å’Œåˆ©æ¯ï¼Œä½ åªæ‹¿åˆ°åˆ©æ¯æˆ–è€…åªæ‹¿åˆ°æœ¬é‡‘&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;æ²¡æœ‰çœ‹åˆ°å›½å€ºæœ‰-fdic-ä¿é™©&#34;&gt;æ²¡æœ‰çœ‹åˆ°å›½å€ºæœ‰ fdic ä¿é™©&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;åŸºæœ¬æ²¡æœ‰é£é™©ï¼Œä¸ç”¨è€ƒè™‘è¿™ä¸ªé—®é¢˜ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;secondary-issue-bond&#34;&gt;Secondary Issue Bond&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;äºŒçº§å¸‚åœºè´­ä¹°çš„ Bondã€‚&lt;/li&gt;
&lt;/ol&gt;
</description>
    </item>
    
    <item>
      <title>æŠ•èµ„ç­–ç•¥-Laddering(æ¢¯çŠ¶é…è‚¡)</title>
      <link>http://localhost:1313/post/2025-03-12-%E5%82%A8%E8%93%84%E7%9A%84%E7%AD%96%E7%95%A5/</link>
      <pubDate>Wed, 12 Mar 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-03-12-%E5%82%A8%E8%93%84%E7%9A%84%E7%AD%96%E7%95%A5/</guid>
      <description>&lt;p&gt;(written by chatgpt, reviewed by haihaosun)&lt;/p&gt;
&lt;h1 id=&#34;laddering-a-smart-investment-strategy&#34;&gt;Laddering: A Smart Investment Strategy&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;Laddering&lt;/strong&gt; is an investment strategy used to manage risk, increase liquidity, and optimize returns by diversifying investment maturities across different time frames. This strategy is commonly applied to fixed-income investments like &lt;strong&gt;certificates of deposit (CDs), bonds, and Treasury securities&lt;/strong&gt;.&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;1-how-laddering-works&#34;&gt;1. How Laddering Works&lt;/h2&gt;
&lt;p&gt;Laddering involves &lt;strong&gt;dividing your total investment&lt;/strong&gt; into multiple smaller investments with &lt;strong&gt;different maturity dates&lt;/strong&gt; rather than investing all funds into a single long-term or short-term instrument. This creates a â€œladderâ€ of investments maturing at regular intervals.&lt;/p&gt;
&lt;h3 id=&#34;example-a-5-year-bond-ladder&#34;&gt;Example: A 5-Year Bond Ladder&lt;/h3&gt;
&lt;p&gt;Suppose you have &lt;strong&gt;$50,000&lt;/strong&gt; to invest in bonds. Instead of buying a single 5-year bond, you create a ladder:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;Investment&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Term&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Amount Invested&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;Interest Rate&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Bond 1&lt;/td&gt;
&lt;td&gt;1 year&lt;/td&gt;
&lt;td&gt;$10,000&lt;/td&gt;
&lt;td&gt;3.5%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Bond 2&lt;/td&gt;
&lt;td&gt;2 years&lt;/td&gt;
&lt;td&gt;$10,000&lt;/td&gt;
&lt;td&gt;3.8%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Bond 3&lt;/td&gt;
&lt;td&gt;3 years&lt;/td&gt;
&lt;td&gt;$10,000&lt;/td&gt;
&lt;td&gt;4.0%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Bond 4&lt;/td&gt;
&lt;td&gt;4 years&lt;/td&gt;
&lt;td&gt;$10,000&lt;/td&gt;
&lt;td&gt;4.2%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Bond 5&lt;/td&gt;
&lt;td&gt;5 years&lt;/td&gt;
&lt;td&gt;$10,000&lt;/td&gt;
&lt;td&gt;4.5%&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;When &lt;strong&gt;Bond 1 matures&lt;/strong&gt; after 1 year, you &lt;strong&gt;reinvest it into a new 5-year bond&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;The next year, &lt;strong&gt;Bond 2 matures&lt;/strong&gt;, and you again reinvest in a 5-year bond.&lt;/li&gt;
&lt;li&gt;This process continues, maintaining a constant ladder where one bond matures annually.&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;2-benefits-of-laddering&#34;&gt;2. Benefits of Laddering&lt;/h2&gt;
&lt;h3 id=&#34;-1-improves-liquidity&#34;&gt;âœ… 1. Improves Liquidity&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Since investments mature at regular intervals, you can access funds periodically.&lt;/li&gt;
&lt;li&gt;Ideal for investors who may need cash in the short term without sacrificing long-term growth.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;-2-reduces-interest-rate-risk&#34;&gt;âœ… 2. Reduces Interest Rate Risk&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;By spreading out maturity dates, laddering minimizes the impact of rising or falling interest rates.&lt;/li&gt;
&lt;li&gt;If rates &lt;strong&gt;increase&lt;/strong&gt;, you reinvest matured investments at higher rates.&lt;/li&gt;
&lt;li&gt;If rates &lt;strong&gt;decrease&lt;/strong&gt;, you still have longer-term investments locked in at higher yields.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;-3-enhances-predictability-and-stability&#34;&gt;âœ… 3. Enhances Predictability and Stability&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;You receive periodic &lt;strong&gt;interest payments&lt;/strong&gt; and &lt;strong&gt;maturing principal&lt;/strong&gt;, making financial planning easier.&lt;/li&gt;
&lt;li&gt;Suitable for &lt;strong&gt;retirees&lt;/strong&gt; or &lt;strong&gt;income-focused investors&lt;/strong&gt; seeking steady returns.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;-4-maximizes-returns-over-time&#34;&gt;âœ… 4. Maximizes Returns Over Time&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Instead of keeping cash idle in low-yield savings accounts, laddering ensures money is continuously working for you.&lt;/li&gt;
&lt;li&gt;Offers a &lt;strong&gt;balance between short-term access and long-term higher yields&lt;/strong&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;3-laddering-strategies&#34;&gt;3. Laddering Strategies&lt;/h2&gt;
&lt;p&gt;Laddering can be applied to different types of fixed-income investments:&lt;/p&gt;
&lt;h3 id=&#34;1-cd-laddering-certificates-of-deposit&#34;&gt;1. CD Laddering (Certificates of Deposit)&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Investors buy CDs with &lt;strong&gt;staggered maturity dates&lt;/strong&gt; to balance liquidity and returns.&lt;/li&gt;
&lt;li&gt;Example: A &lt;strong&gt;12-month ladder&lt;/strong&gt; using CDs with &lt;strong&gt;3-month, 6-month, 9-month, and 12-month terms&lt;/strong&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;2-bond-laddering&#34;&gt;2. Bond Laddering&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Works best with &lt;strong&gt;government bonds, corporate bonds, and municipal bonds&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;Helps mitigate reinvestment risk while capturing favorable interest rates.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;3-treasury-laddering-t-bill-ladder&#34;&gt;3. Treasury Laddering (T-Bill Ladder)&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Investors buy &lt;strong&gt;4-week, 8-week, 13-week, 26-week, and 52-week Treasury Bills&lt;/strong&gt; to ensure frequent liquidity.&lt;/li&gt;
&lt;li&gt;Ideal for &lt;strong&gt;risk-averse investors&lt;/strong&gt; looking for safe returns with periodic access to funds.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;4-stock-dividend-laddering-less-common&#34;&gt;4. Stock Dividend Laddering (Less Common)&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Investors buy &lt;strong&gt;dividend stocks&lt;/strong&gt; with different payment schedules to ensure monthly income.&lt;/li&gt;
&lt;li&gt;Example: Buying stocks that pay &lt;strong&gt;dividends in January, April, July, and October&lt;/strong&gt;, while others pay in &lt;strong&gt;February, May, August, and November&lt;/strong&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;4-who-should-use-laddering&#34;&gt;4. Who Should Use Laddering?&lt;/h2&gt;
&lt;p&gt;âœ” &lt;strong&gt;Conservative investors&lt;/strong&gt; looking for a mix of liquidity and returns.&lt;br&gt;
âœ” &lt;strong&gt;Retirees&lt;/strong&gt; who need &lt;strong&gt;steady income&lt;/strong&gt; and predictable cash flow.&lt;br&gt;
âœ” &lt;strong&gt;Investors concerned about interest rate fluctuations&lt;/strong&gt;.&lt;br&gt;
âœ” &lt;strong&gt;People saving for specific goals&lt;/strong&gt; (e.g., a home purchase in 5 years).&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;5-downsides-of-laddering&#34;&gt;5. Downsides of Laddering&lt;/h2&gt;
&lt;p&gt;âŒ &lt;strong&gt;Lower Short-Term Returns&lt;/strong&gt; â€“ Initial yields may be lower than investing everything in long-term assets.&lt;br&gt;
âŒ &lt;strong&gt;Reinvestment Risk&lt;/strong&gt; â€“ If interest rates drop, reinvested funds may yield lower returns.&lt;br&gt;
âŒ &lt;strong&gt;Complexity&lt;/strong&gt; â€“ Managing multiple investments requires more tracking.&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;6-final-thoughts&#34;&gt;6. Final Thoughts&lt;/h2&gt;
&lt;p&gt;Laddering is a &lt;strong&gt;low-risk&lt;/strong&gt;, &lt;strong&gt;strategic investment approach&lt;/strong&gt; that balances &lt;strong&gt;liquidity, income stability, and risk management&lt;/strong&gt;. Whether used for &lt;strong&gt;CDs, bonds, or T-bills&lt;/strong&gt;, it helps investors maintain access to cash while optimizing long-term returns.&lt;/p&gt;
&lt;h2 id=&#34;7-æŠŠä¹¦è¯»è–„&#34;&gt;7. æŠŠä¹¦è¯»è–„&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æ ¸å¿ƒæ€æƒ³å°±æ˜¯æŠŠæ‰€æœ‰é’±åˆ†æˆ n ä»½ï¼Œç„¶åç”¨ä¸€ç§ dollar cost avergaing çš„ç­–ç•¥æŠ•å…¥å‚¨è“„ã€‚é™ä½åˆ©ç‡æ³¢åŠ¨é£é™©ï¼Œå¹¶ä¸”è®©æ‰‹é‡Œé’±çš„æµåŠ¨æ€§å¢å¼ºã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ˜¯ä¸è¦æŠŠé¸¡è›‹æ”¾åœ¨ä¸€ä¸ªç¯®å­é‡Œçš„å¦ä¸€ç§åœ¨æ—¶é—´è½´ä¸Šçš„ä½“ç°ã€‚å³ä½¿æŠ•å…¥çš„ç†è´¢äº§å“æ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯æŠ•å…¥çš„æ—¶é—´ä¸åŒä¹Ÿä¼šé™ä½é£é™©ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;reference: &lt;a href=&#34;https://www.youtube.com/watch?v=je5j9ZiJa2k&amp;amp;ab_channel=%E8%B7%9F%E6%88%91%E4%B8%80%E8%B5%B7%E6%9D%A5%E8%B0%88%E9%92%B1&#34;&gt;https://www.youtube.com/watch?v=je5j9ZiJa2k&amp;amp;ab_channel=%E8%B7%9F%E6%88%91%E4%B8%80%E8%B5%B7%E6%9D%A5%E8%B0%88%E9%92%B1&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>æŠ•èµ„å·¥å…·-å‚¨è“„</title>
      <link>http://localhost:1313/post/2025-03-11-%E5%82%A8%E8%93%84/</link>
      <pubDate>Tue, 11 Mar 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-03-11-%E5%82%A8%E8%93%84/</guid>
      <description>&lt;h2 id=&#34;æŠ•èµ„å·¥å…·---å‚¨è“„&#34;&gt;æŠ•èµ„å·¥å…· - å‚¨è“„&lt;/h2&gt;
&lt;h3 id=&#34;cd-certificate-of-deposit&#34;&gt;CD (certificate of deposit)&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ç®€å•æ¥è¯´å°±æ˜¯å­˜é’±æ‹¿åˆ©æ¯&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;penalty-free-cd&#34;&gt;Penalty Free CD&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æ¯” CD åˆ©æ¯ä½ï¼Œä½†æ˜¯æ²¡æœ‰æå‰å–å‡ºçš„ penalty&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;t-bills&#34;&gt;T-Bills&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.treasurydirect.gov/&#34;&gt;è´­ä¹°ç½‘ç«™&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;åŸºæœ¬æ²¡æœ‰é£é™©ï¼Œå¯ä»¥å…é™¤ state tax&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;money-market&#34;&gt;Money Market&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å¥½çš„æµåŠ¨ï¼Œé«˜çš„åˆ©ç‡&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;reference: &lt;a href=&#34;https://www.youtube.com/watch?v=CQ63ec_qWKQ&amp;amp;ab_channel=%E8%B7%9F%E6%88%91%E4%B8%80%E8%B5%B7%E6%9D%A5%E8%B0%88%E9%92%B1&#34;&gt;https://www.youtube.com/watch?v=CQ63ec_qWKQ&amp;amp;ab_channel=%E8%B7%9F%E6%88%91%E4%B8%80%E8%B5%B7%E6%9D%A5%E8%B0%88%E9%92%B1&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>æŠ•èµ„å“²å­¦&#43;æŠ•èµ„ç­–ç•¥&#43;æŠ•èµ„å·¥å…·</title>
      <link>http://localhost:1313/post/2025-03-09-%E6%8A%95%E8%B5%84%E5%93%B2%E5%AD%A6&#43;%E6%8A%95%E8%B5%84%E7%AD%96%E7%95%A5&#43;%E6%8A%95%E8%B5%84%E5%B7%A5%E5%85%B7/</link>
      <pubDate>Sun, 09 Mar 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-03-09-%E6%8A%95%E8%B5%84%E5%93%B2%E5%AD%A6&#43;%E6%8A%95%E8%B5%84%E7%AD%96%E7%95%A5&#43;%E6%8A%95%E8%B5%84%E5%B7%A5%E5%85%B7/</guid>
      <description>&lt;h2 id=&#34;æŠ•èµ„å“²å­¦-investment-philosophy&#34;&gt;æŠ•èµ„å“²å­¦ Investment Philosophy&lt;/h2&gt;
&lt;h3 id=&#34;categorizing-investment-philosophies&#34;&gt;categorizing Investment Philosophies&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Market Timing versus Asset Selection: With market timing, you bet on the
movement of entire markets - financial as well as real assets. With asset
selection, you focus on picking good investments within each market.&lt;/li&gt;
&lt;li&gt;Activist Investing versus Passive Investing: With passive investing, you take
positions in companies and hope that the market corrects its mistakes. With
activist investing, you play a role (or provide the catalyst) in correcting market mistakes.&lt;/li&gt;
&lt;li&gt;Time Horizon: Some philosophies require that you invest for long time
periods. Others are based upon short holding periods.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;investment-philosophy-examples&#34;&gt;Investment Philosophy Examples&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä»·å€¼æŠ•èµ„ Value Investing&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯»æ‰¾ underpriced çš„ stockï¼Œé€šè¿‡é•¿æœŸæŒæœ‰è·å–ä»·å€¼å›å½’çš„æ”¶ç›Šã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¢é•¿æŠ•èµ„ Growth Investing&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯»æ‰¾æ½œåŠ›é«˜çš„å…¬å¸ï¼Œå³ä½¿å½“å‰ä¼°å€¼é«˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åŠ¨é‡æŠ•èµ„ Momentum Investing&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¹°å…¥ä¸Šæ¶¨è¶‹åŠ¿ä¸­çš„èµ„äº§ï¼Œå¹¶åœ¨è¡°é€€è¶‹åŠ¿å‰å–å‡º&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;reference: &lt;a href=&#34;https://www.investopedia.com/terms/i/investment-philosophy.asp&#34;&gt;https://www.investopedia.com/terms/i/investment-philosophy.asp&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;reference: &lt;a href=&#34;https://pages.stern.nyu.edu/~adamodar/pdfiles/country/invphil1day.pdf&#34;&gt;https://pages.stern.nyu.edu/~adamodar/pdfiles/country/invphil1day.pdf&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æŠ•èµ„ç­–ç•¥-investment-strategies&#34;&gt;æŠ•èµ„ç­–ç•¥ Investment Strategies&lt;/h2&gt;
&lt;h3 id=&#34;investment-strategies-example&#34;&gt;Investment Strategies Example&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;èµ„äº§é…ç½® Asset Allocation&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ ¹æ®æŠ•èµ„è€…çš„é£é™©åå¥½ï¼Œå°†èµ„é‡‘åˆ†é…åˆ°è‚¡ç¥¨ï¼Œå€ºåˆ¸ï¼Œæˆ¿åœ°äº§ç­‰ä¸åŒæŠ•èµ„äº§å“&lt;/li&gt;
&lt;li&gt;age% é˜²å®ˆ&lt;/li&gt;
&lt;li&gt;ï¼ˆ1 - age%ï¼‰è¿›æ”»&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å®šæŠ•ç­–ç•¥ï¼ˆDollar-Cost Averaging, DCAï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å®šæœŸæŠ•å…¥å›ºå®šé‡‘é¢èµ„é‡‘ï¼Œæ— è®ºå¸‚åœºæ¶¨è·Œï¼Œå‡å°‘æ‹©æ—¶é£é™©ï¼Œå¹³æ»‘æˆæœ¬&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é‡åŒ–æŠ•èµ„ï¼ˆQuantitative Investingï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åˆ©ç”¨æ•°å­¦æ¨¡å‹å’Œè®¡ç®—æœºç®—æ³•è¿›è¡Œäº¤æ˜“ï¼Œå¦‚é«˜é¢‘äº¤æ˜“ï¼ˆHFTï¼‰å’Œå› å­æŠ•èµ„ï¼ˆFactor Investingï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;æŠ•èµ„å·¥å…·-investment-tools&#34;&gt;æŠ•èµ„å·¥å…· Investment Tools&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è‚¡ç¥¨ Stock&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¤§å®—å•†å“&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æˆ¿åœ°äº§&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é»„é‡‘&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å€ºåˆ¸&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è´§å¸åŸºé‡‘&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;å¦‚ä½•é€‰æ‹©åˆé€‚è‡ªå·±çš„æŠ•èµ„æ–¹å¼&#34;&gt;å¦‚ä½•é€‰æ‹©åˆé€‚è‡ªå·±çš„æŠ•èµ„æ–¹å¼&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;æ˜ç¡®ç›®æ ‡
&lt;ul&gt;
&lt;li&gt;çŸ­æœŸï¼ˆ1-3 å¹´ï¼‰ï¼šé€‚åˆçŸ­çº¿äº¤æ˜“ã€åŠ¨é‡ç­–ç•¥ã€æœŸæƒäº¤æ˜“ã€‚&lt;/li&gt;
&lt;li&gt;ä¸­æœŸï¼ˆ3-10 å¹´ï¼‰ï¼šé€‚åˆæˆé•¿è‚¡æŠ•èµ„ã€å®šæŠ•æŒ‡æ•°åŸºé‡‘ã€å®è§‚å¯¹å†²ç­–ç•¥ã€‚&lt;/li&gt;
&lt;li&gt;é•¿æœŸï¼ˆ10 å¹´ä»¥ä¸Šï¼‰ï¼šé€‚åˆä»·å€¼æŠ•èµ„ã€æŒ‡æ•°æŠ•èµ„ã€æˆ¿åœ°äº§æŠ•èµ„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è¯„ä¼°é£é™©æ‰¿å—èƒ½åŠ›
&lt;ul&gt;
&lt;li&gt;ä½é£é™©æŠ•èµ„è€…ï¼šä¼˜å…ˆé€‰æ‹©å€ºåˆ¸ã€æŒ‡æ•°åŸºé‡‘ã€æˆ¿åœ°äº§ã€‚&lt;/li&gt;
&lt;li&gt;ä¸­ç­‰é£é™©æŠ•èµ„è€…ï¼šé…ç½®æˆé•¿è‚¡ã€ETFã€REITsã€‚&lt;/li&gt;
&lt;li&gt;é«˜é£é™©æŠ•èµ„è€…ï¼šå¯ä»¥è€ƒè™‘ä¸ªè‚¡ã€æœŸæƒã€å¤–æ±‡ã€åŠ å¯†è´§å¸ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç»“åˆå¸‚åœºç¯å¢ƒ
&lt;ul&gt;
&lt;li&gt;ç‰›å¸‚ï¼šé€‚åˆæˆé•¿æŠ•èµ„ã€åŠ¨é‡æŠ•èµ„ã€‚&lt;/li&gt;
&lt;li&gt;ç†Šå¸‚ï¼šé€‚åˆä»·å€¼æŠ•èµ„ã€å®è§‚å¯¹å†²ç­–ç•¥ã€å€ºåˆ¸æŠ•èµ„ã€‚&lt;/li&gt;
&lt;li&gt;é«˜é€šèƒ€æ—¶æœŸï¼šé»„é‡‘ã€å¤§å®—å•†å“ã€æˆ¿åœ°äº§è¡¨ç°è¾ƒå¥½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;ä¸ªäººçš„-takeaway&#34;&gt;ä¸ªäººçš„ takeaway&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆå¯¹æˆ‘æ¥è¯´æœ€é‡è¦çš„ä¸€ç‚¹æ˜¯æ˜ç¡®èŒä¸šç”Ÿæ¶¯æ˜¯æä¾›è´¢å¯Œçš„åŸºçŸ³ï¼ŒæŠ•èµ„åªæ˜¯è®©å‚¨è“„çš„é’±è‡ªåŠ¨ç”Ÿé’±çš„ä¸€ä¸ªæœºä¼šã€‚å…¶æ¬¡æƒ³æ˜ç¡®çš„æ˜¯äº†è§£æŠ•èµ„å’ŒæŠ•æœºçš„åŒºåˆ«ï¼Œé•¿æœŸæŒæœ‰è€ŒéçŸ­æœŸæŠ•æœºã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ä»æŠ˜çº¸çš„æŒ«è´¥åˆ°é‡‘èç†è´¢çš„æ€è€ƒ</title>
      <link>http://localhost:1313/post/2025-03-07-systemic-thinking/</link>
      <pubDate>Fri, 07 Mar 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-03-07-systemic-thinking/</guid>
      <description>&lt;h2 id=&#34;æŠ˜çº¸æ´»åŠ¨çš„å¤±è´¥&#34;&gt;æŠ˜çº¸æ´»åŠ¨çš„å¤±è´¥&lt;/h2&gt;
&lt;p&gt;è¿™å‘¨å››ï¼Œæˆ‘å‚åŠ äº†å…¬å¸å†…éƒ¨çš„æŠ˜çº¸æ´»åŠ¨ã€‚æ•™å­¦è§†é¢‘å¤§çº¦ 30 åˆ†é’Ÿï¼Œä½†æœ‰äº›æ­¥éª¤å¯¹æˆ‘æ¥è¯´ç›¸å½“å›°éš¾ã€‚æˆ‘èŠ±äº† 45 åˆ†é’Ÿçœ‹äº† 15 åˆ†é’Ÿè§†é¢‘ï¼Œä½†æ“ä½œä¸­æŸä¸ªå…³é”®æ­¥éª¤å¡ä½äº†ï¼Œæ€ä¹ˆä¹Ÿå¼„ä¸å‡ºæ¥ã€‚å›å¤´ä¸€çœ‹ï¼Œå‘ç°å‰é¢çš„æ­¥éª¤å¯èƒ½ä¹Ÿæœ‰ä¸å°‘é”™è¯¯ï¼Œæœ€ç»ˆåªèƒ½æ”¾å¼ƒè¿™ä»¶ä½œå“ã€‚è€Œæˆ‘çš„æœ‹å‹ Neil åˆ™è¡¨ç°å¾—ç›¸å½“ä¸é”™ï¼Œä»–å®Œæˆäº†æ•´ä¸ª 30 åˆ†é’Ÿçš„â€œå¤§é¹…â€ä½œå“ï¼&lt;/p&gt;
&lt;p&gt;è¿™æ¬¡æŠ˜çº¸çš„æŒ«è´¥è®©æˆ‘æƒ³èµ·äº†ä¸€å¥è¯â€”â€”â€œäººè¦æ˜¯è¡Œï¼Œå¹²ä¸€è¡Œè¡Œä¸€è¡Œï¼Œä¸€è¡Œè¡Œè¡Œè¡Œè¡Œï¼›è¦æ˜¯ä¸è¡Œï¼Œå¹²ä¸€è¡Œä¸è¡Œä¸€è¡Œï¼Œä¸€è¡Œä¸è¡Œè¡Œè¡Œä¸è¡Œã€‚â€ æœ‰äº›äººæ— è®ºåœ¨å“ªä¸ªé¢†åŸŸéƒ½èƒ½æ¸¸åˆƒæœ‰ä½™ï¼Œè€Œæœ‰äº›äººåˆ™åœ¨ä¸åŒé¢†åŸŸå±¡å±¡å—æŒ«ã€‚æˆ‘ä¸ç¦å›æƒ³èµ·è‡ªå·±åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­çš„ç§ç§ç»å†ï¼Œå‘ç°å¤±è´¥çš„æ¨¡å¼ä¼¼ä¹ä¸€ç›´å­˜åœ¨ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ“…é•¿é¢†åŸŸå’Œä¸æ“…é•¿é¢†åŸŸ&#34;&gt;æ“…é•¿é¢†åŸŸå’Œä¸æ“…é•¿é¢†åŸŸ&lt;/h2&gt;
&lt;p&gt;åœ¨æˆ‘çŸ­æš‚è€Œå¹³å‡¡çš„å‰åŠç”Ÿé‡Œï¼Œæˆ‘æœ‰å¹¸æ¥è§¦äº†è®¸å¤šé¢†åŸŸï¼Œæœ‰çš„å­¦å¾—è¿˜ä¸é”™ï¼Œæœ‰çš„åˆ™ä¸å°½å¦‚äººæ„ã€‚æ€»ä½“æ¥è¯´ï¼Œæˆ‘å–œæ¬¢æ€è€ƒï¼Œå¹¶ä¸”åœ¨éœ€è¦é«˜æ€ç»´èƒ½åŠ›çš„é¢†åŸŸè¡¨ç°ç›¸å¯¹æ›´å¥½ï¼Œæ¯”å¦‚å›´æ£‹ã€æ•°å­¦å’Œç¼–ç¨‹ã€‚å½“ç„¶ï¼Œè¿™åªæ˜¯ç›¸å¯¹äºæˆ‘çš„å…¶ä»–èƒ½åŠ›è€Œè¨€ï¼Œè·ç¦»çœŸæ­£çš„é¡¶çº§å¤©èµ‹ä»ç„¶ç›¸å·®ç”šè¿œã€‚è€Œåœ¨è‰ºæœ¯å’Œä½“è‚²æ–¹é¢ï¼Œæˆ‘çš„å¤©èµ‹ä¼¼ä¹å°±æ˜¾å¾—æ ¼å¤–è–„å¼±ï¼Œä¾‹å¦‚ç»˜ç”»ã€ä¹å™¨å’Œç¯®çƒã€‚&lt;/p&gt;
&lt;p&gt;å›é¡¾è‡ªå·±åœ¨æŸäº›é¢†åŸŸå­¦ä¸å¥½çš„åŸå› ï¼Œä¸€æ–¹é¢å¯èƒ½æ˜¯æŠ•å…¥çš„æ—¶é—´ä¸å¤Ÿï¼Œå¦ä¸€æ–¹é¢åˆ™æ˜¯ç¼ºä¹æ­£åé¦ˆï¼Œå¯¼è‡´æŒ«è´¥æ„Ÿä¸æ–­ç´¯ç§¯ï¼Œæœ€ç»ˆé€‰æ‹©äº†æ”¾å¼ƒã€‚è€Œåœ¨é‚£äº›ç›¸å¯¹æ“…é•¿çš„é¢†åŸŸï¼Œæƒ…å†µæ­£å¥½ç›¸åâ€”â€”æˆ‘èƒ½ä¸æ–­è·å¾—æ­£åé¦ˆï¼Œå½¢æˆç³»ç»ŸåŒ–çš„æ€ç»´æ¨¡å¼ï¼Œä½¿å¾—å­¦ä¹ æ›´åŠ é«˜æ•ˆä¸”å……æ»¡æˆå°±æ„Ÿã€‚&lt;/p&gt;
&lt;h2 id=&#34;æˆä½“ç³»çš„æ€ç»´æ–¹å¼&#34;&gt;æˆä½“ç³»çš„æ€ç»´æ–¹å¼&lt;/h2&gt;
&lt;p&gt;æˆ‘æ“…é•¿çš„å­¦ä¹ æ–¹å¼æ˜¯ä½“ç³»åŒ–æ€ç»´ï¼Œå®ƒå…·å¤‡ä»¥ä¸‹ç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ˜ç¡®çš„æ¡†æ¶â€”â€”åœ¨è¿™äº›é¢†åŸŸä¸­ï¼Œé€šå¸¸æœ‰ä¸€å¥—ç¨³å®šçš„åˆ†æå’Œè§£å†³é—®é¢˜çš„ç»“æ„ï¼Œè€Œä¸æ˜¯é›¶æ•£çš„æ€è€ƒã€‚&lt;/li&gt;
&lt;li&gt;å¯æ‰©å±•ã€å¯å¤ç”¨â€”â€”å¯ä»¥é€šè¿‡å½’çº³æ€»ç»“ï¼Œè®©æœªçŸ¥é—®é¢˜å€ŸåŠ©å·²çŸ¥çš„æ–¹æ³•å¾—ä»¥è§£å†³ã€‚&lt;/li&gt;
&lt;li&gt;æ³¨é‡å› æœé€»è¾‘â€”â€”æ›´å…³æ³¨äº‹ç‰©ä¹‹é—´çš„å› æœå…³ç³»ï¼Œè€Œä¸æ˜¯å•çº¯ä¾èµ–æ„Ÿè§‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¿™ç§æ€ç»´æ¨¡å¼è®©æˆ‘åœ¨é¢å¯¹é—®é¢˜æ—¶ï¼Œèƒ½å¤Ÿè¿…é€Ÿå½’ç±»ï¼Œå¤§è„‘èƒ½è‡ªåŠ¨è”æƒ³åˆ°ç›¸åº”çš„åº”å¯¹ç­–ç•¥ã€‚ç®€å•çš„é—®é¢˜ï¼Œå¯èƒ½ç›´æ¥æœ‰ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼›å¤æ‚çš„é—®é¢˜ï¼Œå¤§è„‘è‡³å°‘èƒ½æä¾›ä¸€ä¸ªåˆç†çš„æ€è€ƒæ–¹å‘ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œä½“ç³»åŒ–çš„æ€ç»´æ–¹å¼èƒ½æå¤§åœ°èŠ‚çœæ€ç»´ç©ºé—´ï¼Œé¿å…åœ¨æ— æ•ˆçš„åˆ†æ”¯ä¸Šæµªè´¹è¿‡å¤šç²¾åŠ›ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è‰ºæœ¯çš„å›°å¢ƒä¸çªç ´&#34;&gt;è‰ºæœ¯çš„å›°å¢ƒä¸çªç ´&lt;/h2&gt;
&lt;p&gt;ç›¸æ¯”ä¹‹ä¸‹ï¼Œæˆ‘åœ¨è‰ºæœ¯æ–¹é¢çš„å¤©èµ‹å®åœ¨ç³Ÿç³•â€”â€”æ‰‹ä¸ŠåŠŸå¤«å·®ï¼Œå®¡ç¾ä¹Ÿä¸è¡Œï¼Œç”»ä»€ä¹ˆéƒ½ä¸åƒï¼Œç«–ç¬›è€ƒè¯•æ—¶ï¼Œå…¨ç­åªèƒ½å¬åˆ°åˆºè€³çš„å™ªéŸ³ï¼Œè‰ºæœ¯èŠ‚çš„æ´»åŠ¨ä¹Ÿåªæ˜¯å‹‰å¼ºåšäº›é…éŸ³å·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;å›å¤´æƒ³æƒ³ï¼Œæˆ–è®¸æ˜¯å› ä¸ºæˆ‘åœ¨è¿™äº›é¢†åŸŸç¼ºä¹ä¸€ä¸ªç³»ç»ŸåŒ–çš„æ€ç»´æ–¹å¼ï¼Œæˆ–è€…è¿™äº›é¢†åŸŸä¸­ç³»ç»Ÿçš„æ€ç»´æ–¹å¼å¹¶ä¸é‚£ä¹ˆé‡è¦ã€‚æ¯”å¦‚ï¼Œç”»ç”»çš„æ—¶å€™ï¼Œå¦‚æœæ²¡æœ‰åŸºç¡€çš„æ„å›¾æ¡†æ¶ï¼Œå…‰æ˜¯å¤„ç†å°ç»†èŠ‚å°±å·²ç»éš¾å¦‚ç™»å¤©ï¼Œæ›´åˆ«ææ•´ä½“æ•ˆæœäº†ã€‚ç«–ç¬›è€ƒè¯•çš„æ—¶å€™ï¼Œæˆ‘ç¼ºä¹å¯¹äºåŸºæœ¬æ¦‚å¿µçš„æŒæ¡ï¼Œæ¯”å¦‚è®¤äº”çº¿è°±ä¸æ‹å­ï¼Œæ›´åˆ«æå¤§çš„æ¡†æ¶ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç†è´¢æ–°çš„ä½“ç³»åŒ–æ¢ç´¢&#34;&gt;ç†è´¢ï¼šæ–°çš„ä½“ç³»åŒ–æ¢ç´¢&lt;/h2&gt;
&lt;p&gt;æœ€è¿‘ï¼Œæˆ‘å¼€å§‹ç ”ç©¶é‡‘èç†è´¢ï¼ŒåŒæ ·å¸Œæœ›é€šè¿‡ä½“ç³»åŒ–çš„æ€ç»´æ¨¡å¼æ¥æ„å»ºä¸€ä¸ªæ¸…æ™°çš„å¤§æ¡†æ¶ã€‚æˆ–è®¸çŸ­æ—¶é—´å†…æ— æ³•æ‰¾åˆ°æœ€ä¼˜çš„æŠ•èµ„ç­–ç•¥ï¼Œä½†å»ºç«‹åŸºæœ¬çš„é€»è¾‘æ¡†æ¶æ˜¯å¿…è¦çš„ã€‚æ­£å¦‚å­¦ä¹ æ•°å­¦ã€ç¼–ç¨‹ä¸€æ ·ï¼Œç†æ¸…æ ¸å¿ƒæ¦‚å¿µï¼Œæ‰¾åˆ°å› æœå…³ç³»ï¼Œæ‰èƒ½è®©åç»­çš„å­¦ä¹ å’Œå®è·µå˜å¾—æ›´é«˜æ•ˆã€‚&lt;/p&gt;
&lt;p&gt;æŠ˜çº¸æ´»åŠ¨çš„å¤±è´¥è®©æˆ‘åæ€å­¦ä¹ æ–¹å¼çš„é‡è¦æ€§â€”â€”åœ¨æ“…é•¿çš„é¢†åŸŸï¼Œæˆ‘ä¾é ä½“ç³»åŒ–æ€ç»´é«˜æ•ˆå­¦ä¹ ï¼Œè€Œåœ¨ç¼ºä¹æ¡†æ¶çš„é¢†åŸŸï¼Œåˆ™å®¹æ˜“é™·å…¥æŒ«è´¥ã€‚è‰ºæœ¯ç±»æŠ€èƒ½çš„å›°éš¾ï¼Œæˆ–è®¸æ­£æ˜¯å› ä¸ºç¼ºä¹æ¸…æ™°çš„é€»è¾‘ç»“æ„ã€‚å¦‚ä»Šï¼Œåœ¨å­¦ä¹ é‡‘èç†è´¢çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘å¸Œæœ›è¿ç”¨åŒæ ·çš„ç³»ç»ŸåŒ–æ–¹æ³•ï¼Œå»ºç«‹å¤§æ¡†æ¶ï¼Œä»è€Œæ›´ç†æ€§ã€é«˜æ•ˆåœ°æŒæ¡è¿™ä¸€æ–°é¢†åŸŸã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>é€€ä¼‘è´¦æˆ·æ¢³ç†101</title>
      <link>http://localhost:1313/post/2025-03-06-hack-retirement/</link>
      <pubDate>Thu, 06 Mar 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-03-06-hack-retirement/</guid>
      <description>&lt;h1 id=&#34;-é€€ä¼‘é‡‘æ¢³ç†-101&#34;&gt;ğŸš€ é€€ä¼‘é‡‘æ¢³ç† 101&lt;/h1&gt;
&lt;hr&gt;
&lt;h2 id=&#34;401k-ira-pre-tax-after-tax-æ‰«ç›²&#34;&gt;401(k), IRA, pre-tax, after-tax æ‰«ç›²&lt;/h2&gt;
&lt;h3 id=&#34;-æŒ‰ç…§è´¦æˆ·ç±»å‹401k-vs-ira&#34;&gt;ğŸ“Œ æŒ‰ç…§è´¦æˆ·ç±»å‹ï¼š401(k) vs. IRA&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;401(k) (Employer-Sponsored Plan)&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å…¬å¸æä¾›çš„ï¼Œå…¬å¸æœ‰çš„æ—¶å€™ä¼šæä¾› matchã€‚&lt;/li&gt;
&lt;li&gt;æŠ•èµ„é€‰æ‹©æ¯”è¾ƒå°‘ã€‚&lt;/li&gt;
&lt;li&gt;æœ‰ç®¡ç†è´¹ã€‚&lt;/li&gt;
&lt;li&gt;RMD ï¼ˆRequired Minimum Distributionï¼‰72 å²ä»¥åè¦å–é’±ã€‚&lt;/li&gt;
&lt;li&gt;59.5 å²å–é’±æ‰ä¸ä¼šæœ‰ç½šé‡‘ã€‚&lt;/li&gt;
&lt;li&gt;Possible administration fees from the employer.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;IRA (Individual Retirement Account)&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸ªäººå¼€æˆ·ï¼Œä¸éœ€è¦å…¬å¸æä¾›ã€‚&lt;/li&gt;
&lt;li&gt;æŠ•èµ„é€‰æ‹©å¤šæ ·ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Roth IRA æ²¡æœ‰ RMDs&lt;/strong&gt;, but &lt;strong&gt;Traditional IRA æœ‰&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;æ²¡æœ‰ç®¡ç†è´¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;-æŒ‰ç…§æŠ•å…¥æ–¹å¼ç¨å‰-vs-ç¨å&#34;&gt;ğŸ”¹ æŒ‰ç…§æŠ•å…¥æ–¹å¼ï¼šç¨å‰ VS ç¨å&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Pre-Tax&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¨å‰æŠ•å…¥ï¼Œå¯ä»¥é™ä½ tax bracketã€‚&lt;/li&gt;
&lt;li&gt;å–å‡ºçš„æ—¶å€™äº¤ç¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;After-Tax&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¨åæŠ•å…¥ï¼Œä¸èƒ½é™ä½ tax bracketã€‚&lt;/li&gt;
&lt;li&gt;æ²¡æœ‰èµ„æœ¬åˆ©å¾—ç¨ã€‚&lt;/li&gt;
&lt;li&gt;å–å‡ºçš„æ—¶å€™ä¸ç”¨äº¤ç¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;ç¨æ”¶æ€»ç»“&#34;&gt;ç¨æ”¶æ€»ç»“&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;When do you pay tax&lt;/th&gt;
&lt;th&gt;Contribution&lt;/th&gt;
&lt;th&gt;Growth&lt;/th&gt;
&lt;th&gt;Withdrawal (Subject to income tax)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Traditional (Pre-Tax)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;No&lt;/td&gt;
&lt;td&gt;No&lt;/td&gt;
&lt;td&gt;Yes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Roth (After-Tax)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Yes&lt;/td&gt;
&lt;td&gt;No&lt;/td&gt;
&lt;td&gt;No&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;After-Tax Backdoors&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Yes&lt;/td&gt;
&lt;td&gt;No&lt;/td&gt;
&lt;td&gt;Yes&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;-å¦‚ä½•æŠŠé’±æ”¾è¿›å»å‡è®¾ä½ æ˜¯ä¸€ä¸ªå…¬å¸é›‡å‘˜&#34;&gt;ğŸš€ å¦‚ä½•æŠŠé’±æ”¾è¿›å»ï¼ˆå‡è®¾ä½ æ˜¯ä¸€ä¸ªå…¬å¸é›‡å‘˜ï¼‰&lt;/h2&gt;
&lt;h3 id=&#34;-å…¬å¸ç›¸å…³&#34;&gt;ğŸ“Œ å…¬å¸ç›¸å…³&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Employee contribution (22500)&lt;/li&gt;
&lt;li&gt;Employer matching&lt;/li&gt;
&lt;li&gt;mega backdoor&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;1 + 2 + 3 &amp;lt;= 66000&lt;/p&gt;
&lt;h3 id=&#34;-ä¸ªäººè¡Œä¸º&#34;&gt;ğŸ“Œ ä¸ªäººè¡Œä¸º&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;step1ï¼Œ å¼€ä¸€ä¸ª traditional IRAï¼Œroth IRA&lt;/li&gt;
&lt;li&gt;step2ï¼Œä¸ªäººé“¶è¡Œ 6500 è½¬åˆ° traditional IRA&lt;/li&gt;
&lt;li&gt;step3ï¼Œsettle ä»¥åç«‹åˆ»è½¬ Roth IRA&lt;/li&gt;
&lt;li&gt;step4ï¼ŒFile 8606&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;-å¦‚ä½•é€‰æ‹©&#34;&gt;ğŸ’¡ å¦‚ä½•é€‰æ‹©&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;pre-tax or after-taxï¼Ÿå–å†³äºä½ å°†æ¥çš„æ”¶å…¥ä¼šä¸ä¼šæ¯”ç°åœ¨é«˜ï¼Ÿ&lt;/li&gt;
&lt;li&gt;401(k) or IRAï¼Ÿä½ çš„æŠ•èµ„æ°´å¹³èƒ½ä¸èƒ½èµ¢è·‘èµ¢å¤§ç›˜ï¼Ÿ&lt;/li&gt;
&lt;li&gt;rolloverï¼ŒåŸºæœ¬æ¥è¯´ pre-tax èƒ½æ¢ after-taxï¼Œ401k èƒ½æ¢ IRA&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;é™„å½•from-chatgpt&#34;&gt;é™„å½•ï¼Œfrom chatgpt&lt;/h2&gt;
&lt;hr&gt;
&lt;h2 id=&#34;-comparing-401k-and-ira-pre-tax-vs-after-tax&#34;&gt;ğŸ”¹ Comparing 401(k) and IRA: Pre-Tax vs. After-Tax&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Feature&lt;/th&gt;
&lt;th&gt;401(k) (Pre-Tax)&lt;/th&gt;
&lt;th&gt;401(k) (After-Tax)&lt;/th&gt;
&lt;th&gt;401(k) (Roth)&lt;/th&gt;
&lt;th&gt;IRA (Pre-Tax)&lt;/th&gt;
&lt;th&gt;IRA (After-Tax)&lt;/th&gt;
&lt;th&gt;IRA (Roth)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Contributions&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Pre-tax&lt;/td&gt;
&lt;td&gt;After-tax&lt;/td&gt;
&lt;td&gt;After-tax&lt;/td&gt;
&lt;td&gt;Pre-tax&lt;/td&gt;
&lt;td&gt;After-tax&lt;/td&gt;
&lt;td&gt;After-tax&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Tax Benefit&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Reduces taxable income now&lt;/td&gt;
&lt;td&gt;No immediate tax benefit&lt;/td&gt;
&lt;td&gt;No immediate tax benefit&lt;/td&gt;
&lt;td&gt;Reduces taxable income&lt;/td&gt;
&lt;td&gt;No immediate tax benefit&lt;/td&gt;
&lt;td&gt;No immediate tax benefit&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Growth&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Tax-deferred&lt;/td&gt;
&lt;td&gt;Tax-deferred&lt;/td&gt;
&lt;td&gt;Tax-free&lt;/td&gt;
&lt;td&gt;Tax-deferred&lt;/td&gt;
&lt;td&gt;Tax-deferred&lt;/td&gt;
&lt;td&gt;Tax-free&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Withdrawals&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Taxed at retirement&lt;/td&gt;
&lt;td&gt;Taxed at retirement&lt;/td&gt;
&lt;td&gt;Tax-free&lt;/td&gt;
&lt;td&gt;Taxed at retirement&lt;/td&gt;
&lt;td&gt;Taxed at retirement&lt;/td&gt;
&lt;td&gt;Tax-free&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Employer Match&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… Yes&lt;/td&gt;
&lt;td&gt;âœ… Yes&lt;/td&gt;
&lt;td&gt;âœ… Yes&lt;/td&gt;
&lt;td&gt;âŒ No&lt;/td&gt;
&lt;td&gt;âŒ No&lt;/td&gt;
&lt;td&gt;âŒ No&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Investment Options&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Limited (Employer chooses)&lt;/td&gt;
&lt;td&gt;Limited (Employer chooses)&lt;/td&gt;
&lt;td&gt;Limited (Employer chooses)&lt;/td&gt;
&lt;td&gt;Almost unlimited&lt;/td&gt;
&lt;td&gt;Almost unlimited&lt;/td&gt;
&lt;td&gt;Almost unlimited&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;RMD (Required Minimum Distributions)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… Yes&lt;/td&gt;
&lt;td&gt;âœ… Yes&lt;/td&gt;
&lt;td&gt;âœ… Yes (Can roll into Roth IRA to avoid)&lt;/td&gt;
&lt;td&gt;âœ… Yes&lt;/td&gt;
&lt;td&gt;âœ… Yes&lt;/td&gt;
&lt;td&gt;âŒ No&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Administration Fees&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;âœ… Yes (Employer fees)&lt;/td&gt;
&lt;td&gt;âœ… Yes (Employer fees)&lt;/td&gt;
&lt;td&gt;âœ… Yes (Employer fees)&lt;/td&gt;
&lt;td&gt;âŒ No&lt;/td&gt;
&lt;td&gt;âŒ No&lt;/td&gt;
&lt;td&gt;âŒ No&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h2 id=&#34;-explanation&#34;&gt;ğŸ”¹ Explanation&lt;/h2&gt;
&lt;h3 id=&#34;-pre-tax-accounts-traditional-401k--ira&#34;&gt;ğŸ”· &lt;strong&gt;Pre-Tax Accounts (Traditional 401(k) &amp;amp; IRA)&lt;/strong&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Contributions are &lt;strong&gt;before-tax&lt;/strong&gt; (reduce taxable income now).&lt;/li&gt;
&lt;li&gt;Growth is &lt;strong&gt;tax-deferred&lt;/strong&gt; (you donâ€™t pay taxes until withdrawal).&lt;/li&gt;
&lt;li&gt;Withdrawals are &lt;strong&gt;fully taxable in retirement&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;RMDs apply&lt;/strong&gt; at age 73.&lt;/li&gt;
&lt;li&gt;Ideal for those who expect to be in a &lt;strong&gt;lower tax bracket in retirement&lt;/strong&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;-after-tax-non-roth-401k--ira&#34;&gt;ğŸ”· &lt;strong&gt;After-Tax (Non-Roth) 401(k) &amp;amp; IRA&lt;/strong&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Contributions are &lt;strong&gt;after-tax&lt;/strong&gt; (no immediate tax deduction).&lt;/li&gt;
&lt;li&gt;Growth is &lt;strong&gt;tax-deferred&lt;/strong&gt;, but &lt;strong&gt;earnings are taxed upon withdrawal&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;Withdrawals are &lt;strong&gt;partially taxable&lt;/strong&gt; (contributions tax-free, but earnings taxed).&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;RMDs apply&lt;/strong&gt; at age 73.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Can be used for the Mega Backdoor Roth strategy!&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;-roth-accounts-roth-401k--roth-ira&#34;&gt;ğŸ”· &lt;strong&gt;Roth Accounts (Roth 401(k) &amp;amp; Roth IRA)&lt;/strong&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Contributions are &lt;strong&gt;after-tax&lt;/strong&gt; (no upfront tax benefit).&lt;/li&gt;
&lt;li&gt;Growth is &lt;strong&gt;completely tax-free&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Qualified withdrawals are tax-free in retirement&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;RMDs apply to Roth 401(k)&lt;/strong&gt;, but you can &lt;strong&gt;roll it into a Roth IRA to avoid RMDs&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;No RMDs for Roth IRA!&lt;/strong&gt; Funds can grow tax-free indefinitely.&lt;/li&gt;
&lt;li&gt;Best for those who expect to be in a &lt;strong&gt;higher tax bracket in retirement&lt;/strong&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;-mega-backdoor-roth-strategy&#34;&gt;ğŸ”¥ &lt;strong&gt;Mega Backdoor Roth Strategy&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;ğŸ’¡ The &lt;strong&gt;Mega Backdoor Roth&lt;/strong&gt; is an advanced retirement savings strategy that allows high earners to &lt;strong&gt;move after-tax 401(k) contributions into a Roth IRA or Roth 401(k)&lt;/strong&gt;, unlocking tax-free growth.&lt;/p&gt;
&lt;h3 id=&#34;-how-it-works&#34;&gt;âœ… &lt;strong&gt;How It Works:&lt;/strong&gt;&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Max out regular 401(k) contributions&lt;/strong&gt; ($23,000 in 2024, $30,500 if 50+).&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Make additional after-tax contributions&lt;/strong&gt; (if your plan allows).&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Immediately convert after-tax contributions into a Roth IRA or Roth 401(k)&lt;/strong&gt; (before earnings accumulate and become taxable).&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Enjoy tax-free growth and withdrawals in retirement!&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;-why-use-the-mega-backdoor-roth&#34;&gt;ğŸ”· &lt;strong&gt;Why Use the Mega Backdoor Roth?&lt;/strong&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Allows &lt;strong&gt;higher Roth contributions beyond standard limits&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;Helps &lt;strong&gt;high earners&lt;/strong&gt; build tax-free retirement income.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Avoids RMDs&lt;/strong&gt; if rolled into a Roth IRA.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;Not all employer 401(k) plans allow after-tax contributions or in-plan Roth conversions.&lt;/strong&gt; Check your planâ€™s rules!&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;-retirement-tax-hack-choosing-the-right-plan&#34;&gt;ğŸš€ Retirement Tax Hack: Choosing the Right Plan&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;If you&amp;rsquo;re in a &lt;strong&gt;high tax bracket now&lt;/strong&gt;, a &lt;strong&gt;Traditional 401(k) or IRA&lt;/strong&gt; can reduce taxable income.&lt;/li&gt;
&lt;li&gt;If you expect to be in a &lt;strong&gt;higher tax bracket later&lt;/strong&gt;, a &lt;strong&gt;Roth 401(k) or Roth IRA&lt;/strong&gt; helps avoid future taxes.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Max out employer 401(k) matching first&lt;/strong&gt; before investing in IRAs.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Diversify&lt;/strong&gt;: Having both &lt;strong&gt;pre-tax and after-tax&lt;/strong&gt; accounts gives flexibility in retirement withdrawals.&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;-final-thoughts&#34;&gt;ğŸ“¢ Final Thoughts&lt;/h2&gt;
&lt;p&gt;Understanding &lt;strong&gt;401(k), Roth, and IRA&lt;/strong&gt; options helps you make &lt;strong&gt;tax-smart decisions&lt;/strong&gt; for retirement. The key is to balance &lt;strong&gt;pre-tax and after-tax&lt;/strong&gt; contributions based on your income, expected tax rates, and long-term financial goals.&lt;/p&gt;
&lt;p&gt;ğŸš€ &lt;strong&gt;Start investing now! Your future self will thank you.&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;reference&#34;&gt;reference:&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://youtu.be/7Ssh24wzaMI&#34;&gt;https://youtu.be/7Ssh24wzaMI&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ä»å¤§å­¦ç”µè·¯è¯¾ç¨‹åˆ°äººç”Ÿæ—…é€”</title>
      <link>http://localhost:1313/post/2025-03-01-%E4%BB%8E%E5%A4%A7%E5%AD%A6%E7%94%B5%E8%B7%AF%E8%AF%BE%E7%A8%8B%E5%88%B0%E4%BA%BA%E7%94%9F%E6%97%85%E9%80%94%E7%9A%84%E6%80%9D%E8%80%83/</link>
      <pubDate>Sat, 01 Mar 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-03-01-%E4%BB%8E%E5%A4%A7%E5%AD%A6%E7%94%B5%E8%B7%AF%E8%AF%BE%E7%A8%8B%E5%88%B0%E4%BA%BA%E7%94%9F%E6%97%85%E9%80%94%E7%9A%84%E6%80%9D%E8%80%83/</guid>
      <description>&lt;p&gt;çœ‹äº† 3 æœˆåº•å»åœ£åœ°äºšå“¥çš„æœºç¥¨ï¼Œæ´—æ¾¡æ—¶å¿½ç„¶æƒ³èµ·è‡ªå·±æ›¾åœ¨ UCSD å­¦ä¹ ç”Ÿæ´»çš„ç‚¹ç‚¹æ»´æ»´ã€‚ç¡å‰éšæ‰‹å†™å‡ å¥ã€‚&lt;/p&gt;
&lt;p&gt;è®°å¾—æœ‰ä¸€é—¨ç”µè·¯è¯¾ç¨‹ï¼Œæ¦‚å¿µæœ¬èº«å¹¶ä¸ç®—éš¾ç†è§£ï¼Œä½†æƒ³åœ¨è€ƒè¯•ä¸­æ‹¿é«˜åˆ†å´å¼‚å¸¸è‰°éš¾ã€‚å­¦ä¹ çš„è¿‡ç¨‹åƒæ˜¯å±‚å±‚é€’è¿›çš„è€ƒéªŒï¼šå…ˆæ˜¯ä¸€ç‚¹ä¸€ç‚¹åœ°ç†è§£çŸ¥è¯†ç‚¹ï¼Œç†è§£ä¹‹åå†é€æ¡ç†Ÿæ‚‰å…¬å¼ï¼Œç†Ÿæ‚‰å®Œå…¬å¼åè¿˜è¦ä¸€é¢˜ä¸€é¢˜åœ°ç»ƒä¹ ã€‚ç»ƒä¹ è¿‡ç¨‹ä¸­ï¼Œéœ€è¦é€ä¸ªå‡½æ•°å»åˆ†æï¼Œé€ä¸ªå˜é‡å»æ±‚è§£ã€‚å³ä½¿æŠŠæ‰€æœ‰çš„å‡†å¤‡å·¥ä½œåšåˆ°æè‡´ï¼Œè€ƒè¯•æ—¶åªè¦æœ‰é‚£ä¹ˆä¸€ç¬é—´å¤§è„‘çŸ­è·¯ï¼Œä¸€ä¸ªå˜é‡ç®—é”™ï¼Œæ•´é“é¢˜ç›®çš„ç­”æ¡ˆå°±å¯èƒ½å…¨ç›˜çš†è¾“ï¼Œåˆ†æ•°è¢«æ‰£ä¸ªç²¾å…‰ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚ä»Šï¼Œé‚£é—¨è¯¾çš„å†…å®¹æˆ‘å·²ç»å‡ ä¹å¿˜å¾—ä¸€å¹²äºŒå‡€ï¼Œæƒ³æƒ³å€’ä¹Ÿæœ‰äº›å¯æƒœâ€”â€”å­¦äº†é‚£ä¹ˆå¤šçŸ¥è¯†ï¼Œæœ€ååœ¨ç”Ÿæ´»å’Œå·¥ä½œä¸­å´æ²¡æ€ä¹ˆç”¨ä¸Šã€‚ä½†å›å¤´çœ‹ï¼Œé‚£ä¸ªä¸æ–­ç»ƒä¹ ã€ç²¾è¿›çš„è¿‡ç¨‹ï¼Œä¼¼ä¹å’Œæˆ‘ç°åœ¨ä¸“æ³¨çš„äº‹æƒ…æœ‰äº›ç›¸ä¼¼ã€‚&lt;/p&gt;
&lt;p&gt;æœ€è¿‘åœ¨å¥èº«å’Œæ‰“ Pokerï¼ŒäºŒè€…çš„è®­ç»ƒæ–¹å¼ç«Ÿç„¶å¦‚å‡ºä¸€è¾™ã€‚å¥èº«éœ€è¦ä¸€ä¸ªåŠ¨ä½œä¸€ä¸ªåŠ¨ä½œåœ°åšï¼Œä¸€å£ä¸€å£åœ°åƒï¼Œä½†åªè¦é‡åˆ°ä¸€æ¬¡æ„å¤–å—ä¼¤ï¼Œæˆ–è€…çªå¦‚å…¶æ¥çš„ç”Ÿç—…ï¼Œè‚Œè‚‰å°±ä¼šè¿…é€Ÿæµå¤±ã€‚Poker äº¦æ˜¯å¦‚æ­¤ï¼Œæ¯ä¸€æ¡è¡—éƒ½éœ€è¦ä»”ç»†æ€è€ƒï¼Œæ¯ä¸€ä¸ªåº•æ± éƒ½å¯èƒ½æ˜¯å¿ƒç†ä¸æŠ€å·§çš„åšå¼ˆï¼Œä½†åªè¦é‡ä¸Šä¸€æ‰‹ Coolerï¼Œæ•´ä¸ª Session å¯èƒ½å°±ä¼šç¬é—´å´©ç›˜ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨æµè¡Œä¸€å¥è¯ï¼šâ€œäººç”Ÿæ˜¯ä¸€åœºæ—…é€”ã€‚â€ è¿™è¯ç¡®å®æœ‰é“ç†ï¼Œä½†æˆ‘çš„ç†è§£æ˜¯ï¼Œæ¯ä¸ªäººçš„æ—…é€”å¤©å·®åœ°åˆ«ï¼Œç”šè‡³æ˜¯äº‘æ³¥ä¹‹åˆ«ã€‚ç‰©è´¨å†³å®šæ„è¯†ï¼Œä¸åŒçš„èµ·ç‚¹å’Œç»å†ï¼Œä¹Ÿå†³å®šäº†äººä¸äººå¯¹ç”Ÿæ´»çš„æ„Ÿæ‚Ÿã€‚æœ‰äº›äººçš„æ—…é€”æ˜¯åœ¨é£æœºçš„å¤´ç­‰èˆ±é‡Œï¼Œçª—å¤–æ˜¯äº‘æµ·ä¸æå…‰ï¼›æœ‰äº›äººçš„æ—…é€”æ˜¯åœ¨è½°éš†ä½œå“çš„ç»¿çš®ç«è½¦ä¸Šï¼Œåƒç€æ³¡é¢å’Œè‚‰è‚ ï¼›è€Œæœ‰äº›äººçš„æ—…é€”ï¼Œåˆ™æ˜¯ç˜¸ç€è…¿è¡Œèµ°åœ¨ä¼¸æ‰‹ä¸è§äº”æŒ‡çš„æ´ç©´é‡Œï¼Œçœ‹ä¸åˆ°ä¸€ç‚¹å…‰ã€‚&lt;/p&gt;
&lt;p&gt;å›å¤´çœ‹ï¼Œç”µè·¯è¯¾ç¨‹ã€å¥èº«ã€Poker ä¼¼ä¹æˆäº†æˆ‘æœ¬äººç‰¹æ®Šçš„äººç”Ÿæ—…é€”ç¼©å½±ã€‚æˆ‘æ‰€æœ‰çš„æˆå°±éƒ½éœ€è¦ä¸€ç‚¹ä¸€æ»´çš„ç§¯ç´¯ï¼Œgraduallyï¼Œä½†æˆ‘æ‰€ç»å†çš„å›°éš¾å’ŒæŒ«æŠ˜ï¼Œå´æ€»æ˜¯çªå¦‚å…¶æ¥ï¼Œabruptlyã€‚æ‰€ä»¥ï¼Œæˆ‘å¯¹äººç”Ÿçš„æ„Ÿæ‚Ÿæ˜¯ï¼šå»ºé€ ä¸€æ ‹å¤§æ¥¼éœ€è¦ä¸€ç –ä¸€ç“¦ï¼Œä½†ä¸€åœºåœ°éœ‡ï¼Œå°±è¶³ä»¥è®©å®ƒè½°ç„¶å€’å¡Œã€‚å¯å³ä¾¿åœ°éœ‡æ‘§æ¯äº†ä¸€åˆ‡ï¼Œæˆ‘ä»¬ä»ç„¶è¦é‡æ–°å»ºé€ å¤§æ¥¼ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘èƒ½ç†è§£ä¸ºä»€ä¹ˆé‚£ä¹ˆå¤šäººæ¸´æœ›ä¸€å¤œæš´å¯Œï¼Œä¸€å¤œæˆåã€‚æˆ–è®¸ï¼Œä»–ä»¬å’Œæˆ‘ä¸€æ ·ï¼Œéš¾ä»¥æ¥å—è¿™ç§ä¸å¯¹ç­‰â€”â€”ä¸ºä»€ä¹ˆæ‰€æœ‰çš„æ„å¤–å’Œç¾éš¾æ€»æ˜¯çªå¦‚å…¶æ¥ï¼Œè€Œæ‰€æœ‰çš„æˆå°±éƒ½éœ€è¦é•¿æœŸç§¯ç´¯ï¼Ÿä¸ºä»€ä¹ˆä¸èƒ½åè¿‡æ¥ï¼Œè®©æˆåŠŸè½»è€Œæ˜“ä¸¾ï¼Œè€Œå›°éš¾å˜å¾—ç¼“æ…¢ä¸”å¯æ§ï¼Ÿå½“ç„¶ï¼Œç°å®é‡Œç¡®å®æœ‰äº›äººçš„äººç”Ÿæ˜“å¦‚åæŒï¼Œæˆå°±æ˜¯å¤©é™æ¨ªè´¢ï¼Œä»¿ä½›è€å¤©çˆ·ç‰¹æ„èµé¥­åƒã€‚æˆ‘å¾ˆå¥½å¥‡ï¼Œè¿™æ ·çš„äººåˆä¼šå¦‚ä½•çœ‹å¾…äººç”Ÿï¼Ÿå¦‚æœæœ‰æœºä¼šï¼ŒçœŸæƒ³è®¤è¯†ä»–ä»¬ï¼Œå¬å¬ä»–ä»¬çš„æ„Ÿæ‚Ÿã€‚&lt;/p&gt;
&lt;p&gt;æƒ³æƒ³æˆ‘çš„å‡ºç”Ÿæ¡ä»¶ï¼Œå…¶å®å·²ç»ç®—å¾—ä¸Šå¹¸è¿ï¼Œå®¶åº­éå¸¸å¥½ï¼Œéå¸¸å¥½å®¶åº­ï¼Œæˆ‘æ²¡ä»€ä¹ˆå¯æŠ±æ€¨çš„ã€‚å°½ç®¡æˆ‘ä¹Ÿé‡åˆ°è¿‡è®¸å¤šå›°éš¾â€¦â€¦ç­‰ç­‰ï¼Œæˆ‘æ€ä¹ˆäº†ï¼Ÿå·²ç»æ‡¦å¼±åˆ°ä¸æ•¢å†™ä¸‹â€œè™½ç„¶é‡åˆ°å¾ˆå¤§å›°éš¾ï¼Œä¹Ÿèƒ½ç§¯æé¢å¯¹â€äº†å—ï¼Ÿæ˜¯çš„ï¼Œæœ‰æ—¶å€™ï¼Œå›°éš¾ç¡®å®å¤ªå¤§äº†ï¼Œè®©äººæ— æ³•è½»æ˜“ä¿æŒä¹è§‚ã€‚è€Œä¸”ï¼Œæˆ‘çš„èƒ½åŠ›æœ‰é™ï¼Œäººç±»çš„èƒ½åŠ›æœ‰é™ï¼Œå¾ˆå¤šäº‹æƒ…çš„è§£å†³å¹¶ä¸æŒæ¡åœ¨æˆ‘ä»¬æ‰‹ä¸­ã€‚åªèƒ½è¯´ï¼Œæœ‰äº›äº‹ç»ˆå½’æ˜¯å‘½ï¼Œè¿˜æ˜¯å¾—ç­‰è€å¤©çˆ·èµé¥­åƒã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä¸æƒ³å†™æ— èŠçš„é¸¡æ±¤ï¼Œåªæ˜¯æƒ³è°ˆè°ˆä¸åŒäººé¢å¯¹å›°éš¾çš„æ–¹å¼ã€‚æˆ–è®¸äººä¸äººä¹‹é—´çš„é‚£ä¸€ç‚¹ç‚¹ä¼˜åŠ¿ï¼Œå°±ä½“ç°åœ¨é¢å¯¹æŒ‘æˆ˜æ—¶çš„æ€åº¦ï¼šé«˜æœºèƒ½çš„äººèƒ½ä¹è§‚åœ°é¢å¯¹ï¼Œå¹¶å†·é™åœ°æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘åªæ˜¯ä¸ªæ™®é€šäººï¼Œä½†æˆ‘ä¹Ÿæœ‰ä¸€ä¸ªæ¢¦æƒ³ï¼Œæˆ‘æƒ³ä¿æŠ¤å¥½å®ƒã€‚å½“ç„¶ï¼Œæˆ‘ä¹Ÿæ˜¯ä¸ªå®Œç¾ä¸»ä¹‰è€…ï¼Œä»·å€¼è§‚ä¹Ÿå¸¦ç€å±€é™æ€§ã€‚æ‰€ä»¥ï¼Œæˆ‘å¯¹è‡ªå·±çš„æœªæ¥æœ‰ä¸¤ç§å¯èƒ½çš„æ¨æµ‹ï¼šè¦ä¹ˆæˆ‘æ”¹å˜äº†ä»·å€¼è§‚ï¼Œè°ƒæ•´äº†æ¢¦æƒ³ï¼›è¦ä¹ˆæˆ‘å…‹æœäº†å›°éš¾ï¼Œæˆäº†æ›´æˆç†Ÿçš„äººã€‚æ— è®ºæ˜¯å“ªä¸€ç§ï¼Œæˆ‘éƒ½æœŸå¾…ç€å®ƒçš„åˆ°æ¥ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Become a Winning Online Poker Player in 30 Days - Week 4</title>
      <link>http://localhost:1313/post/2025-02-16-cards-chat-week4/</link>
      <pubDate>Sun, 16 Feb 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-02-16-cards-chat-week4/</guid>
      <description>&lt;h2 id=&#34;day-22---unpredictable-play-the-strategy-in-reraising-57s&#34;&gt;Day 22 - Unpredictable Play (The Strategy in Reraising 57s)&lt;/h2&gt;
&lt;h3 id=&#34;why-play-unpredictably&#34;&gt;Why Play Unpredictably?&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Prevent Goodd Players from taking advantage of predictable tendencies&lt;/li&gt;
&lt;li&gt;Makes you tougher to play against&lt;/li&gt;
&lt;li&gt;Exploitive Play: How do I play the best against this specific opponent?&lt;/li&gt;
&lt;li&gt;GTO: What is the best overall strategy to have?&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;blockers-definition&#34;&gt;Blockers Definition&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Cards you hold that are significant only because it means your opponent cannot be holding onto them.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;light-3-betting&#34;&gt;Light 3-betting&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Target players capable of folding to aggression&lt;/li&gt;
&lt;li&gt;Pick hands you can easily fold to 4-bet that play well postflop or have blockers&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;bonus-gto&#34;&gt;Bonus GTO&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Bluff the river if you are at the bottom of your range.&lt;/li&gt;
&lt;li&gt;Bluff catch the river if you are at the top of your range. - If fold, what to call?&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;day-23---heads-up-the-perfect-excuse-to-play-every-hands&#34;&gt;Day 23 - Heads Up (The Perfect Excuse to play every hands)&lt;/h2&gt;
&lt;h3 id=&#34;short-handed-adjustments&#34;&gt;Short-Handed Adjustments&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Play same hands from 3-max to full ring, all else equal.&lt;/li&gt;
&lt;li&gt;Any leaks get dramatically magnified when switching table sizes.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;heads-up-button-strategy&#34;&gt;Heads-Up Button Strategy&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Raise every hands besides junk&lt;/li&gt;
&lt;li&gt;Attack your opponent post-flop with multi-street bluffs and thin value bets&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;heads-up-big-blind-strategy&#34;&gt;Heads-up Big Blind Strategy&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Jam wide over raises with 20bb or less effective stack.&lt;/li&gt;
&lt;li&gt;Defend pre-flop with a wide range and call your opponent down stubbornly.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;sample-shoving-ranges&#34;&gt;Sample Shoving Ranges&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Button with 10bb: 22, K2, Q6, Q2s, J7, J2s, T7, T4s, 97, 94s, 87, 84s, 74s&lt;/li&gt;
&lt;li&gt;Big Blind with 20bb: 22, A2, K5, K2s, Q8, Q2s, J9, J5s, T8, T6s, 98, 95s&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;day-24---mentality-the-single-most-important-non-playing-skill&#34;&gt;Day 24 - Mentality (The single most important non-playing skill)&lt;/h2&gt;
&lt;h3 id=&#34;game-grade&#34;&gt;Game Grade&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;A-Game: The best you can play&lt;/li&gt;
&lt;li&gt;B-Game: Play well but making some mistakes&lt;/li&gt;
&lt;li&gt;C-Game: Making Clear mistakes relative t o your best possible games&lt;/li&gt;
&lt;li&gt;Less skilled player can win more than top-player if constant A-Game&lt;/li&gt;
&lt;li&gt;Relastic Goal: A-game vast majority of the time and occasional B-Game&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;key-mental-game-concept&#34;&gt;Key Mental Game Concept&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Verbalize your thoughts process.&lt;/li&gt;
&lt;li&gt;Play Tighter.&lt;/li&gt;
&lt;li&gt;End the session.&lt;/li&gt;
&lt;li&gt;Take a break.&lt;/li&gt;
&lt;li&gt;Study and Regroup.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;mike-caros-genie&#34;&gt;Mike Caro&amp;rsquo;s Genie&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Genie: Win 10k more in up session or lose $10k less in down session?&lt;/li&gt;
&lt;li&gt;Limiting loss is just as good as increasing wins.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;day-25---more-icm-generating-pre-flop-ranges&#34;&gt;Day 25 - More ICM (Generating Pre-Flop Ranges)&lt;/h2&gt;
&lt;h3 id=&#34;software-to-generate-ranges&#34;&gt;Software to Generate Ranges&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Open-Shove and calling ranges are free at Holdem Resources&lt;/li&gt;
&lt;li&gt;Ranges involving raise&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;two-important-rules&#34;&gt;Two important rules&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;15bb effective stack in small blind, non-junk hand.&lt;/li&gt;
&lt;li&gt;Profitable (or at least close) to shove magic range if playing shove-fold.&lt;/li&gt;
&lt;li&gt;Don&amp;rsquo;t worry about memorizing exact ranges.&lt;/li&gt;
&lt;li&gt;Call in big blind facing an all-in with better than 2:1 pot odds.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;factors-impacting-ranges&#34;&gt;Factors impacting ranges&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Payout Structure&lt;/li&gt;
&lt;li&gt;Stacks and Players Remaining&lt;/li&gt;
&lt;li&gt;Opponent Reads&lt;/li&gt;
&lt;li&gt;Ante Size&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;an-important-calling-range&#34;&gt;An important Calling Range&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;We are big blind and button shoves 10bb&lt;/li&gt;
&lt;li&gt;Our Calling Range: 22, A2, K4s, K7o, Q8s, Q9o, J9s, JTo&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;day-26-defending-the-big-blinds-how-to-play-pokers-trickiest-position&#34;&gt;Day 26: Defending the Big Blinds (How to play poker&amp;rsquo;s trickiest position)&lt;/h2&gt;
&lt;h3 id=&#34;defense-range-factor&#34;&gt;Defense Range Factor&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Raise Size&lt;/li&gt;
&lt;li&gt;Position of Raiser&lt;/li&gt;
&lt;li&gt;State of Tournament&lt;/li&gt;
&lt;li&gt;Ante&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;pre-flop-action&#34;&gt;Pre-Flop Action&lt;/h3&gt;
&lt;h4 id=&#34;3-bet-hands&#34;&gt;3-bet hands&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;99+, AQo, AJs and occasional 53s, 63s, 84s, 73s.&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;3-bet-shove&#34;&gt;3-bet shove&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;Shove if effective stack under 25bb&lt;/li&gt;
&lt;li&gt;Shove if facing multiple raises with 20% of the effective stack in the middle.&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;3-bet-small&#34;&gt;3-bet small&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;Usually better to defend by calling because we&amp;rsquo;re out of position.&lt;/li&gt;
&lt;li&gt;Good move to apply tournament pressure against a mid stack.&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;attack-small-blind-limps&#34;&gt;Attack Small Blind Limps&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;Raise most good/playable hands when the small blind limps.&lt;/li&gt;
&lt;li&gt;Shove with a very wide range if the effective stack is 15bb or less.&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;post-flop-action&#34;&gt;Post Flop Action&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Remember to plan your hands early, such as calling down with top pair&lt;/li&gt;
&lt;li&gt;If you&amp;rsquo;ve missed the flop: Default play is to check-fold.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;day-27---check-raising-vital-weapon-for-playing-without-position&#34;&gt;Day 27 - Check-Raising (Vital Weapon for Playing without Position)&lt;/h2&gt;
&lt;h3 id=&#34;why-check-raise&#34;&gt;Why Check-Raise&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Makes you unpredictable and difficult to play against.&lt;/li&gt;
&lt;li&gt;Lets youw in more against a likely c-bettor with both made hands and draw hands.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;key-factors-for-effective-check-raising&#34;&gt;Key Factors for Effective Check-Raising&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Board is coordinated.&lt;/li&gt;
&lt;li&gt;Hero has either a strong made hand or a draw with little showdown value.&lt;/li&gt;
&lt;li&gt;Villain likely to bet, otherwise there is no check-raise happening.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;bonus-check-raising-spot&#34;&gt;Bonus Check-Raising Spot&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Hero has a draw.&lt;/li&gt;
&lt;li&gt;Villain will often not bet if we check, but in the words of the mowglis: I&amp;rsquo;m good. I&amp;rsquo;m good. I&amp;rsquo;m good.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;important-spot-to-check-call-instead&#34;&gt;Important Spot to check-Call Instead.&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;We have decent showdown value but don&amp;rsquo;t want to play a large pot.&lt;/li&gt;
&lt;li&gt;Applies with draws or made hands.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;and-lastly&#34;&gt;And Lastly&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Check-Fold if you don&amp;rsquo;t have the betting leads and miss the flop entirely.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;day-28---risk-aversion-it-depends-on-the-state-of-the-tournament&#34;&gt;Day 28 - Risk Aversion (It depends on the state of the tournament)&lt;/h2&gt;
&lt;h3 id=&#34;tournament-state-1-normal&#34;&gt;Tournament State 1: Normal&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Play similar to a cash game.&lt;/li&gt;
&lt;li&gt;Occurs in MTT or MTTSNG in the early stages.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;tournament-state-2-some-risk-aversion&#34;&gt;Tournament state 2: Some Risk Aversion&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;ICM is important but most decisions aren&amp;rsquo;t heavily impacted yet.&lt;/li&gt;
&lt;li&gt;Start of a 9-man SNG or final tables of a 45-man.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;tournament-state-3-extreme-risk-aversion&#34;&gt;Tournament State 3: Extreme Risk Aversion&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;ICM influences most or all decisions.&lt;/li&gt;
&lt;li&gt;Bubble of a 9-man or final table of an MTT.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;playing-the-short-stack&#34;&gt;Playing the Short Stack&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;The short stack is the least affected.&lt;/li&gt;
&lt;li&gt;Play similarly to your normal game with tighter calling.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;playing-the-mid-stack&#34;&gt;Playing the mid stack&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Extreme gap between calling and shoving.&lt;/li&gt;
&lt;li&gt;Need a very large edge to call it off.&lt;/li&gt;
&lt;li&gt;Must play tighter.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;playing-the-big-stack&#34;&gt;Playing the big stack&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Play looser and more aggressive.&lt;/li&gt;
&lt;li&gt;Incredibly profitable to pressure opponent during this stage.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;shovefold-ranges&#34;&gt;Shove/Fold Ranges&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Adjust shove/fold ranges just like normal opening ranges.&lt;/li&gt;
&lt;li&gt;Big Stack can sometimes shove ATC into multiple players.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;bonus-concept-chip-utility&#34;&gt;Bonus Concept: Chip Utility&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Mid stack will continue to have unprofitable spots.&lt;/li&gt;
&lt;li&gt;Big stack will have more and more profitable spots.&lt;/li&gt;
&lt;li&gt;Top players go after the chip lead position.&lt;/li&gt;
&lt;li&gt;Example: take close shove as 2nd CL if pot gets you in contention for CL.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;day-29---floating-pokers-true-passive-aggressive-play&#34;&gt;Day 29 - Floating (Poker&amp;rsquo;s True Passive-Aggressive Play)&lt;/h2&gt;
&lt;h3 id=&#34;factors-favorable-to-floating&#34;&gt;Factors Favorable to Floating&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;In position.&lt;/li&gt;
&lt;li&gt;Opponent on wide range.&lt;/li&gt;
&lt;li&gt;Small bet sizing.&lt;/li&gt;
&lt;li&gt;You can improve.&lt;/li&gt;
&lt;li&gt;Bonus: ICM Pressure.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;most-common-time-to-float&#34;&gt;Most common time to float&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Big blind in a heads-up pot vs small blind.&lt;/li&gt;
&lt;li&gt;Facing a donk bet at the flop.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;benefits-of-floating-to-bluff-raising&#34;&gt;Benefits of Floating to Bluff Raising&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Better risk-reward ratio.&lt;/li&gt;
&lt;li&gt;Gives you balanced calling range.&lt;/li&gt;
&lt;li&gt;Take advantage of position.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;disadvantage-of-floating&#34;&gt;Disadvantage of floating&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;NO FOLD EQUITY.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;dont-float&#34;&gt;DON&amp;rsquo;t FLOAT&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Facing a 75% pot bet with 7 high from the CL on the bubble.&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;large size&lt;/li&gt;
&lt;li&gt;no improve&lt;/li&gt;
&lt;li&gt;expensive&lt;/li&gt;
&lt;li&gt;lose chips&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;definitely-float&#34;&gt;Definitely Float&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Facing a min-bet in a raised pot with backdoor straight flush draw.&lt;/li&gt;
&lt;/ol&gt;
</description>
    </item>
    
    <item>
      <title>Become a Winning Online Poker Player in 30 Days - Week 3</title>
      <link>http://localhost:1313/post/2025-02-14-cards-chat-week3/</link>
      <pubDate>Sat, 15 Feb 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-02-14-cards-chat-week3/</guid>
      <description>&lt;h2 id=&#34;day-15---midterm&#34;&gt;Day 15 - Midterm&lt;/h2&gt;
&lt;p&gt;Q1. Middle position, what&amp;rsquo;s the right action?&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;- ATo raise - raise
- 22 fold - call âŒ
- K9o fold - fold
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Q2. flop TJ(c)A&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;- If we have 78(h), shall we C-bet? No - No âœ…
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Q3. AT What to do with hijack&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;- raise - correct answer: Fold, fold to early position. âŒ
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Q4. 44, big blind?&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;- Implied odds 8:1, not call - correct âœ…
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Q5. Calculate the equity? by percent and by dollar - equity, 18.3, chip = 18.3 * total chips - correct&lt;/p&gt;
&lt;p&gt;Q6. Shall we bet or check at river?&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;- check âŒ correct bet, because we do not have show down, and we get a better hand to fold.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Q7. K3, what to do in small blind, big blind 14bb&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;- shove, âœ…
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Q8. Calculate odds âœ…&lt;/p&gt;
&lt;p&gt;Q9. Calculate should I call? âœ…&lt;/p&gt;
&lt;p&gt;Q10.&lt;/p&gt;
&lt;h2 id=&#34;day-16---pot-control-thinking-like-a-chess-master&#34;&gt;Day 16 - Pot Control (Thinking like a chess master)&lt;/h2&gt;
&lt;h3 id=&#34;pre-flop-hand-planning&#34;&gt;Pre-Flop Hand Planning&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;What will I do if the short stack shoves over my raise?&lt;/li&gt;
&lt;li&gt;If I 3-bet here with this AQ, what will I do if the initial raiser 4-bets me?&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;how-many-bets&#34;&gt;How many bets?&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;How many bets post-flop if my hand good enough to go after?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Position&lt;/li&gt;
&lt;li&gt;Opponent Type&lt;/li&gt;
&lt;li&gt;Pre-Flop Action&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Pet Control&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Check back the flop or turn to limit the number of bets that go into the pot.&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;day-17---turns-and-rivers-three-keys-to-strong-late-street-play&#34;&gt;Day 17 - Turns and Rivers (Three keys to strong late street play)&lt;/h2&gt;
&lt;h3 id=&#34;turn-play-concept&#34;&gt;Turn Play Concept&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;When in doubt, if you have t he betting lead, continue firing the turn.&lt;/li&gt;
&lt;li&gt;Particularly with draws that don&amp;rsquo;t have showdown value.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;river-play-concept&#34;&gt;River Play Concept&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Switch into bluff-catching mode if there are many possible busted draws.&lt;/li&gt;
&lt;li&gt;bluff if you can represent a strong hand and your opponent is capable of folding.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;day-18---hand-reading-secrets-of-the-poker-magicians&#34;&gt;Day 18 - Hand Reading (Secrets of the Poker Magicians)&lt;/h2&gt;
&lt;h3 id=&#34;key-hand-reading-question&#34;&gt;Key Hand Reading Question&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;What better hands are consistent with his actions?&lt;/li&gt;
&lt;li&gt;Would busted draws have played the way at the flop?&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;hand-reading-process&#34;&gt;Hand Reading Process&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Go through opponent&amp;rsquo;s betting pattern for the hand starting with pre-flop.&lt;/li&gt;
&lt;li&gt;Also use his overall tendencies.&lt;/li&gt;
&lt;li&gt;very fast call, usually draws or non-nut hands.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;two-key-points-to-remember&#34;&gt;Two key points to remember&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;You&amp;rsquo;re not trying to read robots, humans do unpredictable things.&lt;/li&gt;
&lt;li&gt;Even very experienced hand readers will get surprised.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;day-19---small-blind-play-if-youve-ever-secretly-wanted-to-limp-a-lot&#34;&gt;Day 19 - Small Blind Play (If you&amp;rsquo;ve ever secretly wanted to limp a lot)&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Limp most of the time to keep the pot small while playing most hands.&lt;/li&gt;
&lt;li&gt;Cater your strategy to the big hand such as raising vs tight-passive opponent.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;stay-aggressive&#34;&gt;Stay Aggressive&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Continue to raise and 3-bet your stronger hands.&lt;/li&gt;
&lt;li&gt;Use larger raise-sizing because you&amp;rsquo;re out of position.&lt;/li&gt;
&lt;li&gt;Semi-bluff and go after value aggressively in limped pots.&lt;/li&gt;
&lt;li&gt;Bluff in heads-up pots or very favorable multi-way spots.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;day-20---variance-and-bankroll-management-why-recreational-players-keep-coming-back&#34;&gt;Day 20 - Variance and Bankroll Management (Why Recreational Players Keep Coming Back)&lt;/h2&gt;
&lt;h3 id=&#34;important-stats&#34;&gt;Important Stats&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;ROI, Return on Investment = Percent Profit Per Game&lt;/li&gt;
&lt;li&gt;ITM, In the Money = Percent of Tournaments You Cash&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;individual-vs-long-term-game-profit&#34;&gt;Individual vs Long-Term Game Profit&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Hannah makes $3 per game over 5000 games&lt;/li&gt;
&lt;li&gt;Hannah&amp;rsquo;s Profits in Next 5 games: -20, -20, -20, 40, -20&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;factors-decreasing-swings&#34;&gt;Factors Decreasing Swings&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Greater Edge and ROI in the games&lt;/li&gt;
&lt;li&gt;Flatter payout structure (greater % paid more even amounts)&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;common-no-limit-holdem-tourney-swings&#34;&gt;Common no-Limit Hold&amp;rsquo;EM Tourney Swings&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Very common: 25 buy-ins.&lt;/li&gt;
&lt;li&gt;Common: 50 buy-ins.&lt;/li&gt;
&lt;li&gt;Less Frequent: 100 buy-ins.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;remember&#34;&gt;Remember&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Swings are inevitable. embrace them.&lt;/li&gt;
&lt;li&gt;Focus on studying and playing in the softest games.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;quantify-tournament-variance&#34;&gt;Quantify Tournament Variance&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Use Primedope Tournament Variance Calculator&lt;/li&gt;
&lt;li&gt;Long Run = Number of Games that Guarantees * Profit&lt;/li&gt;
&lt;li&gt;(Not Actually Guarantee)&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;day-21---tracking-software-know-your-opponent-better-than-their-own-moms&#34;&gt;Day 21 - Tracking Software (Know Your opponent better than their own moms)&lt;/h2&gt;
&lt;h3 id=&#34;benefits-of-tracking-software&#34;&gt;Benefits of Tracking Software&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Show Results, All Hands (With replayer), Statistics&lt;/li&gt;
&lt;li&gt;Use in real-time to get live opponent stats in HUD&lt;/li&gt;
&lt;li&gt;PokerTracker4&lt;/li&gt;
&lt;li&gt;Holdem Manager&lt;/li&gt;
&lt;li&gt;Hand2Note&lt;/li&gt;
&lt;li&gt;DriveHUD&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;key-stats&#34;&gt;Key Stats&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;VPIP (Voluntarily Put in Pot)&lt;/li&gt;
&lt;li&gt;PFR (Pre-Flop Raise)&lt;/li&gt;
&lt;/ol&gt;
</description>
    </item>
    
    <item>
      <title>Become a Winning Online Poker Player in 30 Days - Week 2</title>
      <link>http://localhost:1313/post/2025-02-11-cards-chat-week2/</link>
      <pubDate>Tue, 11 Feb 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-02-11-cards-chat-week2/</guid>
      <description>&lt;h2 id=&#34;day-8-c-bets&#34;&gt;Day 8 C-Bets&lt;/h2&gt;
&lt;h3 id=&#34;do-not-c-bet&#34;&gt;Do not C-Bet&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Check a flop such as 789s&lt;/li&gt;
&lt;li&gt;Check if four or more players see the flop&lt;/li&gt;
&lt;li&gt;Check if you do not want to get check-raised. (Medium strong hand, just check).&lt;/li&gt;
&lt;li&gt;Don&amp;rsquo;t C-Bet when you monopolize Flop vs Recs: hero&amp;rsquo;s hand(AA) - flop (AA2)&lt;/li&gt;
&lt;li&gt;Check to an opponent who has the opportunity to C-bet, check to preflop aggressor.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;day-9-implied-odds-and-reverse-implied-odds-a-vital-deep-stack-concept&#34;&gt;Day 9 Implied Odds and Reverse Implied Odds (A vital deep-stack concept)&lt;/h2&gt;
&lt;h3 id=&#34;implied-odds-pre-flop-concept&#34;&gt;Implied Odds Pre-Flop Concept&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;implied odds pre-flop: how much you can win to the cost of calling.&lt;/li&gt;
&lt;li&gt;You want at least 20:1 implied odds to set-mine with a low pocket pair.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;implied-odds-post-flop&#34;&gt;Implied Odds Post-Flop&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;implied odds post-flop: Ratio of what you&amp;rsquo;re likely to win if you connect to the cost of calling.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;implied-odds-increase-if&#34;&gt;Implied odds increase if&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;effective stack is deeper&lt;/li&gt;
&lt;li&gt;more active players&lt;/li&gt;
&lt;li&gt;action opponents&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;reverse-implied-odds-your-opponents-implied-odds&#34;&gt;Reverse Implied Odds (Your opponent&amp;rsquo;s implied odds)&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;If you are aheads, you will win little or no money&lt;/li&gt;
&lt;li&gt;If you are behind, you will lose a lot more money&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;summarization&#34;&gt;Summarization&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Implied odds capture the concept of how we can win more money from our opponents than just the current pot when we hit a big hand.&lt;/li&gt;
&lt;li&gt;We should (at least) call with pocket pairs getting 20:1 or
better implied odds pre-flop, and be a lot more inclined to continue with draws after the flop when weâ€™re getting good implied odds.&lt;/li&gt;
&lt;li&gt;You can profitably make tight folds in situations with bad reverse implied odds: Situations where youâ€™re likely to lose more money when behind or win little more when ahead.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;day-10---the-key-to-play-the-draws-raise-and-cross-your-fingers&#34;&gt;Day 10 - The key to play the draws (Raise and Cross Your Fingers)&lt;/h2&gt;
&lt;h3 id=&#34;semi-bluff-aggressively&#34;&gt;Semi-Bluff Aggressively&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Powerful Play
&lt;ul&gt;
&lt;li&gt;You win if Villain folds&lt;/li&gt;
&lt;li&gt;You hit your draw&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Pot Odds Analysis
&lt;ul&gt;
&lt;li&gt;Key Calling Question: Do you have the pot odds you need for a +EV call&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Implied Odds for future betting
&lt;ul&gt;
&lt;li&gt;If possibility of future betting, use implied odds instead of pot odds.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;reasons-to-play-draws-more-passively&#34;&gt;Reasons to Play Draws More Passively&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Have little or no fold equity
&lt;ul&gt;
&lt;li&gt;Against someone who never folds&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;You have reasonable showdown value&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;day-11---bluffing-the-art-and-science-of-making-plays&#34;&gt;Day 11 - Bluffing (The art and science of Making plays)&lt;/h2&gt;
&lt;h3 id=&#34;bluff-to-attack-weakness&#34;&gt;Bluff to attack Weakness&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Opponent tell you when they&amp;rsquo;re weak and this is the best time to bluff them.&lt;/li&gt;
&lt;li&gt;Scare Cards are Good Opportunities&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;times-to-bluff-more&#34;&gt;Times to Bluff More&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Heads-Up Play&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Weak Opponents&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;bluffing-caveat&#34;&gt;Bluffing Caveat&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Pick hands without showdown value&lt;/li&gt;
&lt;li&gt;Try to represent a real hand you would have played this way&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;day-12---river-bets-the-crucial-late-street-question&#34;&gt;Day 12 - River Bets (The crucial late street question)&lt;/h2&gt;
&lt;h3 id=&#34;understand-the-question&#34;&gt;Understand the question&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;If I bet or raise, what better hands will fold? (bluff)&lt;/li&gt;
&lt;li&gt;If I bet or raise, what worse hands will call? (value)&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;key-spots-not-to-bet-or-raise&#34;&gt;Key Spots Not to Bet or Raise&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Holding 9X on KQJT5&lt;/li&gt;
&lt;li&gt;Holding AX on 55332&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;equity-denial-bet&#34;&gt;Equity Denial Bet&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Betting with the purpose of getting a worse hand to fold.&lt;/li&gt;
&lt;li&gt;The worse hand still have good equity against us.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;day-13---pre-flop-shove-spots&#34;&gt;Day 13 - Pre-flop Shove Spots&lt;/h2&gt;
&lt;h3 id=&#34;shove-spot&#34;&gt;Shove Spot&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;open-shove: less than 15bb effective stack&lt;/li&gt;
&lt;li&gt;single raise pot: less than 25bb effectie&lt;/li&gt;
&lt;li&gt;over all: there is 25% or more of the effective stack in the middle&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;modify&#34;&gt;Modify&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Facing passive and predictable opponents&lt;/li&gt;
&lt;li&gt;Exploitive play with premium hands&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;day-14---icm-most-important-model-in-poker&#34;&gt;Day 14 - ICM (Most important model in poker)&lt;/h2&gt;
&lt;h3 id=&#34;definition-of-icm&#34;&gt;Definition of ICM&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Model that converts everyone&amp;rsquo;s chip stack in a tourney to their dollar equity.&lt;/li&gt;
&lt;li&gt;Input: Stack Distribution + Payout Structure&lt;/li&gt;
&lt;li&gt;Output: Everyone&amp;rsquo;s equities in dollars or percentages.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;ways-to-gain-equity&#34;&gt;Ways to gain equity&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;gain chips&lt;/li&gt;
&lt;li&gt;watch as someone busts&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;icm-calculation&#34;&gt;ICM Calculation&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Use software to tell us what hands to shove or fold pre-flop&lt;/li&gt;
&lt;/ol&gt;
</description>
    </item>
    
    <item>
      <title>Become a Winning Online Poker Player in 30 Days - Week 1</title>
      <link>http://localhost:1313/post/2025-02-10-cards-chat-week1/</link>
      <pubDate>Mon, 10 Feb 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-02-10-cards-chat-week1/</guid>
      <description>&lt;h2 id=&#34;day-1---the-power-of-position-fundamental&#34;&gt;Day 1 - The power of position (Fundamental)&lt;/h2&gt;
&lt;h3 id=&#34;key-takeaways&#34;&gt;Key Takeaways&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Understand the Understand the different positions, including what each one is called and the order that they act in both pre-flop and post-flop: SB, BB, UTG, UTG+1, LJ, HJ, CO, BTN.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;You can play many more hands profitably on the button or in late position than from the early positions.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Bonus Concept: You can have good â€œrelative positionâ€ if youâ€™re to the right of a very aggressive player in a multiway pot.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;day-2---the-benefits-of-aggression-fundamental&#34;&gt;Day 2 - The benefits of Aggression (Fundamental)&lt;/h2&gt;
&lt;h3 id=&#34;key-takeaways-1&#34;&gt;Key Takeaways&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Three fundamental types of actions you can take&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;call -&amp;gt; passive&lt;/li&gt;
&lt;li&gt;check/fold -&amp;gt; neutral&lt;/li&gt;
&lt;li&gt;bet/raise -&amp;gt; aggressive&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Think about the players that you enjoy having as opponents. Who would you rather play against: A passive opponent whoâ€™s mainly checking and calling or an aggressive opponent whoâ€™s betting and raising a lot?&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;day-3---thinking-in-ranges-fundamental&#34;&gt;Day 3 - Thinking in Ranges (Fundamental)&lt;/h2&gt;
&lt;h3 id=&#34;key-takeaways-2&#34;&gt;Key Takeaways&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Understand what a range is and how theyâ€™re written.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;During a hand of poker, we have one hand that stays the same, while our opponents have ranges that are changing with each new action they take.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Thinking in ranges is still an extremely valuable framework, even if the ranges are imprecise or we put Villain on a very wide range.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;day-4---the-two-types-of-equity-fundamental&#34;&gt;Day 4 - The Two Types of Equity (Fundamental)&lt;/h2&gt;
&lt;h3 id=&#34;key-takeaways-3&#34;&gt;Key Takeaways&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Understand the concept of your equity in a pot as a poker hand progresses.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Your equity against an opponentâ€™s range is simply how often you win the hand (assuming nobody folds) if heâ€™s equally likely to hold any hand in his range.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;After every hand in a tournament, your equity changes to reflect how much money youâ€™ll win on average playing out the tournament from that point forward.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;day-5-understanding-pot-odds-and-expected-value-fundamental&#34;&gt;Day 5 Understanding Pot Odds and Expected Value (Fundamental)&lt;/h2&gt;
&lt;h3 id=&#34;key-takeaways-4&#34;&gt;Key Takeaways&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Understand what pot odds are and how to calculate them.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Pot odds tell you what percent of the time you need to win the pot for a call to be profitable. Good players always decide whether to call based on their odds.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Expected value is the amount of money youâ€™ll make or lose on average from a given action.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;day-6-the-guide-to-pre-flop&#34;&gt;Day 6 The Guide to Pre-Flop&lt;/h2&gt;
&lt;h3 id=&#34;under-the-gun-and-utg1&#34;&gt;Under-The-Gun and UTG+1:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;66+&lt;/li&gt;
&lt;li&gt;AJo+&lt;/li&gt;
&lt;li&gt;A9s+&lt;/li&gt;
&lt;li&gt;KQo&lt;/li&gt;
&lt;li&gt;JTs+&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;middle-position-and-lojack&#34;&gt;Middle Position and Lojack:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;55+&lt;/li&gt;
&lt;li&gt;ATo&lt;/li&gt;
&lt;li&gt;A7s+&lt;/li&gt;
&lt;li&gt;QJo+&lt;/li&gt;
&lt;li&gt;T9s+&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;hijack-and-cutoff&#34;&gt;Hijack and Cutoff:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;33+&lt;/li&gt;
&lt;li&gt;A7o+&lt;/li&gt;
&lt;li&gt;A2s+&lt;/li&gt;
&lt;li&gt;JTo+&lt;/li&gt;
&lt;li&gt;K7s+&lt;/li&gt;
&lt;li&gt;Q8s+&lt;/li&gt;
&lt;li&gt;J9s+&lt;/li&gt;
&lt;li&gt;76s+&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;button&#34;&gt;Button:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;22+&lt;/li&gt;
&lt;li&gt;A2+&lt;/li&gt;
&lt;li&gt;K2s+&lt;/li&gt;
&lt;li&gt;K60+&lt;/li&gt;
&lt;li&gt;Q4s+&lt;/li&gt;
&lt;li&gt;Q70+&lt;/li&gt;
&lt;li&gt;J6s+&lt;/li&gt;
&lt;li&gt;J80+&lt;/li&gt;
&lt;li&gt;T80+&lt;/li&gt;
&lt;li&gt;54s+&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;small-blind&#34;&gt;Small Blind:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;22+&lt;/li&gt;
&lt;li&gt;A2+&lt;/li&gt;
&lt;li&gt;K20+&lt;/li&gt;
&lt;li&gt;Q50+&lt;/li&gt;
&lt;li&gt;J60+&lt;/li&gt;
&lt;li&gt;85o+&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;all suited hands&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Now that weâ€™ve given these approximate guidelines for opening ranges based on position, it is
time for a bunch of notes and caveats&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;You should tend to play more hands against tight opponents, and fewer hands against loose/wild opponents.&lt;/li&gt;
&lt;li&gt;When the effective stack is 15bb or less, you will be playing shove/fold pre-flop.&lt;/li&gt;
&lt;li&gt;When the effective stack is short, such as 15-30bb, your default play is to minraise first in. At moderate effective stacks of around 30-50bb, tend to raise 2.5bb, for example $250 at $50-$100. At deep effective stacks greater than 50bb, tend to raise 3bb such as $300 at $50-$100.&lt;/li&gt;
&lt;li&gt;Exception to the last rule: From the small blind, you should usually limp first in (or raise to at least 2.5bb against tighter players). Donâ€™t limp first in from any other position.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;facing-limpers&#34;&gt;Facing Limpers&lt;/h3&gt;
&lt;p&gt;Fold the weakest hands in your range. Limp behind with some of the weaker hands that still have good playability, such as 22 or 65s . Continue to raise any of the stronger hands you would have played, adding one big blind to your raise sizing for each limper already in the pot.&lt;/p&gt;
&lt;h3 id=&#34;facing-raising&#34;&gt;Facing Raising&lt;/h3&gt;
&lt;p&gt;So for now, select situations that youâ€™re confident will be profitable. Itâ€™s generally a bigger mistake to continue in a bad spot than it is to make a tight fold and stay out of trouble!&lt;/p&gt;
&lt;h3 id=&#34;key-takeaways-5&#34;&gt;Key Takeaways&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Understand approximately what ranges to play from each position when youâ€™re first to voluntarily enter the pot.&lt;/li&gt;
&lt;li&gt;There are many factors affecting the pre-flop decision-making process including positions, opponent types, effective stack, raise sizings, and tournament state. Weâ€™ve done our best to give you good general guidelines. If youâ€™re unsure whether to play a certain hand, then just fold for now and wait for a good spot.&lt;/li&gt;
&lt;li&gt;The effective stack is the most you can lose in a given hand, which will be the same as your stack size unless you cover everyone else left to act.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;day-7-value-bet&#34;&gt;Day 7 Value Bet&lt;/h2&gt;
&lt;h3 id=&#34;key-takeaways-6&#34;&gt;Key Takeaways&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Understand what it means to make a value bet and how important they are to winning at poker.&lt;/li&gt;
&lt;li&gt;If you think itâ€™s likely you have the best hand, always consider value betting it.&lt;/li&gt;
&lt;li&gt;Think about which worse hands your opponent can call your value bet with.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;reference: &lt;a href=&#34;https://www.cardschat.com/wp-content/uploads/2023/02/Become-a-Winning-Poker-Player-in-30-Days-CardChat.com_.pdf&#34;&gt;https://www.cardschat.com/wp-content/uploads/2023/02/Become-a-Winning-Poker-Player-in-30-Days-CardChat.com_.pdf&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>é‡è›®ç”Ÿé•¿</title>
      <link>http://localhost:1313/post/2025-02-04-%E9%87%8E%E8%9B%AE%E7%94%9F%E9%95%BF/</link>
      <pubDate>Tue, 04 Feb 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2025-02-04-%E9%87%8E%E8%9B%AE%E7%94%9F%E9%95%BF/</guid>
      <description>&lt;p&gt;æœ€è¿‘çœ‹äº†ã€Šé‡è›®ç”Ÿé•¿ã€‹ï¼Œä¹¦é‡Œè®²çš„åˆ›ä¸šå¿ƒè·¯å†ç¨‹å’Œæˆ‘æ‰“å·¥çš„ç”Ÿæ´»æœ‰äº›è·ç¦»ï¼Œæ²¡é‚£ä¹ˆå¤§çš„å…±é¸£ã€‚ä»¤æˆ‘æ„Ÿå…´è¶£çš„æ˜¯é‡Œé¢è°ˆåŠçš„è®¸å¤šä¼ä¸šå®¶ï¼Œæœ‰çš„è¢«å†™çš„åå…¨åç¾ï¼Œæœ‰çš„è¢«å†™çš„ä¸€æ— æ˜¯å¤„ï¼Œä½†ä»¤æˆ‘æœ€æ„Ÿåˆ°å–œæ¬¢çš„æ˜¯&lt;strong&gt;ç‰Ÿå…¶ä¸­&lt;/strong&gt;ï¼Œä½œè€…å¯¹ä»–çš„è¯„ä»·æ¯”è¾ƒé¥±æ»¡ï¼Œæœ‰è¤’æœ‰è´¬ï¼Œå¹³è¡¡çš„äººæ‰æ˜¯çœŸå®çš„ã€‚åˆå» youtube çœ‹äº†ä¸€äº›ä»–çš„è®¿è°ˆï¼Œä»–ç”Ÿå¹³ä»å€’å–é£æœºï¼Œå‘å°„å«æ˜Ÿï¼Œåˆ°ç‚¸å¼€å–œé©¬æ‹‰é›…å±±ï¼ŒçœŸæ˜¯ä¸€ä½å¸¦æœ‰è‰ºæœ¯æ°”è´¨çš„ç‹‚æƒ³å®¶ï¼&lt;/p&gt;
&lt;p&gt;æƒ³è®¤è¯†è¿™æ ·çš„äººï¼Œå’Œä»–ä»¬æˆä¸ºæœ‹å‹ä¸€å®šä¼šå¾ˆæœ‰è¶£ï¼&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>CS224n-NLP-lecture 1, 2</title>
      <link>http://localhost:1313/post/2024-11-29-cs224n-nlp-lecture1&#43;2-word2vec/</link>
      <pubDate>Fri, 29 Nov 2024 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2024-11-29-cs224n-nlp-lecture1&#43;2-word2vec/</guid>
      <description>&lt;h1 id=&#34;word2vector&#34;&gt;Word2Vector&lt;/h1&gt;
&lt;h2 id=&#34;how&#34;&gt;How&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Represent words by their context (Distributional semantics): A word&amp;rsquo;s meaning is given by words frequently appear close-by, within a fixed-size.&lt;/li&gt;
&lt;li&gt;Use the many contexts of w to build up a representation of w.&lt;/li&gt;
&lt;li&gt;We build a dense vector for each word, chosen so that it is similar to vectors of words that appear in similar context.&lt;/li&gt;
&lt;li&gt;Note that word vectors are also called word embeddings, or neural word representations. They are a distributed representation.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;word2vector-idea&#34;&gt;Word2Vector idea&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;We have a large body of text (corpus).&lt;/li&gt;
&lt;li&gt;Every word in a fixed vocabulary is represented by vector.&lt;/li&gt;
&lt;li&gt;Go through each position t in the text, which has a center word (c) and a context word (o).&lt;/li&gt;
&lt;li&gt;Use similarity of word vectors for c and o, calculate the probablity of o given c.&lt;/li&gt;
&lt;li&gt;Keep adjusting the word vector to maximize this probablity.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;math&#34;&gt;Math&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;$L(\theta) = \prod_{t=1}^T \prod_{\substack{-m \leq j \leq m \\ j \neq 0}} P(w_{t+j} \mid w_t; \theta)$&lt;/li&gt;
&lt;li&gt;$J(\theta) = -\frac{1}{T} \log L(\theta) = -\frac{1}{T} \sum_{t=1}^T \sum_{\substack{-m \leq j \leq m \\ j \neq 0}} \log P(w_{t+j} \mid w_t; \theta)$&lt;/li&gt;
&lt;li&gt;$P(o \mid c) = \frac{\exp(u_o^T v_c)}{\sum_{w \in V} \exp(u_w^T v_c)}$
&lt;ul&gt;
&lt;li&gt;Exponentiation makes anything positive&lt;/li&gt;
&lt;li&gt;Dot product compares similarity of o and c.&lt;/li&gt;
&lt;li&gt;Normalize over entire vocabulary to give probability distribution&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;gradient-descent-and-stochastic-gradient-descent&#34;&gt;Gradient Descent and Stochastic Gradient Descent&lt;/h2&gt;
&lt;h3 id=&#34;problem&#34;&gt;Problem:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;J is a function of all windows in the corpus, gradient is expensive to compute.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;solution&#34;&gt;Solution:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;SGD Stochastic Gradient Descent&lt;/li&gt;
&lt;li&gt;SGD in each window: we only have at most 2m + 1 words&lt;/li&gt;
&lt;li&gt;Either we need sparse matrix updates operations to only update certain rows of full embedding metrics U and V, or we need to keep around a hash of word vector. Millions of word vectors allow us to do distributed computing.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;word2vector-algo-family&#34;&gt;Word2Vector Algo Family&lt;/h2&gt;
&lt;h3 id=&#34;two-models&#34;&gt;Two models:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Skip-gram(SG), predict context (outside) words given center words.&lt;/li&gt;
&lt;li&gt;Continuous bag of words (CBOW), predict context words from context words.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;negative-sampling&#34;&gt;Negative Sampling&lt;/h3&gt;
&lt;h4 id=&#34;problem-1&#34;&gt;Problem&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;The normalization demonitator is computionally expensive.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;solution-1&#34;&gt;Solution&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Train a binary logistic regression for a true pair vs noise pair.&lt;/li&gt;
&lt;li&gt;$J(\theta) = \frac{1}{T} \sum_{t=1}^{T} J_t(\theta)$&lt;/li&gt;
&lt;li&gt;$J_t(\theta) = \log \sigma \left( u_o^\top v_c \right) + \sum_{i=1}^{k} \mathbb{E}_{j \sim P(w)} \left[ \log \sigma \left( -u_j^\top v_c \right) \right]$&lt;/li&gt;
&lt;li&gt;$\sigma(x) = \frac{1}{1 + e^{-x}}$&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;Take k negative samples&lt;/li&gt;
&lt;li&gt;Maxmize probablity that real words appear, minimize probablity that random words appear around the center words.&lt;/li&gt;
&lt;li&gt;Sample with P(w) = u(w)^(3/4)&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;co-occurence-counting&#34;&gt;Co-occurence counting&lt;/h2&gt;
&lt;h3 id=&#34;problems&#34;&gt;Problems:&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;vector increase in sizes&lt;/li&gt;
&lt;li&gt;Subsequent classification models have sparsity issues.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;singular-value-decomposition&#34;&gt;Singular Value Decomposition&lt;/h3&gt;
&lt;p&gt;X = USV&lt;/p&gt;
&lt;h3 id=&#34;glove&#34;&gt;GloVe&lt;/h3&gt;
&lt;p&gt;Crucial Insight: Ratios of co-occurence probablities can encode meaning components (meaning component means going from male to female etc).&lt;/p&gt;
&lt;p&gt;$J = \sum_{i,j=1}^{V} f(X_{ij}) \left( w_i^\top \tilde{w}_j + b_i + \tilde{b}_j - \log X_{ij} \right)^2$&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$X\_{ij}$: The co-occurrence count between words \( i \) and \( j \).&lt;/li&gt;
&lt;li&gt;\( w_i \): The word vector for the word \( i \).&lt;/li&gt;
&lt;li&gt;\( \tilde{w}\_j \): The context word vector for the word \( j \).&lt;/li&gt;
&lt;li&gt;\( b_i \): The bias term for the word \( i \).&lt;/li&gt;
&lt;li&gt;\( \tilde{b}\_j \): The bias term for the context word \( j \).&lt;/li&gt;
&lt;li&gt;\( \log X*{ij} \): The logarithm of the co-occurrence count \( X*{ij} \).&lt;/li&gt;
&lt;li&gt;\( f(X\_{ij}) \): A weighting function to limit the influence of very frequent or very infrequent word pairs.&lt;/li&gt;
&lt;li&gt;\( x\_{\text{max}} \): A maximum co-occurrence count threshold.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;how-to-evaluate&#34;&gt;How to evaluate&lt;/h2&gt;
&lt;h3 id=&#34;intrinsics&#34;&gt;Intrinsics&lt;/h3&gt;
&lt;h4 id=&#34;definition&#34;&gt;Definition&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;Evaluation on a specific subtask.&lt;/li&gt;
&lt;li&gt;Fast to compute.&lt;/li&gt;
&lt;li&gt;Helps to understand the system.&lt;/li&gt;
&lt;li&gt;Not clear if it really helps unless correlation to real task is established.&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;example&#34;&gt;Example&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;Word Vector Analogy&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;man:woman :: king:?&lt;/li&gt;
&lt;li&gt;Evaluate word vectors by how will their cosine distance after addition captures intuitive semantics and syntatic analogy questions.&lt;/li&gt;
&lt;li&gt;Discard the input words from search&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;WordSim human judgement&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;extrinsics&#34;&gt;Extrinsics&lt;/h3&gt;
&lt;h4 id=&#34;definition-1&#34;&gt;Definition&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;Evaluation on a real task.&lt;/li&gt;
&lt;li&gt;Can take a long time to compute.&lt;/li&gt;
&lt;li&gt;Unclear if the subsystem is the probelm or its interaction or other subsystems.&lt;/li&gt;
&lt;li&gt;If replacing exactly one subsystem is making progress, that&amp;rsquo;s good.&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;example-1&#34;&gt;Example&lt;/h4&gt;
&lt;p&gt;Named Entity recognition.&lt;/p&gt;
&lt;h2 id=&#34;word-sense&#34;&gt;Word sense&lt;/h2&gt;
&lt;p&gt;A word can have multiple meanings.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Trip in Shanghai</title>
      <link>http://localhost:1313/post/2024-11-25-shanghai-trip/</link>
      <pubDate>Mon, 25 Nov 2024 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2024-11-25-shanghai-trip/</guid>
      <description>&lt;h1 id=&#34;day1---åˆ°è¾¾-arrival&#34;&gt;Day1 - åˆ°è¾¾ Arrival&lt;/h1&gt;
&lt;p&gt;æˆ‘äºå‘¨å…­æ™šä¸ŠæŠµè¾¾ä¸Šæµ·æµ¦ä¸œå›½é™…æœºåœºï¼ˆPVGï¼‰ï¼Œå¹¶åœ¨ä¸Šæµ·å”é•‡æ™ºé€‰å‡æ—¥é…’åº—åº¦è¿‡äº†åœ¨ä¸Šæµ·çš„ç¬¬ä¸€ä¸ªæ™šä¸Šã€‚&lt;/p&gt;
&lt;p&gt;ç”µä¿¡ï¼ˆä¸­å›½ä¸€å®¶å—æ¬¢è¿çš„æ‰‹æœºæä¾›å•†ï¼‰å‡ºäºä¿æŠ¤æˆ‘çš„éšç§çš„ç›®çš„ï¼Œä»¥æŸç§æ–¹å¼æš‚åœäº†æ‰‹æœºå¥—é¤ï¼Œå› ä¸ºè·ç¦»æˆ‘ä¸Šæ¬¡åœ¨ä¸­å›½ä½¿ç”¨æ‰‹æœºå·²ç»å¿«ä¸¤å¹´äº†ã€‚ç”±äºæˆ‘æ— æ³•è®¿é—®äº’è”ç½‘ï¼Œå› æ­¤æ— æ³•ä½¿ç”¨ Uberã€Lyft æˆ–ä»»ä½•å…¶ä»–ä¹˜è½¦å…±äº«åº”ç”¨ç¨‹åºï¼Œå› æ­¤æˆ‘å¿…é¡»åœ¨æœºåœºä½¿ç”¨ç°é‡‘å’Œä¼ ç»Ÿå‡ºç§Ÿè½¦æœåŠ¡æ‰èƒ½åˆ°è¾¾é…’åº—ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å‡ºç§Ÿè½¦ä¸Šï¼Œå¸æœºæ•…æ„å’Œæˆ‘é—²èŠï¼Œç»•é“èµ°ï¼Œä»¥ä¾¿èƒ½ä»æˆ‘è¿™æ ·çš„æ¸¸å®¢èº«ä¸Šèµšåˆ°æ›´å¤šçš„é’±ï¼Œè¿™è®©æˆ‘æœ‰ä¸€ç§è¢«éª—çš„æ„Ÿè§‰ã€‚æ ¹æ®è¯¥åº”ç”¨ç¨‹åºï¼Œé¢„è®¡å‡ºç§Ÿè½¦è´¹çº¦ä¸º 80 å…ƒï¼Œä½†æœ€ç»ˆè¡Œç¨‹ä¸º 140 å…ƒã€‚å½“æˆ‘å‘Šè¯‰å¥¹æˆ‘è®°å½•äº†å¥¹çš„æœåŠ¡å·ç ä»¥ä¾¿å°†æ¥å®¢æˆ·æŠ•è¯‰æ—¶ï¼Œå¥¹åŒæ„ç»™æˆ‘æŠ˜æ‰£å¹¶å‘æˆ‘ç´¢è¦ 100 å…ƒã€‚æˆ‘ä»˜äº†å¥¹ 100 å…ƒï¼Œå¸¦ç€ä¸æ„‰å¿«çš„å¿ƒæƒ…ä¸‹äº†å‡ºç§Ÿè½¦ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºé•¿é€”é£è¡Œå’Œä¸å¥½çš„å‡ºç§Ÿè½¦æœåŠ¡ä½“éªŒï¼Œæˆ‘æ„Ÿåˆ°éå¸¸ç–²æƒ«ã€‚æ­¤å¤–ï¼Œç”±äºç”µè¯å¥—é¤æš‚åœè€Œæ— æ³•ä¸Šç½‘ï¼Œè¿™è®©æˆ‘é™·å…¥äº†å°´å°¬çš„å¢ƒåœ°ï¼Œæˆ‘æ— æ³•è®¢è´­ Uber Eatsï¼Œä¹Ÿæ— æ³•ä»˜æ¬¾ï¼Œå› ä¸ºæ— æ³•ä½¿ç”¨æ”¯ä»˜å®æˆ–å¾®ä¿¡æ”¯ä»˜ã€‚&lt;/p&gt;
&lt;p&gt;åˆé¥¿åˆç´¯ï¼Œæˆ‘æœ€åæ‰“ç”µè¯ç»™æˆ‘é«˜ä¸­å’Œå¤§å­¦çš„æœ‹å‹å¤©æˆç‚¹é¤ã€‚åŒæ—¶ï¼Œæˆ‘ä¹Ÿè®©çˆ¶æ¯ç»™ç”µä¿¡æ‰“ç”µè¯ï¼Œæ¢å¤æˆ‘çš„æ‰‹æœºå¥—é¤ï¼Œè¿™æ ·æˆ‘å°±å¯ä»¥ä¸Šç½‘äº†ã€‚&lt;/p&gt;
&lt;p&gt;æ„Ÿè°¢æˆ‘çš„æœ‹å‹å’Œæˆ‘çš„çˆ¶æ¯ï¼Œåƒäº†è€ä¹¡é¸¡çš„é£Ÿç‰©å’Œæ¢å¤ç”µè¯å¥—é¤åï¼Œæˆ‘æ„Ÿè§‰è‡ªå·±è·å¾—äº†é‡ç”Ÿã€‚é‚£å¤©æ™šä¸Šæˆ‘ç¡å¾—å¾ˆå¥½ï¼Œåªæ˜¯å› ä¸ºæ—¶å·®è€Œæ—©é†’ã€‚&lt;/p&gt;
&lt;p&gt;I arrived at Shanghai Pudong International Airport(PVG) on Saturday evening, and I spent my first night in Shanghai at Holiday Inn Express Shanghai Tangzhen.&lt;/p&gt;
&lt;p&gt;Dianxin(a popular phone provider in China) somehow suspended the phone plans for protecting my privacy due to the fact that it&amp;rsquo;s been almost two years since the last time that I used my phone in China. As I do not have access to the Internet, I cannot use Uber, Lyft or any other ride sharing apps, therefore I have to use cash and conventional taxi service at the airport to arrive my hotel.&lt;/p&gt;
&lt;p&gt;During the taxi ride, the driver deliberately made small talks with me and took detours such that she could possibly earn more money from a visitor like me, which makes me feel scamed. While the estimated taxi fees, according to the app, is around 80rmb, the trip ended up being 140 rmb. As I told her that I recorded her service number for future customer complains, she agreed to give me a discount and asked 100 rmb from me. I paied her 100rmb and left the taxi with unfavorable feelings.&lt;/p&gt;
&lt;p&gt;I feel extremely tired due to the long flight and unfavorable experience of taxi service. Additionally, not having access to Internet due to the suspended phone plan put me into an akward situation where I cannot order uber eats and cannot pay money becuase of not being able to use AliPay or Wechat Pay.&lt;/p&gt;
&lt;p&gt;Starving and Tired, I ended up calling my high school and college friend Tiancheng for ordering food. Meanwhile, I also asked my parents to call Dianxin for resuming my phone plan such that I can have access to Internet and everything.&lt;/p&gt;
&lt;p&gt;Thanks to my friend and my parents, I felt that I got reborn after the food from Hometown Chicken and resuming my phone plan. I had a farily good sleep that night, except waked up early due to jet lag.&lt;/p&gt;
&lt;h1 id=&#34;day2---ä¸é«˜ä¸­å’Œå¤§å­¦æœ‹å‹é‡èš-reunion-with-high-school-and-college-friend&#34;&gt;Day2 - ä¸é«˜ä¸­å’Œå¤§å­¦æœ‹å‹é‡èš Reunion with high school and college friend&lt;/h1&gt;
&lt;p&gt;8:00 å·¦å³èµ·åºŠï¼Œä¸æ½œåœ¨çš„æ–°ç»ç†ä¼šé¢äº†å¤§çº¦ 20 åˆ†é’Ÿï¼Œè®¨è®ºäº†ä¸€äº›å†…éƒ¨è°ƒåŠ¨çš„æ½œåœ¨è®¡åˆ’ï¼›æˆ‘å¯¹åµŒå…¥æŠ€æœ¯æ„Ÿåˆ°éå¸¸å…´å¥‹ï¼Œå”¯ä¸€å‰©ä¸‹çš„å°±æ˜¯ä¸æˆ‘çš„ç»ç†è®¨è®ºè½¬ç»„äº‹å®œã€‚&lt;/p&gt;
&lt;p&gt;å¤©æˆäº 10ï¼š00 åˆ°è¾¾é…’åº—ï¼Œæˆ‘ä»¬ä¸€èµ·åœ¨æ™ºé€‰å‡æ—¥é…’åº—åƒæ—©é¤ã€‚æ—©é¤åï¼Œæˆ‘å‚è§‚äº†ä»–çš„å…¬å¯“ï¼Œå¹¶åœ¨é™„è¿‘çš„ç†å‘åº—ç†å‘ã€‚åˆé¤åƒå®ŒéŸ©å›½èœåï¼Œæˆ‘ä»¬å»ä¸Šæµ·æ»¨æ±Ÿæ£®æ—å…¬å›­æ•£æ­¥ã€‚å…¬å›­å¾ˆå¤§ï¼Œç§æ»¡äº†æ¤ç‰©ï¼Œè¿˜æœ‰é‡é¤çš„åœ°æ–¹ã€‚æˆ‘ä»¬é€›äº†ä¸€ä¼šå„¿ï¼Œåœ¨ä¸€æ± å’–å•¡åº—å–äº†æ¯å’–å•¡æˆ–èŒ¶ã€‚&lt;/p&gt;
&lt;p&gt;æ™šä¸Šæˆ‘ä»¬ä»æµ¦ä¸œå»äº†é™å®‰ï¼Œå‘¨äºŒæˆ‘è¦å»é‚£é‡Œé¢è¯•ç­¾è¯ã€‚æˆ‘ä»¬åœ¨ä¸€å®¶æ¸¯å¼å’–å•¡å…åƒé¥­ï¼Œèœçš„å‘³é“éå¸¸å¥½ï¼Œæ¹¾åŒºæ²¡æœ‰ä¸€å®¶é¤å…èƒ½ä¸ä¹‹åª²ç¾ã€‚é¥­åï¼Œæˆ‘ä»¬åœ¨ä¸Šæµ·é™å®‰æ•£æ­¥ã€‚æˆ‘ä»¬ä¹‹å‰ä¸€èµ·å»è¿‡ä¸Šæµ·ä¸¤æ¬¡ï¼Œä¸€æ¬¡æ˜¯ 2020 å¹´å¤å¤©ï¼Œåº†ç¥å­¦æœŸå­£åº¦ç»“æŸï¼Œå¦ä¸€æ¬¡æ˜¯ 2021 å¹´å¤å¤©ï¼Œåœ¨æˆ‘ä»¬ç¦»å¼€ä¸­å›½å»ç¾å›½è¯»ç ”ç©¶ç”Ÿä¹‹å‰ã€‚ä¸Šæµ·å’Œæˆ‘ä»¬ä¸Šæ¬¡å»çš„æ—¶å€™ä¸€æ ·ï¼Œç”šè‡³ç¹åï¼Œåªæ˜¯æˆ‘è§‰å¾—è‡ªå·±è€äº†ï¼Œæ¶ˆåŒ–é£Ÿç‰©çš„èƒ½åŠ›å˜å·®äº†ï¼Œç²¾åŠ›ä¹Ÿå˜å°‘äº†ã€‚è¿™ç§æ„Ÿè§‰è®©æˆ‘é™·å…¥äº†ä¸€ç§æƒ…ç»ªçŠ¶æ€ã€‚&lt;/p&gt;
&lt;p&gt;åŸå¸‚æ¼«æ­¥ç»“æŸåï¼Œæˆ‘ä»¬å›åˆ°åŸå¸‚é…’åº—ï¼Œæˆ‘å’Œä»–å‘Šåˆ«ï¼Œä»–å¼€è½¦å›å»äº†ï¼Œå› ä¸ºå‘¨ä¸€æ˜¯ä»–çš„å·¥ä½œæ—¥ã€‚é‚£å¤©æ™šä¸Š 9 ç‚¹å·¦å³æˆ‘æ„Ÿåˆ°éå¸¸å›°ï¼Œæ™šä¸Š 9 ç‚¹åŠå·¦å³å°±ç¡ç€äº†ï¼Œå¤§æ¦‚ç¡è§‰æ˜¯æˆ‘æƒ…ç»ªä½è½æ—¶èƒ½åšçš„æœ€å¥½çš„äº‹æƒ…å§ã€‚&lt;/p&gt;
&lt;p&gt;Waked up at around 8:00, I met with my potential new manager for around 20 minutes, discussing some potential plans for internal transfer; I am super excited about the embedding technology, the only thing remaining is to talk with my manager about the transfer.&lt;/p&gt;
&lt;p&gt;Tiancheng arrived at the hotel at 10:00, we had breakfast together at Holiday Inn Express. After the breakfast, I visited his apartment and got a haircut at a barber nearby. After the korean food for lunch, we went to Shanghai Binjiang Forest Park for a walk. The park was quite big, full with plants and picnickers. We walked around for a while, had a cup of coffee or tea at the Yichi Coffee.&lt;/p&gt;
&lt;p&gt;At night we went from Pudong district to Jing&amp;rsquo;an district where I would do visa interview on Tuesday. We had dinner at a Hong Kong-style cafe, the dishes taste so good that there is no restaurants comparable to this one in the bay area. After the dinner, we did some city walk in Jing&amp;rsquo;an, Shanghai. We&amp;rsquo;ve been to Shanghai together twice before, once in 2020 summer, celebrating the quarter ending, another time in 2021 summer, before we left China to America for starting grad school. Shanghai is the same or even more bustling than last time we went there, it&amp;rsquo;s just I feel I am getting older, with less ability to digest food and less energy. This kinda of feelings put me into an emotional state.&lt;/p&gt;
&lt;p&gt;After the citywalk, we went back to City Hotel, I said farewell to him, and he drove back as Monday is a work day for him. I felt extremely sleepy around 9:00 and felt in asleep around 9:30PM that night, probably feeeling asleep is the best thing I can do when feeling emotional.&lt;/p&gt;
&lt;h1 id=&#34;day3&#34;&gt;Day3&lt;/h1&gt;
&lt;p&gt;Waked up at 1:30AM, and then Slept from 5:00AM to 7:00AM, I waked up again, feeling lucid.&lt;/p&gt;
&lt;p&gt;Had an egg crepe in the morning, then went to the Shanghai World Financial Center where Google&amp;rsquo;s office located. Then I spent some time in the office, hopping between 60F and 64F, had lunch at Hai Cafe at 62F. Stayed there until 6:00PM for the night view.&lt;/p&gt;
&lt;p&gt;I met my parents at 6:30 PM at City Hotel. We were all overcome with emotion and cried when we saw each other. The bond I share with my parents is truly incredible and irreplaceable.&lt;/p&gt;
&lt;p&gt;We went to the Bund together, there was a little rain, and we all like the view in the Bund.&lt;/p&gt;
&lt;h1 id=&#34;day-4&#34;&gt;Day 4&lt;/h1&gt;
&lt;p&gt;Met with my manager, Met with the new manager.&lt;/p&gt;
&lt;p&gt;Went to Visa Appointment, got approved right away.&lt;/p&gt;
&lt;p&gt;Went back my city, Nanjing.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Poker Strategy</title>
      <link>http://localhost:1313/post/2024-11-04-poker/</link>
      <pubDate>Mon, 04 Nov 2024 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2024-11-04-poker/</guid>
      <description>&lt;h1 id=&#34;mdf-and-bf&#34;&gt;MDF and BF&lt;/h1&gt;
&lt;h2 id=&#34;mdf&#34;&gt;MDF&lt;/h2&gt;
&lt;p&gt;If the pot is \(1\) and your opponent&amp;rsquo;s bet is \(b\):&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;you fold: \(1 \times (1 - p(\text{you-call}))\)&lt;/li&gt;
&lt;li&gt;you call: \(-b \times p(\text{you-call})\)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Adding both cases:&lt;/p&gt;
\[
1 \times (1 - p(\text{you-call})) + p(\text{you-call}) \times -b = 0
\]
&lt;p&gt;Simplifying:&lt;/p&gt;
\[
1 = (1 + b) \times p(\text{you-call})
\]
&lt;p&gt;Solving for \(p(\text{you-call})\):&lt;/p&gt;
\[
p(\text{you-call}) = \frac{1}{1 + b}
\]
&lt;h2 id=&#34;bluffing-frequency&#34;&gt;Bluffing Frequency&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;0.75 pot
&lt;ul&gt;
&lt;li&gt;flop 67%&lt;/li&gt;
&lt;li&gt;turn 50%&lt;/li&gt;
&lt;li&gt;river 33%&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;how-to-bet&#34;&gt;How to bet&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;Size&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;If you have nuts advantage, bet bigger.&lt;/li&gt;
&lt;li&gt;If you do not have nuts advantage, bet smaller.&lt;/li&gt;
&lt;li&gt;Nuts advantage: when you have more combinations of super strong hands (two-pair or better) than his opponent&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Find Value Cards&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The inequality \( \text{Equity} &gt; 1 - \frac{1}{2(1+b)} \) suggests a threshold where a playerâ€™s equity (their share of the pot if the hand goes to showdown) should exceed a certain value in order for them to make a profitable move, such as calling or betting.&lt;/p&gt;
&lt;p&gt;To understand this better, we can break it down:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Setting Up the Inequality&lt;/strong&gt;: The right side, \(1 - \frac{1}{2(1+b)}\), provides a boundary value. This boundary depends on the size of the bet \(b\) relative to the pot (normalized to 1).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Interpretation of the Threshold&lt;/strong&gt;: If a playerâ€™s equity in the hand is greater than \(1 - \frac{1}{2(1+b)}\), then their hand is likely profitable enough to proceed with aggressive action, such as betting or calling.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Breakdown of the Expression&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;For larger bets \(b\), \( \frac{1}{2(1+b)} \) becomes smaller, and therefore \(1 - \frac{1}{2(1+b)}\) approaches 1. This implies that when the bet is large, the player needs a higher equity to continue.&lt;/li&gt;
&lt;li&gt;For smaller bets \(b\), \( \frac{1}{2(1+b)} \) is larger, meaning that \(1 - \frac{1}{2(1+b)}\) is lower. In this case, a player can proceed with lower equity since the risk is relatively lower.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Value bet&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;If I check, the remaining streets &amp;lt; biggest that I can get, I 100% bet&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;What to bluff&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Backdoor Draw&lt;/li&gt;
&lt;li&gt;Frontdoor Draw&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;exploitation&#34;&gt;exploitation&lt;/h2&gt;
&lt;h3 id=&#34;call&#34;&gt;Call&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;If opponent bluff too much, call, otherwise not (BF to check)&lt;/li&gt;
&lt;li&gt;Only call one street.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;bluff&#34;&gt;Bluff&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;If your opponent is calling too much, do not bluff, otherwise, bluff (MDF to check)&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>DDIA Chapter 7 - Transaction</title>
      <link>http://localhost:1313/post/2024-10-06-ddia-chapter-7-transaction/</link>
      <pubDate>Mon, 07 Oct 2024 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2024-10-06-ddia-chapter-7-transaction/</guid>
      <description>&lt;h1 id=&#34;acid&#34;&gt;ACID&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Atomicity: All or nothing.&lt;/li&gt;
&lt;li&gt;Consistency: Invariants must always be true (This is from application perspective).&lt;/li&gt;
&lt;li&gt;Isolation: Transactions are executed in a way that their operations do not interfere with each other.&lt;/li&gt;
&lt;li&gt;Durability: Once commited, data will not be forgetten.&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;weak-isolation-levels&#34;&gt;Weak Isolation Levels&lt;/h1&gt;
&lt;h2 id=&#34;read-committed-to-combat-dirty-read&#34;&gt;Read Committed (To combat dirty read)&lt;/h2&gt;
&lt;h3 id=&#34;what-is-dirty-read&#34;&gt;What is dirty read?&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Read a data that has not been committed by a transaction.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;implement-read-committed&#34;&gt;Implement Read Committed&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Lock on write.&lt;/li&gt;
&lt;li&gt;Lock on read (performance hit).&lt;/li&gt;
&lt;li&gt;Remember old + new value.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;snapshot-isolation-and-repeatable-read-to-combat-nonrepeatable-read&#34;&gt;Snapshot Isolation and Repeatable Read (To combat nonrepeatable read)&lt;/h2&gt;
&lt;h3 id=&#34;what-is-nonrepetabale-read&#34;&gt;What is nonrepetabale read?&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Alice read account A (50).&lt;/li&gt;
&lt;li&gt;Alice executes A = A + 10.&lt;/li&gt;
&lt;li&gt;Alice executes B = B - 10.&lt;/li&gt;
&lt;li&gt;Alice read account B (40).&lt;/li&gt;
&lt;li&gt;Sum is 50 + 40 which is not 100.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;snapshot-isoltion&#34;&gt;Snapshot Isoltion&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Each transaction sees the snapshot of the database at the start of the transaction.&lt;/li&gt;
&lt;li&gt;MVCC(Multi-version concurrency control).&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;preventing-lost-updates&#34;&gt;Preventing Lost Updates&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Atomic write operations.&lt;/li&gt;
&lt;li&gt;Explicit locking.&lt;/li&gt;
&lt;li&gt;Automotically deleting lost updates.&lt;/li&gt;
&lt;li&gt;Compare and set.&lt;/li&gt;
&lt;li&gt;Conflict resolution and replica.&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;serializability-to-combat-phantom&#34;&gt;Serializability (To combat phantom)&lt;/h1&gt;
&lt;h2 id=&#34;write-skew-and-phantoms&#34;&gt;Write Skew and Phantoms&lt;/h2&gt;
&lt;p&gt;oncall-rotation in emergency room.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Pattern&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;select&lt;/li&gt;
&lt;li&gt;decide how to continue based on select&lt;/li&gt;
&lt;li&gt;INSERT, UPDATE, DELTE&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;actual-serial-execution&#34;&gt;Actual Serial Execution&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Every transaction must be small and fast for performance.&lt;/li&gt;
&lt;li&gt;It is limited to use cases where the active dataset can fit in memory for performance.&lt;/li&gt;
&lt;li&gt;Write throughput must be low enough to be handled on a single CPU core, or else transactions need to be partitioned without requiring cross-partition coordination.&lt;/li&gt;
&lt;li&gt;Cross-partition transactions are possible, but there is a hard limit to the extent to which they can be used.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;two-phase-locking&#34;&gt;Two-Phase Locking&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;read: acquire the lock in shared mode, if exclusive exists, wait.&lt;/li&gt;
&lt;li&gt;write: acquire the lock in exclusive mode.&lt;/li&gt;
&lt;li&gt;read then write: acquire in shared first, then exclusive.&lt;/li&gt;
&lt;li&gt;commit or abort: hold until abort or commit&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;serializable-snapshot-isolation-ssi&#34;&gt;Serializable Snapshot Isolation (SSI)&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Goal of SSI: full serializability with small perf penalty compared to snapshot isolation.&lt;/li&gt;
&lt;li&gt;Used in single-node (PostgreSQL 9.1) and distributed, may become the new default.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;pessimistic-versus-optimistic-concurrency-control&#34;&gt;Pessimistic versus optimistic concurrency control&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;2PL is pessimistic&lt;/li&gt;
&lt;li&gt;SSI is optimistic: When a transaction wants to commit, the database checks isolation violations&lt;/li&gt;
&lt;li&gt;If there is enough spare capacity, and if contention between transactions is not too high, optimistic concurrency control techniques perform better&lt;/li&gt;
&lt;li&gt;On top of snapshot isolation, SSI adds an algorithm for detecting serialization conflicts among writes and determining which transactions to abort.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Decisions based on an outdated premise
A premise is a fact that was true at the beginning of the transaction. How does the database know if a query result might have changed?&lt;/p&gt;
&lt;h3 id=&#34;detecting-stale-mvcc-reads&#34;&gt;Detecting stale MVCC reads&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;The database needs to track when a transaction ignores another transactionâ€™s writes due to MVCC visibility rules.&lt;/li&gt;
&lt;li&gt;Check any of the ignored writes has been committed and abort if so.&lt;/li&gt;
&lt;li&gt;Wait until committing because read-only won&amp;rsquo;t write skew, and other write transactions might be aborted.&lt;/li&gt;
&lt;li&gt;Key is to avoid unnecessary aborts.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;detecting-writes-that-affect-prior-reads&#34;&gt;Detecting writes that affect prior reads&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;DB track ephemeral information about transactions reading data on index, or at the table level.&lt;/li&gt;
&lt;li&gt;When a transaction writes, notify existing reader of that data&lt;/li&gt;
&lt;li&gt;Check other writes commit when commit reader.&lt;/li&gt;
&lt;li&gt;(Question: why not notify existing reader when committing the other writer transaction?)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;performance-of-serializable-snapshot-isolation&#34;&gt;Performance of serializable snapshot isolation&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;The rate of aborts significantly affects the overall performance of SSI. So SSI requires short read-write transactions, but it&amp;rsquo;s less sensitive to slow transactions than two-phase locking or serial execution.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;source:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://xgwang.me/posts/ddia-7-transactions/&#34;&gt;https://xgwang.me/posts/ddia-7-transactions/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ddia&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>DDIA Chapter 6 - Partition</title>
      <link>http://localhost:1313/post/2024-10-06-ddia-chapter-6-partition/</link>
      <pubDate>Sun, 06 Oct 2024 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2024-10-06-ddia-chapter-6-partition/</guid>
      <description>&lt;h2 id=&#34;two-types-of-partition-techniques&#34;&gt;Two types of partition techniques&lt;/h2&gt;
&lt;h3 id=&#34;key-range-partition&#34;&gt;Key Range Partition&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;How: [a-c], [d-e], &amp;hellip;&lt;/li&gt;
&lt;li&gt;Pros: Efficient for range query.&lt;/li&gt;
&lt;li&gt;Cons: Hot spot.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;hash-partition&#34;&gt;Hash Partition&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;How: hash first, then use range.&lt;/li&gt;
&lt;li&gt;Pros: Distribute load evenly.&lt;/li&gt;
&lt;li&gt;Cons: Range query is inefficient.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;hybrid&#34;&gt;Hybrid&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;How: one part -&amp;gt; partition, the other part -&amp;gt; sort order.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;partitioning-secondary-indexes&#34;&gt;Partitioning Secondary Indexes&lt;/h2&gt;
&lt;h3 id=&#34;partitioning-secondary-indexes-by-document&#34;&gt;Partitioning Secondary Indexes by Document&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Database can perform indexing automatically.&lt;/li&gt;
&lt;li&gt;Note: in KV-only DB, application level secondary indexing is prone to inconsistency.&lt;/li&gt;
&lt;li&gt;Each partition maintains its own secondary indexes.&lt;/li&gt;
&lt;li&gt;A.K.A. local index.&lt;/li&gt;
&lt;li&gt;Need to send the query to all partitions, and combine all the results you get back (scatter/gather).&lt;/li&gt;
&lt;li&gt;Read queries are expensive, and prone to latency amplification. But widely used.&lt;/li&gt;
&lt;li&gt;Recommend structure the partitioning scheme so that secondary index queries can be served from a single partition.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;partitioning-secondary-indexes-by-term&#34;&gt;Partitioning Secondary Indexes by Term&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;A global index must also be partitioned (term-partitioned).&lt;/li&gt;
&lt;li&gt;Partition the index by the term itself, or using a hash of the term.&lt;/li&gt;
&lt;li&gt;Pro: more efficient read (no scatter/gather).&lt;/li&gt;
&lt;li&gt;Con: write slower and more complicated, require distributed transaction.&lt;/li&gt;
&lt;li&gt;Updates to global secondary indexes are asynchronous, e.g., Amazon DynamoDB.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;strategies-for-rebalancing&#34;&gt;Strategies for Rebalancing&lt;/h2&gt;
&lt;h3 id=&#34;how-not-to-do-it-hash-mod-n&#34;&gt;How not to do it: hash mod N&lt;/h3&gt;
&lt;p&gt;Problem: move data more than necessary&lt;/p&gt;
&lt;h3 id=&#34;fixed-number-of-partitions&#34;&gt;Fixed number of partitions&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Create many more partitions than there are nodes, and assign several partitions to each node.&lt;/li&gt;
&lt;li&gt;The new node can steal a few partitions from every existing node.&lt;/li&gt;
&lt;li&gt;The number of partitions is usually fixed when the database is first set up and not changed afterward.&lt;/li&gt;
&lt;li&gt;If partitions are very large, rebalancing and recovery from node failures become expensive. But if partitions are too small, they incur too much overhead.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;request-routing&#34;&gt;Request Routing&lt;/h2&gt;
&lt;h3 id=&#34;strategy-for-routing&#34;&gt;Strategy for routing&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Send requests to all nodes, and if we do not get result, reoute to next node.&lt;/li&gt;
&lt;li&gt;Implement a routing tier which knows which node has the specific partition.&lt;/li&gt;
&lt;li&gt;Client knows the partition.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;how-does-the-component-make-the-routing-decision&#34;&gt;How does the component make the routing decision&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Zookeeper which is a service that knows the partition.&lt;/li&gt;
&lt;li&gt;Gossip protocol.&lt;/li&gt;
&lt;li&gt;Mannual rebalance.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;source:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://xgwang.me/posts/ddia-6-partitioning/#intro&#34;&gt;https://xgwang.me/posts/ddia-6-partitioning/#intro&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ddia&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>DDIA Chapter 5 - Repliation</title>
      <link>http://localhost:1313/post/2024-10-05-ddia-chapter-5-replication/</link>
      <pubDate>Sat, 05 Oct 2024 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2024-10-05-ddia-chapter-5-replication/</guid>
      <description>&lt;h1 id=&#34;importance-of-replication&#34;&gt;Importance of Replication&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Fault Tolerance: keep the system running, even when one machine (or several machines) go down.&lt;/li&gt;
&lt;li&gt;Disconnected operation: Allow an application to continue to work when there is a network interruption.&lt;/li&gt;
&lt;li&gt;Latency: Placing data geographically close to users, so users can interact with it with a lower latency.&lt;/li&gt;
&lt;li&gt;Scalability: Being able to handle higher volume of reads than a single machine could handle.&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;three-main-approaches-to-replication&#34;&gt;Three main approaches to replication&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;Single-leader replication: Clients send write operation to a single node(leader), which sends a stream of data change to other replicas(followers). Reads can be performed on any replica, but reads from followers might be stale.&lt;/li&gt;
&lt;li&gt;Multi-leader replication: Clients send each write to onoe of several leader nodes, any of which can accept writes. The leaders send streams of data change events to each other and any follower nodes.&lt;/li&gt;
&lt;li&gt;Leaderless replication: Clients send each write to several nodes, and read from several nodes in parallel in order to detect and correct nodes with stale data. w + r &amp;gt; n.&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;three-interesting-effects-can-be-caused-by-replication-lag&#34;&gt;Three interesting effects can be caused by replication lag&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;Read-after-write consistency&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Users should always see data that they submit themselves.&lt;/p&gt;
&lt;p&gt;Solution:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;When read something that user can modify, read from leader.&lt;/li&gt;
&lt;li&gt;Track update time t, and from t to t + 1 minutes, read from leader(essentially wait for replica picking up the data from leader).&lt;/li&gt;
&lt;li&gt;Track the logical timestamp and compare it with follower node, if smaller, than find another node.&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Monotonic reads&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;After users have seen the data at one point in time, they shouldn&amp;rsquo;t later see the data from ealier point in time.&lt;/p&gt;
&lt;p&gt;Solution:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Always read from a single replica.&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Consistent prefix reads&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Users should see data in a state that makes causal sense: for example, an answer should come after a question.&lt;/p&gt;
&lt;p&gt;Solution:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Write to the same partition.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Finally, we discussed the concurrency issues that are inherent in multi-leader and leaderless replication approaches: because such systems allow multiple writes to happen concurrently, conflicts may occur. We examined an algorithm that a database might use to determine whether one operation happened before another, or whether they happened concurrently. We also touched on methods for resolving conflicts by merging together concurrently written values.
In the next chapter we will continue looking at data that is distributed across multiple machines, through the counterpart of replication: splitting a large dataset into partitions.&lt;/p&gt;
&lt;p&gt;From DDIA chapter 5.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>è°ˆè°ˆæˆ·æ™¨é£</title>
      <link>http://localhost:1313/post/2024-09-29-%E6%88%B7%E6%99%A8%E9%A3%8E/</link>
      <pubDate>Sun, 29 Sep 2024 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2024-09-29-%E6%88%B7%E6%99%A8%E9%A3%8E/</guid>
      <description>&lt;p&gt;å¤§å­¦ç”³è¯·çš„æ–‡ä¹¦æ›¾ç»æœ‰ä¸€é¢˜å«åš &lt;code&gt;What&#39;s unique about you?&lt;/code&gt;ï¼Œ å½“æ—¶é«˜ä¸­çš„æˆ‘å¹¶æ²¡æœ‰æ„Ÿåˆ°è‡ªå·±çš„å·®å¼‚æ€§ï¼Œæˆ‘åªæ„Ÿåˆ°è‡ªå·±å’Œæœ‰ç€åŒè´¨åŒ–çš„æ•™è‚²èƒŒæ™¯çš„åŒå­¦ä»¬ä¸€èµ·æ„‰å¿«åœ°å­¦ä¹ ï¼Œç”Ÿæ´»ï¼Œæˆé•¿ã€‚å¦‚æœè®©ç°åœ¨çš„æˆ‘æŒ‘ä¸€ç‚¹è‡ªå·±çš„ç‰¹æ®Šæ€§ï¼Œæˆ‘è®¤ä¸ºè‡ªå·±æ˜¯ä¸€ä¸ªå…´è¶£çˆ±å¥½éå¸¸å¹¿æ³›çš„äººã€‚æœ‰ä¸€ä¸¤ä¸ªé•¿æœŸçš„å…´è¶£çˆ±å¥½æŒç»­åå‡ å¹´ï¼ŒçŸ­æœŸçš„å…´è¶£çˆ±å¥½é€šå¸¸èƒ½ç»´æŒ 2-4 å‘¨ï¼Œæ•°æ®å¯èƒ½æ˜¯ long-tailï¼ˆé•¿å°¾ï¼‰åˆ†å¸ƒçš„ã€‚ç®€å•åˆ—ä¸¾ä¸€äº›æˆ‘æ„Ÿå…´è¶£è¿‡çš„è¯é¢˜åŒ…æ‹¬ä½†ä¸é™äºï¼šå‡ºè€åƒï¼Œç¼…ç”¸ç”µä¿¡è¯ˆéª—å™¶è…°å­ï¼Œæ´»ä½›ï¼ŒSplendorï¼ŒDominionï¼ŒX è°ƒæŸ¥ï¼ŒX åšå£«æ’­å®¢ï¼Œå¼ é›ªå³°è°ˆå‡å­¦&amp;hellip;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;æœ€è¿‘è®©æˆ‘çš„å¤§è„‘æ„Ÿåˆ°åˆºæ¿€çš„æ˜¯ä¸€ä½åå«æˆ·æ™¨é£çš„çŸ­è§†é¢‘åˆ›ä½œè€…ã€‚&lt;/code&gt;ä»–åœ¨ç®€ä¸­äº’è”ç½‘ç‹¬ç‰¹çš„ç”Ÿæ€ä½ï¼Œä»–çŠ€åˆ©åˆ°æœ‰äº›åæ¿€çš„è§‚ç‚¹ï¼Œä»¥åŠä»–ç›¸å£°èˆ¬çš„ç›´æ’­ï¼Œéƒ½è®©ä»–æ”¶è·äº†è®¸å¤šçš„è®¢é˜…ã€‚æˆ‘éå¸¸å–œæ¬¢ä»–äº§ç”Ÿçš„å†…å®¹ï¼Œä½†æˆ‘å¯¹ä»–æœ‰äº›è¿‡æ¿€çš„è§‚ç‚¹ä¹Ÿæœ‰ä¸åŒï¼Œç»¼åˆæ¥è¯´è‡ªå·±å¹¶ä¸å®Œå…¨ç®—ä»–çš„ç²‰ä¸ã€‚&lt;/p&gt;
&lt;p&gt;ä»–åˆ›ä½œçš„å†…å®¹ä»¥åŠç›´æ’­æ•ˆæœæœ‰éå¸¸å¤šç‹¬ç‰¹çš„åœ°æ–¹ï¼Œæˆ‘æƒ³ä»ä»¥ä¸‹ä¸‰ä¸ªæ–¹é¢ç®€å•è°ˆè°ˆä»–çš„å†…å®¹ï¼š1.è´­ä¹°åŠ›ç³»åˆ— + é€é’±ç³»åˆ—è§†é¢‘ï¼Œ2.ç›´æ’­çš„è¾©è®ºå¥—è·¯ï¼Œ3.æ ¸å¿ƒè§‚ç‚¹ï¼ˆä¸­åŒ»æ— ç”¨ï¼Œæ–‡è¨€æ–‡æ— ç”¨ï¼Œä¼ ç»Ÿæ–‡åŒ–æ— ç”¨ï¼Œè‹¹æœæ‰‹æœºæœ€ä¼˜è¶Šï¼Œå¦‚ä½•ä½¿ç”¨äº’è”ç½‘+çš„æ€ç»´èµšé’±ï¼‰ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;è´­ä¹°åŠ›ç³»åˆ—ä¸é€é’±ç³»åˆ—è§†é¢‘ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è´­ä¹°åŠ›ç³»åˆ—è§†é¢‘ï¼šåœ¨å›½å†…/å›½å¤–çš„æ‹æ‘„ä¸­ï¼Œæˆ·æ™¨é£ä¼šéšæœºè¯¢é—®ä¸€ä¸ªé™Œç”Ÿäºº ta çš„ä¸€å°æ—¶å·¥èµ„ï¼Œç„¶ååœ¨å½“åœ°å¤§å‹å¹³ä»·è¿é”è¶…å¸‚è¿›è¡Œæ¶ˆè´¹ï¼Œä¸»è¦è´­ä¹°è‚‰è›‹å¥¶ï¼Œæœ€ç»ˆé€šè¿‡æ—¥ç”¨å“çš„è´­ä¹°ä½“ç°å½“åœ°åŠ³åŠ¨æ”¶å…¥çš„è´­ä¹°åŠ›ã€‚&lt;/li&gt;
&lt;li&gt;é€é’±è§†é¢‘ï¼šåœ¨å›½å†…çš„æ‹æ‘„ä¸­ï¼Œä»–åœ¨é‡åº†ï¼Œä¸Šæµ·ï¼Œæˆéƒ½ç­‰åœ°åŒºéšæœºé‡‡è®¿ä¸€ä¸ªé™Œç”Ÿäººï¼Œéšæœºé—®é™Œç”Ÿäººä¸‰ä¸ªç®€å•çš„é—®é¢˜ï¼Œé€ç»™é™Œç”Ÿäºº 500-2000 å…ƒä¸ç­‰ï¼Œæ‹æ‘„é™Œç”Ÿäººä¼šæ€ä¹ˆèŠ±è¿™ç¬”é’±ã€‚ä½†ä¸€èˆ¬æ¥è¯´è¿™äº›é™Œç”Ÿäººå¹¶ä¸å®Œå…¨æ˜¯éšæœºçš„ï¼Œå¾ˆå¤šæƒ…å†µä¸‹éƒ½æ˜¯è¯·çš„çœ‹ä¼¼æ¯”è¾ƒç©·è‹¦çš„äººè¿›è¡Œè¿™ä¸ªæŒ‘æˆ˜ï¼Œå¤§è‡´ä¹Ÿæ˜¯ç»™ç©·è‹¦äººé€é’±ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç›´æ’­æµç¨‹ä¸è¾©è®ºå¥—è·¯&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç›´æ’­æµç¨‹ï¼šå’Œæ¸¸æˆï¼Œæ‰è‰ºï¼Œæˆ·å¤–ç›´æ’­ä¸åŒï¼Œä»–çš„ç›´æ’­é€šå¸¸æ›´åƒæ˜¯ä¸€åœºè¾©è®ºã€‚ä»–ä¼šè®©æƒ³ä¸Šéº¦çš„ b å‹æ‰“å¼€ç›´æ’­ï¼Œç‚¹å‡» pkï¼Œå’Œä»–è¿›è¡Œè§‚ç‚¹çš„ç¢°æ’ã€‚&lt;/li&gt;
&lt;li&gt;è¾©è®ºå¥—è·¯ï¼š
&lt;ol&gt;
&lt;li&gt;åœ¨å¯¹æ–¹è¡¨è¾¾è§‚ç‚¹æ—¶æ‰“æ–­åˆ«äººè¯´è¯ï¼Œæ‰“ä¹±åˆ«äººèŠ‚å¥
&lt;ol&gt;
&lt;li&gt;è¯»ä¸ª sc å•Šï¼Œxxxxxã€‚&lt;/li&gt;
&lt;li&gt;æ„Ÿè°¢ xxx æ€»ã€‚&lt;/li&gt;
&lt;li&gt;åˆ«è¯´æ•æ„Ÿçš„ã€‚&lt;/li&gt;
&lt;li&gt;ä½ çš„éº¦æœ‰å›éŸ³ï¼Œæ˜¯ä»€ä¹ˆæ‰‹æœºï¼Œå®‰å“æ‰‹æœºï¼Ÿè¿™å°±å¯¹äº†ï¼Œä¸æ˜¯è¯´å®‰å“ä¸å¥½å•Šã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;æŸ¥æˆ·å£ï¼Œå¤¹åœ¨ä¸€äº›äººç”Ÿæ”»å‡»
&lt;ol&gt;
&lt;li&gt;ä½ æ˜¯ä»€ä¹ˆå­¦å†ï¼Ÿ&lt;/li&gt;
&lt;li&gt;ä½ æ˜¯å“ªé‡Œäººï¼Ÿ&lt;/li&gt;
&lt;li&gt;åšä»€ä¹ˆå·¥ä½œï¼Ÿ&lt;/li&gt;
&lt;li&gt;ä¸€å¹´æŒ£å¤šå°‘é’±ï¼Ÿ&lt;/li&gt;
&lt;li&gt;ä½ ç”¨ä»€ä¹ˆæ‰‹æœºï¼Ÿ&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ€»ä¹‹ï¼Œä»–çš„ç›´æ’­æ•ˆæœé€šå¸¸æ¥è‡ªäºæˆ–æ˜¯ä¸Šéº¦ b å‹çš„è§‚ç‚¹å®åœ¨ç«™ä¸ä½è„šï¼Œæˆ–æ˜¯ä¸€ç§è®­è¯«åˆ«äººçš„æ–¹å¼ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ ¸å¿ƒè§‚ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¸­åŒ»æ— ç”¨è®ºï¼šå¦‚æœä¸å€Ÿç”¨è¥¿åŒ»çš„ä»ªå™¨ï¼Œä¸­åŒ»æ— æ³•åˆ¤æ–­ä»€ä¹ˆæ˜¯è‚¿ç˜¤ï¼Œä»€ä¹ˆæ˜¯è…°æ¤é—´ç›˜çªå‡ºã€‚é’è’¿ç´ æ¥è‡ªäºé»„èŠ±è’¿ï¼Œå’Œä¸­åŒ»æ²¡å…³ç³»ã€‚&lt;/li&gt;
&lt;li&gt;æ–‡è¨€æ–‡æ— ç”¨è®ºï¼šæ–‡è¨€æ–‡å®Œå…¨è„±ç¦»ç”Ÿæ´»ï¼Œå–œæ¬¢çš„å¯ä»¥å­¦ä¹ ç ”ç©¶ï¼Œæ²¡å¿…è¦æ”¾åˆ°å­¦æ ¡è¯¾ç¨‹ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;ä¼ ç»Ÿæ–‡åŒ–æ— ç”¨ ï¼šæ¯”å¦‚æ˜¥èŠ‚ï¼Œä¸­ç§‹èŠ‚ï¼Œå…¨éƒ½æ˜¯ç³Ÿç²•ï¼Œæ˜¥èŠ‚æ²¡å¿…è¦è´´æ˜¥è”ï¼Œæœˆé¥¼å…¨æ˜¯ç³–å’Œæ²¹ï¼Œä¸­ç§‹èŠ‚ä¸è¦åƒæœˆé¥¼ã€‚&lt;/li&gt;
&lt;li&gt;è‹¹æœæ‰‹æœºæœ€ä¼˜è¶Šï¼šè‹¹æœæ‰‹æœºï¼Œdesigned by apple in Californiaï¼ŒåŠæ‰“ä¸–ç•Œä¸Šæ‰€æœ‰æ‰‹æœºï¼Œå…¶ä»–æ‰€æœ‰æ‰‹æœºå‚å•†éƒ½åœ¨äºé’±ï¼Œè‹¹æœå¤§é™†æŠ½æˆ 30%ï¼Œåˆ«çš„å®‰å“æ‰‹æœºæŠ½æˆä¹Ÿæ˜¯ 30%ï¼Œç”šè‡³æ›´å¤š 50%ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚ä½•ä½¿ç”¨äº’è”ç½‘+çš„æ€ç»´èµšé’±ï¼šä¸‰ä»¶å¥—ï¼šå¼€å¡è½¦ ï¼ˆxxx è€ƒç ”ä¸­ï¼‰ Vlogï¼Œæ”¶å…¥å…¬å¼€ï¼Œç›´æ’­æç±³ã€‚å¼€æ²¹å‚ï¼šæ”¶å…¥å…¬å¼€ï¼Œç»™å¤§å®¶åšé€æ˜ï¼Œæ‹‰è¿‘è·ç¦»ï¼Œæé«˜ä¿¡ä»»ï¼Œäº‹å®ä¸Šä»–è‡ªå·±ä¹Ÿè¿™ä¹ˆåšçš„ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ€»ç»“ä¸€ä¸‹è§‚çœ‹ä»–å†…å®¹ 2 å‘¨åçš„ä¸€äº›æ€è€ƒ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è™½ç„¶ä»–æ˜¯é«˜ä¸­å­¦å†ï¼Œä½†æ˜¯ä»–å…·æœ‰å¾ˆå¤šå¸¸è¯†ï¼ŒæŸ¥è¿‡å¾ˆå¤šä¸­åŒ»æ–¹é¢çš„èµ„æ–™ï¼Œå­¦è¿‡å¾ˆå¤šå†å²æ–¹é¢çš„çŸ¥è¯†ï¼Œä»–åƒè¿™ç¢—é¥­æ˜¯æœ‰é‚£ä¸ªé‡‘åˆšé’»çš„ã€‚&lt;/li&gt;
&lt;li&gt;äº’è”ç½‘+çš„æ€ç»´ï¼šæ”¶å…¥å…¬å¼€ï¼Œè·å¾—ä¿¡ä»»ï¼Œç„¶åç›´æ’­æç±³&lt;/li&gt;
&lt;li&gt;æœ‰ä¸€æ¬¡è§‚çœ‹ä»–ç›´æ’­ï¼Œä»–åœ¨å®‰æ…°ä¸€ä¸ªå¥³å„¿æœ‰å…ˆå¤©æ€§ç–¾ç—…çš„çˆ¶äº²ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æœ‰äº›æ—¶å€™äººè¦æ¥å—äº‹å®ï¼Œä»€ä¹ˆå«äº‹å®ï¼Ÿæœ‰äº›ç—…äººç±»æ²¡æœ‰åˆ°é‚£ä¸ªç¨‹åº¦ï¼Œæ— æ³•é è¯ç‰©æ²»å¥½ï¼Œåªèƒ½æœŸç›¼ä»–è‡ªæ„ˆã€‚äººè¦æ¥å—è¿™ä¸ªç°å®ï¼Œç¡®å®æ²¡åŠæ³•ï¼Œå¤§å®¶éƒ½ç»å†è¿‡è¿™ç§æ—¶åˆ»ï¼Œäººç±»ç§‘æŠ€ç¡®å®æ²»ä¸äº†ï¼Œæ²»ä¸äº†æ€ä¹ˆåŠï¼Œåªèƒ½å¦ç„¶æ¥å—ï¼ŒæœŸç›¼ä»–è‡ªæ„ˆã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Recommender System Study Notes - Nomination(6/6)</title>
      <link>http://localhost:1313/post/2024-09-06-rec-sys-nomination-6/</link>
      <pubDate>Fri, 06 Sep 2024 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2024-09-06-rec-sys-nomination-6/</guid>
      <description>&lt;ul&gt;
&lt;li&gt;GeoHash Nomination&lt;/li&gt;
&lt;li&gt;Author Nomination
&lt;ul&gt;
&lt;li&gt;Subscribed Author&lt;/li&gt;
&lt;li&gt;Interacted Author&lt;/li&gt;
&lt;li&gt;Similar Author&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Cache Nomination&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;geohash-nomination&#34;&gt;GeoHash Nomination&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Indexing
&lt;ul&gt;
&lt;li&gt;GeoHash -&amp;gt; Item with good quality(reverse chronological order)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;No personalized&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;subscribed-author-nomination&#34;&gt;Subscribed Author Nomination&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Indexing:
&lt;ul&gt;
&lt;li&gt;User -&amp;gt; subscribed authors&lt;/li&gt;
&lt;li&gt;author -&amp;gt; uploaded items&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Nomination:
&lt;ul&gt;
&lt;li&gt;User -&amp;gt; Subscribed Author -&amp;gt; New Item&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;interacted-author-nomination&#34;&gt;Interacted Author Nomination&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;If someone likes/love/forward an item&lt;/li&gt;
&lt;li&gt;Indexing:
&lt;ul&gt;
&lt;li&gt;User -&amp;gt; Interacted Author (update it)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Nomination:
&lt;ul&gt;
&lt;li&gt;User -&amp;gt; Interacted Author -&amp;gt; New Item&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;similar-author-nomination&#34;&gt;Similar Author Nomination&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Indexing:
&lt;ul&gt;
&lt;li&gt;Author -&amp;gt; Similar Author&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Nomination:
&lt;ul&gt;
&lt;li&gt;User ID -&amp;gt; Liked Author -&amp;gt; Similar Author -&amp;gt; New Item&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;cache-nomination&#34;&gt;Cache Nomination&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Intuition: Use the previous ranking winning candidates discarded by re-ranking.&lt;/li&gt;
&lt;li&gt;Top 50 items, but get discarded by re-ranking, go to nomination.&lt;/li&gt;
&lt;li&gt;Cache is fixed. How to clear the cache
&lt;ul&gt;
&lt;li&gt;Got impressed&lt;/li&gt;
&lt;li&gt;At most 10 times&lt;/li&gt;
&lt;li&gt;At most 3 days&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;bloom-filter&#34;&gt;Bloom Filter&lt;/h3&gt;
&lt;h4 id=&#34;intuition&#34;&gt;Intuition&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;If user has seen an item, then we do not recommend this item to user&lt;/li&gt;
&lt;li&gt;For each user, record item that has been recommended(maybe for a month)&lt;/li&gt;
&lt;li&gt;For each item, check if it&amp;rsquo;s been recommended before&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;basics&#34;&gt;Basics&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;The Bloom filter determines whether an item ID is in the set of exposed items.&lt;/li&gt;
&lt;li&gt;If the judgment is &amp;ldquo;no&amp;rdquo;, then the item is definitely not in the set.&lt;/li&gt;
&lt;li&gt;If the judgment is &amp;ldquo;yes&amp;rdquo;, then the item is likely in the set. (There may be false positives, where an unexposed item is incorrectly judged as exposed and thus filtered out.)&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;heading&#34;&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;The size of the exposed item set is \( n \), the dimensionality of the binary vector is \( m \), and \( k \) hash functions are used.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The false positive probability of the Bloom filter \( \delta \) is approximately:&lt;/p&gt;
\[
  \delta \approx \left( 1 - \exp\left( \frac{-kn}{m} \right) \right)^k
  \]
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;As \( n \) increases, the more 1&amp;rsquo;s there are in the vector, and the higher the false positive probability. (The probability that all \( k \) positions corresponding to unexposed items are set to 1 increases.)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;As \( m \) increases, the vector becomes longer, making hash collisions less likely.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;If \( k \) is too large or too small, it is not ideal; \( k \) has an optimal value.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Exposed Filtering Path:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;               +-------------+              +---------+              +-------------+
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;               |   Recall 1  |------------&amp;gt; | Sorting |------------&amp;gt; |   Item 1    |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;               +-------------+              +---------+              +-------------+
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;               |   Recall 2  |                                                   |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;               +-------------+                                                   |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;               |   Recall 3  |                                                   |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;               +-------------+                                                   v
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                                                           +-------------+
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                                                           |   Item 2    |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                                                           +-------------+
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                                                           |     ...     |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                                                           +-------------+
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                                                           |   Item q    |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                                                           +-------------+
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                      ^                                                        |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                      |                                                        |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;+------------------+  |                                                        |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;| Binary Vector    |&amp;lt;-+                                                        |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;+------------------+                                                           v
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                             +-------------------+     +-----------------------+
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                             | Bloom Filter      |&amp;lt;----| Real-time Processing   |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                             | (Exposure Filter) |     |  (Kafka + Flink)       |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                             +-------------------+     +-----------------------+
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
    
    <item>
      <title>Recommender System Study Notes - Nomination(5/6)</title>
      <link>http://localhost:1313/post/2024-09-05-rec-sys-nomination-5/</link>
      <pubDate>Thu, 05 Sep 2024 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2024-09-05-rec-sys-nomination-5/</guid>
      <description></description>
    </item>
    
    <item>
      <title>Recommender System Study Notes - Nomination(4/6)</title>
      <link>http://localhost:1313/post/2024-09-04-rec-sys-nomination-4/</link>
      <pubDate>Wed, 04 Sep 2024 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2024-09-04-rec-sys-nomination-4/</guid>
      <description>&lt;ul&gt;
&lt;li&gt;Two tower model full update/incremental update.
&lt;ul&gt;
&lt;li&gt;Online Nomination: Online compute user ID, ANN in stored vector database with item.&lt;/li&gt;
&lt;li&gt;Full Update: 1 epoch, 1 day.&lt;/li&gt;
&lt;li&gt;Incremental Update: Only upadte ID embedding, frozen the fully connected layer.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Two tower model Self-supervised learning
&lt;ul&gt;
&lt;li&gt;Problem: Two tower cannot learn item with limited amount of clicks (data biased).&lt;/li&gt;
&lt;li&gt;Self-supervised learning: random feature transformation&lt;/li&gt;
&lt;li&gt;bi&amp;rsquo;, bi&amp;rsquo;&amp;rsquo; high similarity&lt;/li&gt;
&lt;li&gt;bi&amp;rsquo;, bj&amp;rsquo;&amp;rsquo; low similarity&lt;/li&gt;
&lt;li&gt;Training:
&lt;ul&gt;
&lt;li&gt;pick n (user - item) as a batch for training.&lt;/li&gt;
&lt;li&gt;m items as a batch(uniform sampling) for self-supervised learning.&lt;/li&gt;
&lt;li&gt;$\frac{1}{n} \sum_{i=1}^{n} L_{\text{main}}[i] + \alpha \cdot \frac{1}{m} \sum_{j=1}^{m} L_{\text{self}}[j]$&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;online-nomination&#34;&gt;Online Nomination&lt;/h3&gt;
&lt;h4 id=&#34;implementation&#34;&gt;Implementation&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Item
&lt;ul&gt;
&lt;li&gt;Use neural network to compute item b&amp;rsquo;s embedding.&lt;/li&gt;
&lt;li&gt;Store them in vectorized databse (Milvus, Faiss, HnswLib).&lt;/li&gt;
&lt;li&gt;Indexing, for ANN search.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;User
&lt;ul&gt;
&lt;li&gt;Use user ID, feature, etc to compute user a&amp;rsquo;s embedding.&lt;/li&gt;
&lt;li&gt;ANN search
&lt;ul&gt;
&lt;li&gt;Use a as query.&lt;/li&gt;
&lt;li&gt;Return the top k as return.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Why store item but compute user online?
&lt;ul&gt;
&lt;li&gt;User is only 1, item is O(b).&lt;/li&gt;
&lt;li&gt;User often changes quickly.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;model-update&#34;&gt;Model Update&lt;/h3&gt;
&lt;h4 id=&#34;full-update-vs-incremental-update&#34;&gt;Full Update VS Incremental Update&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Full Update
&lt;ul&gt;
&lt;li&gt;Use yesterday&amp;rsquo;s tfrecord, train 1 epoch.&lt;/li&gt;
&lt;li&gt;Update the new user neural network, store item data into database.&lt;/li&gt;
&lt;li&gt;Easy to implement, easy requirement for the system.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Incremental Update(online learning)
&lt;ul&gt;
&lt;li&gt;Why? User&amp;rsquo;s interest can change quickly.&lt;/li&gt;
&lt;li&gt;Data streaming, TFRecord.&lt;/li&gt;
&lt;li&gt;Online learning, gradient descent, only update ID Embedding, not other parameters in the neural network.&lt;/li&gt;
&lt;li&gt;Update the new ID embedding.&lt;/li&gt;
&lt;li&gt;To be discarded after full update.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Why only incremental update is not having the best result?
&lt;ul&gt;
&lt;li&gt;Hourly data is biased.&lt;/li&gt;
&lt;li&gt;Full update: random shuffle, 1 epoch.&lt;/li&gt;
&lt;li&gt;Incremental update: train from morning to night, this is not having the best result.&lt;/li&gt;
&lt;li&gt;random shuffle makes a positive impact on the learning.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;two-tower-model-self-supervised-learning&#34;&gt;Two tower model Self-supervised learning&lt;/h3&gt;
&lt;h4 id=&#34;problem&#34;&gt;Problem&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;The head effect in the recommendation system is severe:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;A small number of items account for most of the clicks.&lt;/li&gt;
&lt;li&gt;Most items have a low number of clicks.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The features of high-click items are well-learned, but the features of long-tail items are not well-learned.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Self-supervised learning: data augumentation, to better learn long-tail items&amp;rsquo; embedding.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;intuition&#34;&gt;Intuition&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;A simple feature transformation will make minimal impact on their feature embeddings, and pairwise, the similarity still remains large.&lt;/li&gt;
&lt;li&gt;i -&amp;gt; i&amp;rsquo; -&amp;gt; bi&amp;rsquo;, i -&amp;gt; i&amp;rsquo;&amp;rsquo; -&amp;gt; bi&amp;rsquo;&amp;rsquo;, j -&amp;gt; j&amp;rsquo; -&amp;gt; bj&amp;rsquo;, j -&amp;gt; j&amp;rsquo;&amp;rsquo;-&amp;gt;bj&#39;&#39;&lt;/li&gt;
&lt;li&gt;i, bi&amp;rsquo; and bi&amp;rsquo;&amp;rsquo; has high similarity&lt;/li&gt;
&lt;li&gt;i, j, bi&amp;rsquo; and bj&amp;rsquo;&amp;rsquo; has low similarity&lt;/li&gt;
&lt;li&gt;cos(bi, bi&amp;rsquo;&amp;rsquo;) big, cos(bi&amp;rsquo;, bj&amp;rsquo;) small&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;methods&#34;&gt;Methods&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;Random Mask&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Randomly pick labels, and set them to null.&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Dropout&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Randomly dropout 50% label.&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Complementary&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;ID, Label, Keywords, City.&lt;/li&gt;
&lt;li&gt;Randomly divide them into two {ID, keyword} and {Label, City}.&lt;/li&gt;
&lt;li&gt;{ID, default, Keyword, default} -&amp;gt; Item embedding.&lt;/li&gt;
&lt;li&gt;{default, Label, default, City} -&amp;gt; Item embedding.&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;Mask a set of correlated features&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;U = {Male, Female, Unisex}.&lt;/li&gt;
&lt;li&gt;V = {Photography, Football, IT, Makeup}.&lt;/li&gt;
&lt;li&gt;u = female, v = Makeup, p(u, v) is high.&lt;/li&gt;
&lt;li&gt;u = female, v = IT, p(u, v) is low.&lt;/li&gt;
&lt;li&gt;$MI(U, V) = \sum_{u \in U} \sum_{v \in V} p(u, v) \cdot \log \frac{p(u, v)}{p(u) \cdot p(v)}$&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Learning:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Assume there are a total of \( k \) features. Calculate the MI (Mutual Information) between any two features offline, resulting in a \( k \times k \) matrix.&lt;/li&gt;
&lt;li&gt;Randomly select one feature as a seed and find the \( k/2 \) features most related to the seed.&lt;/li&gt;
&lt;li&gt;Mask the seed and its related \( k/2 \) features, retaining the remaining \( k/2 \) features.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Training:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Sampling m items as a batch&lt;/li&gt;
&lt;li&gt;cos(bi&amp;rsquo;, bi&amp;rsquo;&amp;rsquo;) -&amp;gt; 1, other cos(bi&amp;rsquo;, bj&amp;rsquo;&amp;rsquo;) -&amp;gt; 0&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Recommender System Study Notes - Nomination(3/6)</title>
      <link>http://localhost:1313/post/2024-09-03-rec-sys-nomination-3/</link>
      <pubDate>Tue, 03 Sep 2024 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2024-09-03-rec-sys-nomination-3/</guid>
      <description>&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Two Tower Model - Architecture + Training&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Pointwise Training
&lt;ul&gt;
&lt;li&gt;View nomination as binary classification&lt;/li&gt;
&lt;li&gt;Sample: cos(a,b) -&amp;gt; +1, negative sample: cos(a, b) -&amp;gt; -1&lt;/li&gt;
&lt;li&gt;Positive : negative = 1:2 / 1:3&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Pairwise Training
&lt;ul&gt;
&lt;li&gt;Intuntion: cos(a, b+) &amp;gt; cos(a, b-)&lt;/li&gt;
&lt;li&gt;Triplet hinge loss = max(0, cos(a, b-) + m - cos(a, b+))&lt;/li&gt;
&lt;li&gt;Triplet logistic loss = log(1 + exp(Ïƒ) * cos(a, b-) - cos(a, b+))&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Listwise Training
&lt;ul&gt;
&lt;li&gt;CrossEntropyLoss&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Two Tower Model - Positive Samples + Negative Samples&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Positive Sample:
&lt;ul&gt;
&lt;li&gt;Impressed and clicked&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Negative Sample:&lt;/li&gt;
&lt;li&gt;Easy negative sample:
&lt;ul&gt;
&lt;li&gt;All items&lt;/li&gt;
&lt;li&gt;In-batch items&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Hard negative sample:
&lt;ul&gt;
&lt;li&gt;Nominated, but discarded by ranking&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Mix easy and hard for training dataset&lt;/li&gt;
&lt;li&gt;Wrong sampling:
&lt;ul&gt;
&lt;li&gt;Impressed, but not clicked (can be used for training ranking but not nomination)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;two-tower-modeldssm---architecture-and-training&#34;&gt;Two Tower Model(DSSM) - Architecture and Training&lt;/h3&gt;
&lt;h4 id=&#34;two-tower-model-architecture&#34;&gt;Two Tower Model Architecture&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Neural Network
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    â””â”€â”€ Concatenate
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        â”œâ”€â”€ Embedding Layer (User ID)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        â”‚      â””â”€â”€ Embedding (Vector Representation)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        â”œâ”€â”€ Embedding Layers (User Discrete Feature)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        â”‚      â””â”€â”€ Embedding (Vector Representation)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        â””â”€â”€ Normalization, Binning, etc. (normalize to 1, put into buckets)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;               â””â”€â”€ User Continuous Features (Vector Representation)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;$\cos(a, b) = \frac{a \cdot b}{\|a\|_2 \cdot \|b\|_2}$&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                            Cosine Similarity:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                  /    \
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                /        \
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                             a            b
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                          /                 \
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;              Neural Network              Neural Network
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                /                                \
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;         Feature Transformation           Feature Transformation
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;         /                                          \
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;User ID, Discrete Features,                 Product ID, Discrete Features,
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Continuous Features                         Continuous Features
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;two-tower-model-training&#34;&gt;Two Tower Model Training&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Pointwise (binary classification)&lt;/li&gt;
&lt;li&gt;Pairwise&lt;/li&gt;
&lt;li&gt;Listwise&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id=&#34;pointwise-training&#34;&gt;Pointwise Training&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;Intuition: View nomination as binary classification&lt;/li&gt;
&lt;li&gt;positive sample: cos(a,b) -&amp;gt; +1, negative sample: cos(a, b) -&amp;gt; -1&lt;/li&gt;
&lt;li&gt;positive : negative = 1:2 / 1:3&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id=&#34;pairwise-training&#34;&gt;Pairwise Training&lt;/h5&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    cos(a, bâº)          cos(a, bâ»)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    /      \            /      \
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                   /        \          /        \
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                bâº               a                  bâ»
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        (Positive Sample)       (User)           (Negative Sample)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                |                  |                    |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        Neural Network      Neural Network     Neural Network
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                |                  |                    |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Feature Transformation   Feature Transformation Feature Transformation
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                |                  |                    |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    Positive Item Feature     User Features          Negative Item Feature
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;Intuntion: cos(a, b+) &amp;gt; cos(a, b-)&lt;/li&gt;
&lt;li&gt;triplet hinge loss = max(0, cos(a, b-) + m - cos(a, b+))&lt;/li&gt;
&lt;li&gt;triplet logistic loss = log(1 + exp(Ïƒ) * cos(a, b-) - cos(a, b+))&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id=&#34;listwise-training&#34;&gt;Listwise Training&lt;/h5&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;CrossEntropyLoss(y, s) = -log(sâº)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                       +-----------------------+
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                       |    CrossEntropyLoss   |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                       +-----------------------+
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                 |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                 |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                          +-------------------------------+
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                          |  Softmax Activation Function  |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                          +-------------------------------+
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                 |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      +------------+------------+-------------+ ... +------------+
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      |            |            |             |     |            |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;     sâº         sâ»_1       sâ»_2         ...   sâ»_n
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; (Positive)    (Negative)  (Negative)        (Negative)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    |             |             |                     |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    |             |             |                     |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; cos(a, bâº)   cos(a, bâ»_1)  cos(a, bâ»_2)   ...  cos(a, bâ»_n)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   |              |             |                     |
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;(Positive)    (Negative)   (Negative)         (Negative)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; Sample         Sample        Sample            Sample
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;two-tower-modeldssm---positive-samples--negative-samples&#34;&gt;Two Tower Model(DSSM) - Positive Samples + Negative Samples&lt;/h3&gt;
&lt;h4 id=&#34;positive-samples&#34;&gt;Positive Samples&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;impressed and clicked&lt;/li&gt;
&lt;li&gt;problem: 20% item takes 80% click&lt;/li&gt;
&lt;li&gt;solution:
&lt;ul&gt;
&lt;li&gt;up-sampling: one sample appear multiple times&lt;/li&gt;
&lt;li&gt;down-sampling: discard samples&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;negative-samples&#34;&gt;Negative Samples&lt;/h4&gt;
&lt;h5 id=&#34;simple-negative-sampling-all-items&#34;&gt;Simple Negative Sampling: All Items&lt;/h5&gt;
&lt;h6 id=&#34;uniform-sampling-unfair-to-unpopular-items&#34;&gt;Uniform Sampling: Unfair to unpopular items&lt;/h6&gt;
&lt;ul&gt;
&lt;li&gt;Most positive samples are popular items.&lt;/li&gt;
&lt;li&gt;If uniform sampling produces negative samples, most of the negative samples are unpopular items.&lt;/li&gt;
&lt;li&gt;positive sample: popular items, negative sample: unpopular items, this is unfair.&lt;/li&gt;
&lt;/ul&gt;
&lt;h6 id=&#34;non-uniform-sampling-the-goal-is-to-suppress-popular-items&#34;&gt;Non-uniform Sampling: The goal is to suppress popular items&lt;/h6&gt;
&lt;ul&gt;
&lt;li&gt;The probability of negative sampling is positively correlated with popularity (clicks).&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Sampling probability âˆ (clicks) ^ 0.75&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id=&#34;simple-negative-sampling-negative-sample-within-a-batch&#34;&gt;Simple Negative Sampling: Negative Sample within a batch&lt;/h5&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;user1 - item1
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;user2 - item2
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;user3 - item3
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;...
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;user_n - item_n
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;one batch has n positive samples&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;one batch has n(n - 1) negative samples&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The probablity that an item appear in a batch is propotional to the number of times it clicked.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;We aim to get it propotional to clicks^0.75.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;offline training cos(a, bi) - log(pi), pi âˆ clicks&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;online inference cos(a, bi)&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;hard-negative-sampling&#34;&gt;Hard Negative Sampling&lt;/h4&gt;
&lt;h5 id=&#34;hard-negative-samples&#34;&gt;Hard negative samples:&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;Items that are ranked and close to the target (relatively hard).&lt;/li&gt;
&lt;li&gt;Items that are ranked far behind the target (extremely hard).&lt;/li&gt;
&lt;/ul&gt;
&lt;h6 id=&#34;binary-classification-for-positive-and-negative-samples&#34;&gt;Binary classification for positive and negative samples:&lt;/h6&gt;
&lt;ul&gt;
&lt;li&gt;All items (simple): High classification accuracy.&lt;/li&gt;
&lt;li&gt;Items that are ranked and close to the target (relatively hard): Easy to misclassify.&lt;/li&gt;
&lt;li&gt;Items that are ranked far behind the target (extremely hard): Even easier to misclassify.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;datasets&#34;&gt;Datasets&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Mix negative samples&lt;/li&gt;
&lt;li&gt;50% easy negative sample&lt;/li&gt;
&lt;li&gt;50% hard negative sample&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Recommender System Study Notes - Nomination(2/6)</title>
      <link>http://localhost:1313/post/2024-09-03-rec-sys-nomination-2/</link>
      <pubDate>Mon, 02 Sep 2024 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2024-09-03-rec-sys-nomination-2/</guid>
      <description>&lt;ul&gt;
&lt;li&gt;Discrete Feature&lt;/li&gt;
&lt;li&gt;Matrix Completion&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;discrete-feature&#34;&gt;Discrete Feature&lt;/h3&gt;
&lt;h4 id=&#34;example&#34;&gt;Example&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;sex&lt;/li&gt;
&lt;li&gt;nationality&lt;/li&gt;
&lt;li&gt;english words&lt;/li&gt;
&lt;li&gt;item id&lt;/li&gt;
&lt;li&gt;user id&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;how-to-encode-discrete-feature---vectorization&#34;&gt;How to encode discrete feature -&amp;gt; vectorization&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;one-hot encoding&lt;/li&gt;
&lt;li&gt;embedding (*)
&lt;ul&gt;
&lt;li&gt;size: vector dimension * number of items&lt;/li&gt;
&lt;li&gt;How to implement: TensorFlow, PyTorch -&amp;gt; embedding&lt;/li&gt;
&lt;li&gt;embedding = Parameter matrix * one-hot encoding&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;matrix-completion&#34;&gt;Matrix Completion&lt;/h3&gt;
&lt;h4 id=&#34;intuition&#34;&gt;Intuition&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;item id -&amp;gt; embedding
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    \
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                     - cos(a, b)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    /
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;item id -&amp;gt; embedding
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;formula&#34;&gt;Formula&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;dataset = {u, i, y}&lt;/li&gt;
&lt;li&gt;training, u -&amp;gt; au, i -&amp;gt; bi&lt;/li&gt;
&lt;li&gt;optimization: $\min_{A, B} \sum_{\substack{(u, i, y) \in \Omega}} \left( y - \langle a_u, b_i \rangle \right)^2$&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;proscons&#34;&gt;Pros/Cons&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Cons
&lt;ul&gt;
&lt;li&gt;It only uses ID embedding without item, user characteristics
&lt;ul&gt;
&lt;li&gt;item characteristics: label, key words&lt;/li&gt;
&lt;li&gt;user characteristics: gender, age, geo, liked label&lt;/li&gt;
&lt;li&gt;Two tower Model&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Negative sample is wrong
&lt;ul&gt;
&lt;li&gt;Positive: User interacted, which is good&lt;/li&gt;
&lt;li&gt;Negative: User did not interact, which is not correct&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Training
&lt;ul&gt;
&lt;li&gt;dot product is worse than cosine similarity&lt;/li&gt;
&lt;li&gt;Loss(regression) is worse than cross entropy&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;implementation&#34;&gt;Implementation&lt;/h4&gt;
&lt;h5 id=&#34;offline&#34;&gt;Offline:&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;Learning A: user&lt;/li&gt;
&lt;li&gt;Learning B: item&lt;/li&gt;
&lt;li&gt;storing A into {user id: embedding} key-value&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id=&#34;online&#34;&gt;Online:&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;user Id -&amp;gt; find a&amp;rsquo;s vector&lt;/li&gt;
&lt;li&gt;nearest neighbour search, return the top 100 b whose &amp;lt;a, b&amp;gt; is max&lt;/li&gt;
&lt;li&gt;Approximate Nearest Neighbor (ANN)
&lt;ul&gt;
&lt;li&gt;pre process the circile into sectors&lt;/li&gt;
&lt;li&gt;pick a representative vector(indexing) represents the sector&lt;/li&gt;
&lt;li&gt;find representative vector, then find vector in that sector instead of the whole circle&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Recommender System Study Notes - Nomination(1/6)</title>
      <link>http://localhost:1313/post/2024-09-02-rec-sys-nomination-1/</link>
      <pubDate>Sun, 01 Sep 2024 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2024-09-02-rec-sys-nomination-1/</guid>
      <description>&lt;ul&gt;
&lt;li&gt;Item CF&lt;/li&gt;
&lt;li&gt;Swing&lt;/li&gt;
&lt;li&gt;User CF&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;item-cf&#34;&gt;Item CF&lt;/h3&gt;
&lt;h4 id=&#34;intuition&#34;&gt;Intuition&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;If user likes i1 and i1 is similar with i2 -&amp;gt; Then user is likely to like i2&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;formula&#34;&gt;Formula&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;$score = \sum_j \text{like}(\text{user}, \text{item}\_j) \times \text{sim}(\text{item}\_j, \text{item})$, to compute Item CF score&lt;/li&gt;
&lt;li&gt;$\text{sim}(i_1, i_2) = \frac{|\mathbf{v}|}{\sqrt{|\mathbf{w}_1| \cdot |\mathbf{w}_2|}}$, to compute similarity, w1 as the user who likes i1, w2 as the set, v as the intersection between i1 and i2.&lt;/li&gt;
&lt;li&gt;$\text{sim}(i*1, i_2) = \frac{\sum*{v \in v} \text{like}(v, i*1) \cdot \text{like}(v, i_2)}{\sqrt{\sum*{u*1 \in w_1} \text{like}^2(u_1, i_1)} \cdot \sqrt{\sum*{u_2 \in w_2} \text{like}^2(u_2, i_2)}}$, to take like score into consideration).&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;implementation&#34;&gt;Implementation&lt;/h4&gt;
&lt;h5 id=&#34;offline&#34;&gt;Offline:&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;User -&amp;gt; Item Indexing
&lt;ul&gt;
&lt;li&gt;return the last-n items with interaction that this user interacts with.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Item -&amp;gt; Item Indexing
&lt;ul&gt;
&lt;li&gt;compute sim (i, j) maybe maintaining User-&amp;gt;Item&lt;/li&gt;
&lt;li&gt;for each item, find the cloest k items&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id=&#34;online-inference-user-id---100-items&#34;&gt;Online Inference: (user id -&amp;gt; 100 items)&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;user id -&amp;gt; last-n items&lt;/li&gt;
&lt;li&gt;for each item in last-n, use item-item to find k items&lt;/li&gt;
&lt;li&gt;Use score formula to compute n * k items&amp;rsquo; score&lt;/li&gt;
&lt;li&gt;pick top 100, and output top 100 items as the nomination result in this Item CF Channel&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;swing&#34;&gt;Swing&lt;/h3&gt;
&lt;h4 id=&#34;intuition-1&#34;&gt;Intuition&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;If two items are not that relavant, but it got forwarded into a same small group, we want to lower the similarity score.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;formula-1&#34;&gt;Formula&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;u1 -&amp;gt; j1, u2 -&amp;gt; j2
&lt;ul&gt;
&lt;li&gt;$\text{overlap}(u_1, u_2) = |\mathcal{J}_1 \cap \mathcal{J}_2|$&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;i1 -&amp;gt; w1, i2 -&amp;gt; w2, v = w1 âˆ© w2
&lt;ul&gt;
&lt;li&gt;$\text{sim}(i_1, i_2) = \sum_{u_1 \in V} \sum_{u_2 \in V} \frac{1}{\alpha + \text{overlap}(u_1, u_2)}$, to compute similarity, a is a hyper-parameter&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;if overlap is big, then the contribution to similarity becomes low&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;user-cf&#34;&gt;User CF&lt;/h3&gt;
&lt;h4 id=&#34;intuition-2&#34;&gt;Intuition&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;I will like the notes which liked by someone who is similar to me.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;formula-2&#34;&gt;Formula&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Method1: like, collect, click notes are similar&lt;/li&gt;
&lt;li&gt;Method2: Subscribed authors are similar&lt;/li&gt;
&lt;li&gt;u1 -&amp;gt; j1, u2 -&amp;gt; j2, I = j1 âˆ© j2, nl: the number of users who likes l
&lt;ul&gt;
&lt;li&gt;$sim = \text{sim}(u_1, u_2) = \frac{|I|}{\sqrt{|\mathcal{J}_1| \cdot |\mathcal{J}_2|}}$&lt;/li&gt;
&lt;li&gt;$sim = \text{sim}(u_1, u_2) = \frac{\sum_{I \in I} \frac{1}{\log(1 + n_I)}}{\sqrt{|\mathcal{J}_1| \cdot |\mathcal{J}_2|}}$&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;$score = \sum_j \text{sim(user, user}_j\text{)} \times \text{like(user}_j, \text{item)}$&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;implementation-1&#34;&gt;Implementation&lt;/h4&gt;
&lt;h5 id=&#34;offline-1&#34;&gt;Offline:&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;User -&amp;gt; Item Indexing
&lt;ul&gt;
&lt;li&gt;return the last-n items with interaction that this user interacts with.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;User -&amp;gt; User Indexing
&lt;ul&gt;
&lt;li&gt;compute sim (i, j)&lt;/li&gt;
&lt;li&gt;for each user, find the cloest k users&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id=&#34;online&#34;&gt;Online:&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;user-user indexing: id -&amp;gt; k cloest users&lt;/li&gt;
&lt;li&gt;user-item indexing: for each user, find his/her last-n, use user-item to find n items&lt;/li&gt;
&lt;li&gt;compute score: Use the formula to compute n * k items&amp;rsquo; score&lt;/li&gt;
&lt;li&gt;rank: pick top 100, and output top 100 items as the nomination result in this User CF Channel&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Recommender System Study Notes Basics (1/1)</title>
      <link>http://localhost:1313/post/2024-09-01-rec-sys-basics-1/</link>
      <pubDate>Sun, 01 Sep 2024 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2024-09-01-rec-sys-basics-1/</guid>
      <description>&lt;h2 id=&#34;basics&#34;&gt;Basics&lt;/h2&gt;
&lt;div class=&#34;markmap&#34; style=&#34;height: 200px;&#34;&gt;

&lt;pre&gt;- Impression
  - Click
    - ScrollToEnd
      - Comment
    - Like
    - Collect
    - Share&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&#34;åŸºç¡€æŒ‡æ ‡&#34;&gt;åŸºç¡€æŒ‡æ ‡&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Click-through rate = Number of clicks / Number of impressions&lt;/li&gt;
&lt;li&gt;Like rate = Number of likes / Number of impressions&lt;/li&gt;
&lt;li&gt;Collection rate = Number of collections / Number of clicks&lt;/li&gt;
&lt;li&gt;Forwarding rate = Number of forwards / Number of clicks&lt;/li&gt;
&lt;li&gt;Completion rate = Number of times scrolled to the end / Number of clicks * f(Note length)&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;åŒ—ææ˜ŸæŒ‡æ ‡&#34;&gt;åŒ—ææ˜ŸæŒ‡æ ‡&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;ç”¨æˆ·è§„æ¨¡
DAU daily active user
MAU monthly active user&lt;/li&gt;
&lt;li&gt;æ¶ˆè´¹
äººå‡ä½¿ç”¨æ—¶é•¿ï¼Œäººå‡é˜…è¯»ç¬”è®°æ•°é‡&lt;/li&gt;
&lt;li&gt;å‘å¸ƒ
å‘å¸ƒæ¸—é€ç‡ï¼Œäººå‡å‘å¸ƒé‡&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;å®éªŒæµç¨‹&#34;&gt;å®éªŒæµç¨‹&lt;/h4&gt;
&lt;div class=&#34;markmap&#34; style=&#34;height: 200px;&#34;&gt;

&lt;pre&gt;- Offline Test
  - A/B Test
    - experiment rollout&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&#34;chain-of-recommender-system&#34;&gt;Chain of Recommender System&lt;/h4&gt;
&lt;div class=&#34;markmap&#34; style=&#34;height: 200px;&#34;&gt;

&lt;pre&gt;- Nomination
  - Pre-Ranking
    - Ranking
      - Re-Ranking&lt;/pre&gt;
&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Nomination O(billion) -&amp;gt; O(k)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;CF&lt;/li&gt;
&lt;li&gt;Two Tower&lt;/li&gt;
&lt;li&gt;Subscribed Content Creator&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Pre-Ranking + Ranking O(k) -&amp;gt; O(100)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Use a neural network as follow:&lt;/li&gt;
&lt;li&gt;Input:
&lt;ul&gt;
&lt;li&gt;User Feature Embedding&lt;/li&gt;
&lt;li&gt;Item Feature Embedding&lt;/li&gt;
&lt;li&gt;Stats Embedding&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Output:
&lt;ul&gt;
&lt;li&gt;Click-through rate&lt;/li&gt;
&lt;li&gt;Like Rate&lt;/li&gt;
&lt;li&gt;Collection Rate&lt;/li&gt;
&lt;li&gt;Forwarding Rate&lt;/li&gt;
&lt;li&gt;Completion Rate&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Combine them and output a score&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Re-Ranking O(100) -&amp;gt; O(80?) | for diversity&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Common methods:&lt;/li&gt;
&lt;li&gt;MMR&lt;/li&gt;
&lt;li&gt;DPP&lt;/li&gt;
&lt;li&gt;use pre-set rules to diversify notes&lt;/li&gt;
&lt;li&gt;insert ads, change sequence based on rules&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;ab-test&#34;&gt;A/B Test&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Basic flow:
&lt;ul&gt;
&lt;li&gt;new GNN, Offline testing gives promising results&lt;/li&gt;
&lt;li&gt;online A/B test, vaildate&lt;/li&gt;
&lt;li&gt;tune hyper parameters&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;how to put user into buckets randomly
&lt;ul&gt;
&lt;li&gt;hash user id&lt;/li&gt;
&lt;li&gt;compute metrics for each bucket, DAU, etc&lt;/li&gt;
&lt;li&gt;experiment rollout&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Overlapping experiment
&lt;ul&gt;
&lt;li&gt;overlapping: nomination, pre-ranking, ranking, re-ranking, user interface, ads&lt;/li&gt;
&lt;li&gt;each layer: mutually exclusive&lt;/li&gt;
&lt;li&gt;between layers: orthogonality&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Holdout mechanism
&lt;ul&gt;
&lt;li&gt;10% as holdout bucket + 90% as overlapping experiment&lt;/li&gt;
&lt;li&gt;clean holdout and rollout experiment&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Experiment Rollout&lt;/li&gt;
&lt;li&gt;Experiment Reverse&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;pre-ranking-rankingscoring&#34;&gt;Pre-Ranking, Ranking(scoring)&lt;/h3&gt;
&lt;h3 id=&#34;re-ranking&#34;&gt;Re-Ranking&lt;/h3&gt;
</description>
    </item>
    
    <item>
      <title>Areas of Exploration and Growth</title>
      <link>http://localhost:1313/post/2024-08-27-area-of-growth/</link>
      <pubDate>Tue, 27 Aug 2024 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2024-08-27-area-of-growth/</guid>
      <description>&lt;h4 id=&#34;health-and-fitness&#34;&gt;Health and Fitness&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Gym&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;machine-learning&#34;&gt;Machine Learning&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Recommender System&lt;/li&gt;
&lt;li&gt;CS224N: Natural Language Processing with Deep Learning&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;city-planning&#34;&gt;City Planning&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Get an idea of city planning.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;mindset-through-reading-and-writing&#34;&gt;Mindset (through reading and writing)&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Thinking in system.&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Leetcode Contest 410 Solutions</title>
      <link>http://localhost:1313/post/2024-08-14-init/</link>
      <pubDate>Wed, 14 Aug 2024 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/2024-08-14-init/</guid>
      <description>&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Solution&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;finalPositionOfSnake&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nl&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nl&#34;&gt;commands&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;List&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;idx&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;idx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;n&#34;&gt;idx&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;commands&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;cm&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;commands&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cm&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;UP&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cm&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;RIGHT&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cm&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;DOWN&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Solution&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;countGoodNodes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;edges&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;List&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;List&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;edges&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;graph&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[[]&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;edges&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;graph&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;graph&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;dfs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;node&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;parent&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;nonlocal&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;cnts&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;valids&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nxt&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;graph&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;node&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nxt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;parent&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;k&#34;&gt;continue&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cnt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dfs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nxt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;node&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;n&#34;&gt;valids&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;n&#34;&gt;cnts&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cnt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cnts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;sum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cnts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;sum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cnts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;dfs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Solution&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;countOfPairs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nums&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;List&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1e9&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nums&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;max&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nums&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;dp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nums&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                        &lt;span class=&#34;n&#34;&gt;dp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                        &lt;span class=&#34;n&#34;&gt;dp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nums&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nums&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nums&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                            &lt;span class=&#34;n&#34;&gt;dp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;sum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Solution&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;countOfPairs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nums&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;List&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1e9&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nums&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;max&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nums&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;dp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;p1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;p2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nums&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                        &lt;span class=&#34;n&#34;&gt;dp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                        &lt;span class=&#34;n&#34;&gt;dp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nums&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nums&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nums&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                            &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                            &lt;span class=&#34;n&#34;&gt;dp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                            &lt;span class=&#34;k&#34;&gt;continue&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                            &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                        &lt;span class=&#34;n&#34;&gt;dp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                        &lt;span class=&#34;n&#34;&gt;dp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;n&#34;&gt;p2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;n&#34;&gt;p2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;p1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;p2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;sum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MOD&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
    
  </channel>
</rss>
